var initWmeSdkPlus=function(){"use strict";var kr=Object.defineProperty,Or=(i,r,o)=>r in i?kr(i,r,{enumerable:!0,configurable:!0,writable:!0,value:o}):i[r]=o,le=(i,r,o)=>Or(i,typeof r!="symbol"?r+"":r,o),xe=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Re={};/*! *****************************************************************************
  Copyright (C) Microsoft. All rights reserved.
  Licensed under the Apache License, Version 2.0 (the "License"); you may not use
  this file except in compliance with the License. You may obtain a copy of the
  License at http://www.apache.org/licenses/LICENSE-2.0

  THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
  WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
  MERCHANTABLITY OR NON-INFRINGEMENT.

  See the Apache Version 2.0 License for specific language governing permissions
  and limitations under the License.
  ***************************************************************************** */var Ae;function Sr(){if(Ae)return Re;Ae=1;var i;return function(r){(function(o){var s=typeof globalThis=="object"?globalThis:typeof xe=="object"?xe:typeof self=="object"?self:typeof this=="object"?this:j(),w=g(r);typeof s.Reflect<"u"&&(w=g(s.Reflect,w)),o(w,s),typeof s.Reflect>"u"&&(s.Reflect=r);function g($,I){return function(E,R){Object.defineProperty($,E,{configurable:!0,writable:!0,value:R}),I&&I(E,R)}}function T(){try{return Function("return this;")()}catch{}}function S(){try{return(0,eval)("(function() { return this; })()")}catch{}}function j(){return T()||S()}})(function(o,s){var w=Object.prototype.hasOwnProperty,g=typeof Symbol=="function",T=g&&typeof Symbol.toPrimitive<"u"?Symbol.toPrimitive:"@@toPrimitive",S=g&&typeof Symbol.iterator<"u"?Symbol.iterator:"@@iterator",j=typeof Object.create=="function",$={__proto__:[]}instanceof Array,I=!j&&!$,E={create:j?function(){return L(Object.create(null))}:$?function(){return L({__proto__:null})}:function(){return L({})},has:I?function(t,e){return w.call(t,e)}:function(t,e){return e in t},get:I?function(t,e){return w.call(t,e)?t[e]:void 0}:function(t,e){return t[e]}},R=Object.getPrototypeOf(Function),A=typeof Map=="function"&&typeof Map.prototype.entries=="function"?Map:It(),W=typeof Set=="function"&&typeof Set.prototype.entries=="function"?Set:Pt(),K=typeof WeakMap=="function"?WeakMap:xt(),P=g?Symbol.for("@reflect-metadata:registry"):void 0,V=Et(),J=jt(V);function wt(t,e,n,a){if(d(n)){if(!at(t))throw new TypeError;if(!st(e))throw new TypeError;return vt(t,e)}else{if(!at(t))throw new TypeError;if(!b(e))throw new TypeError;if(!b(a)&&!d(a)&&!x(a))throw new TypeError;return x(a)&&(a=void 0),n=M(n),gt(t,e,n,a)}}o("decorate",wt);function F(t,e){function n(a,h){if(!b(a))throw new TypeError;if(!d(h)&&!St(h))throw new TypeError;et(t,e,a,h)}return n}o("metadata",F);function C(t,e,n,a){if(!b(n))throw new TypeError;return d(a)||(a=M(a)),et(t,e,n,a)}o("defineMetadata",C);function q(t,e,n){if(!b(e))throw new TypeError;return d(n)||(n=M(n)),Q(t,e,n)}o("hasMetadata",q);function G(t,e,n){if(!b(e))throw new TypeError;return d(n)||(n=M(n)),N(t,e,n)}o("hasOwnMetadata",G);function yt(t,e,n){if(!b(e))throw new TypeError;return d(n)||(n=M(n)),X(t,e,n)}o("getMetadata",yt);function Z(t,e,n){if(!b(e))throw new TypeError;return d(n)||(n=M(n)),tt(t,e,n)}o("getOwnMetadata",Z);function Y(t,e){if(!b(t))throw new TypeError;return d(e)||(e=M(e)),rt(t,e)}o("getMetadataKeys",Y);function pt(t,e){if(!b(t))throw new TypeError;return d(e)||(e=M(e)),nt(t,e)}o("getOwnMetadataKeys",pt);function _t(t,e,n){if(!b(e))throw new TypeError;if(d(n)||(n=M(n)),!b(e))throw new TypeError;d(n)||(n=M(n));var a=D(e,n,!1);return d(a)?!1:a.OrdinaryDeleteMetadata(t,e,n)}o("deleteMetadata",_t);function vt(t,e){for(var n=t.length-1;n>=0;--n){var a=t[n],h=a(e);if(!d(h)&&!x(h)){if(!st(h))throw new TypeError;e=h}}return e}function gt(t,e,n,a){for(var h=t.length-1;h>=0;--h){var k=t[h],m=k(e,n,a);if(!d(m)&&!x(m)){if(!b(m))throw new TypeError;a=m}}return a}function Q(t,e,n){var a=N(t,e,n);if(a)return!0;var h=U(e);return x(h)?!1:Q(t,h,n)}function N(t,e,n){var a=D(e,n,!1);return d(a)?!1:ot(a.OrdinaryHasOwnMetadata(t,e,n))}function X(t,e,n){var a=N(t,e,n);if(a)return tt(t,e,n);var h=U(e);if(!x(h))return X(t,h,n)}function tt(t,e,n){var a=D(e,n,!1);if(!d(a))return a.OrdinaryGetOwnMetadata(t,e,n)}function et(t,e,n,a){var h=D(n,a,!0);h.OrdinaryDefineOwnMetadata(t,e,n,a)}function rt(t,e){var n=nt(t,e),a=U(t);if(a===null)return n;var h=rt(a,e);if(h.length<=0)return n;if(n.length<=0)return h;for(var k=new W,m=[],p=0,u=n;p<u.length;p++){var c=u[p],f=k.has(c);f||(k.add(c),m.push(c))}for(var l=0,y=h;l<y.length;l++){var c=y[l],f=k.has(c);f||(k.add(c),m.push(c))}return m}function nt(t,e){var n=D(t,e,!1);return n?n.OrdinaryOwnMetadataKeys(t,e):[]}function it(t){if(t===null)return 1;switch(typeof t){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return t===null?1:6;default:return 6}}function d(t){return t===void 0}function x(t){return t===null}function bt(t){return typeof t=="symbol"}function b(t){return typeof t=="object"?t!==null:typeof t=="function"}function mt(t,e){switch(it(t)){case 0:return t;case 1:return t;case 2:return t;case 3:return t;case 4:return t;case 5:return t}var n="string",a=ut(t,T);if(a!==void 0){var h=a.call(t,n);if(b(h))throw new TypeError;return h}return kt(t)}function kt(t,e){var n,a;{var h=t.toString;if(z(h)){var a=h.call(t);if(!b(a))return a}var n=t.valueOf;if(z(n)){var a=n.call(t);if(!b(a))return a}}throw new TypeError}function ot(t){return!!t}function Ot(t){return""+t}function M(t){var e=mt(t);return bt(e)?e:Ot(e)}function at(t){return Array.isArray?Array.isArray(t):t instanceof Object?t instanceof Array:Object.prototype.toString.call(t)==="[object Array]"}function z(t){return typeof t=="function"}function st(t){return typeof t=="function"}function St(t){switch(it(t)){case 3:return!0;case 4:return!0;default:return!1}}function H(t,e){return t===e||t!==t&&e!==e}function ut(t,e){var n=t[e];if(n!=null){if(!z(n))throw new TypeError;return n}}function ct(t){var e=ut(t,S);if(!z(e))throw new TypeError;var n=e.call(t);if(!b(n))throw new TypeError;return n}function ft(t){return t.value}function lt(t){var e=t.next();return e.done?!1:e}function ht(t){var e=t.return;e&&e.call(t)}function U(t){var e=Object.getPrototypeOf(t);if(typeof t!="function"||t===R||e!==R)return e;var n=t.prototype,a=n&&Object.getPrototypeOf(n);if(a==null||a===Object.prototype)return e;var h=a.constructor;return typeof h!="function"||h===t?e:h}function Mt(){var t;!d(P)&&typeof s.Reflect<"u"&&!(P in s.Reflect)&&typeof s.Reflect.defineMetadata=="function"&&(t=Tt(s.Reflect));var e,n,a,h=new K,k={registerProvider:m,getProvider:u,setProvider:f};return k;function m(l){if(!Object.isExtensible(k))throw new Error("Cannot add provider to a frozen registry.");switch(!0){case t===l:break;case d(e):e=l;break;case e===l:break;case d(n):n=l;break;case n===l:break;default:a===void 0&&(a=new W),a.add(l);break}}function p(l,y){if(!d(e)){if(e.isProviderFor(l,y))return e;if(!d(n)){if(n.isProviderFor(l,y))return e;if(!d(a))for(var _=ct(a);;){var v=lt(_);if(!v)return;var O=ft(v);if(O.isProviderFor(l,y))return ht(_),O}}}if(!d(t)&&t.isProviderFor(l,y))return t}function u(l,y){var _=h.get(l),v;return d(_)||(v=_.get(y)),d(v)&&(v=p(l,y),d(v)||(d(_)&&(_=new A,h.set(l,_)),_.set(y,v))),v}function c(l){if(d(l))throw new TypeError;return e===l||n===l||!d(a)&&a.has(l)}function f(l,y,_){if(!c(_))throw new Error("Metadata provider not registered.");var v=u(l,y);if(v!==_){if(!d(v))return!1;var O=h.get(l);d(O)&&(O=new A,h.set(l,O)),O.set(y,_)}return!0}}function Et(){var t;return!d(P)&&b(s.Reflect)&&Object.isExtensible(s.Reflect)&&(t=s.Reflect[P]),d(t)&&(t=Mt()),!d(P)&&b(s.Reflect)&&Object.isExtensible(s.Reflect)&&Object.defineProperty(s.Reflect,P,{enumerable:!1,configurable:!1,writable:!1,value:t}),t}function jt(t){var e=new K,n={isProviderFor:function(c,f){var l=e.get(c);return d(l)?!1:l.has(f)},OrdinaryDefineOwnMetadata:m,OrdinaryHasOwnMetadata:h,OrdinaryGetOwnMetadata:k,OrdinaryOwnMetadataKeys:p,OrdinaryDeleteMetadata:u};return V.registerProvider(n),n;function a(c,f,l){var y=e.get(c),_=!1;if(d(y)){if(!l)return;y=new A,e.set(c,y),_=!0}var v=y.get(f);if(d(v)){if(!l)return;if(v=new A,y.set(f,v),!t.setProvider(c,f,n))throw y.delete(f),_&&e.delete(c),new Error("Wrong provider for target.")}return v}function h(c,f,l){var y=a(f,l,!1);return d(y)?!1:ot(y.has(c))}function k(c,f,l){var y=a(f,l,!1);if(!d(y))return y.get(c)}function m(c,f,l,y){var _=a(l,y,!0);_.set(c,f)}function p(c,f){var l=[],y=a(c,f,!1);if(d(y))return l;for(var _=y.keys(),v=ct(_),O=0;;){var dt=lt(v);if(!dt)return l.length=O,l;var Rt=ft(dt);try{l[O]=Rt}catch(At){try{ht(v)}finally{throw At}}O++}}function u(c,f,l){var y=a(f,l,!1);if(d(y)||!y.delete(c))return!1;if(y.size===0){var _=e.get(f);d(_)||(_.delete(l),_.size===0&&e.delete(_))}return!0}}function Tt(t){var e=t.defineMetadata,n=t.hasOwnMetadata,a=t.getOwnMetadata,h=t.getOwnMetadataKeys,k=t.deleteMetadata,m=new K,p={isProviderFor:function(u,c){var f=m.get(u);return!d(f)&&f.has(c)?!0:h(u,c).length?(d(f)&&(f=new W,m.set(u,f)),f.add(c),!0):!1},OrdinaryDefineOwnMetadata:e,OrdinaryHasOwnMetadata:n,OrdinaryGetOwnMetadata:a,OrdinaryOwnMetadataKeys:h,OrdinaryDeleteMetadata:k};return p}function D(t,e,n){var a=V.getProvider(t,e);if(!d(a))return a;if(n){if(V.setProvider(t,e,J))return J;throw new Error("Illegal state.")}}function It(){var t={},e=[],n=function(){function p(u,c,f){this._index=0,this._keys=u,this._values=c,this._selector=f}return p.prototype["@@iterator"]=function(){return this},p.prototype[S]=function(){return this},p.prototype.next=function(){var u=this._index;if(u>=0&&u<this._keys.length){var c=this._selector(this._keys[u],this._values[u]);return u+1>=this._keys.length?(this._index=-1,this._keys=e,this._values=e):this._index++,{value:c,done:!1}}return{value:void 0,done:!0}},p.prototype.throw=function(u){throw this._index>=0&&(this._index=-1,this._keys=e,this._values=e),u},p.prototype.return=function(u){return this._index>=0&&(this._index=-1,this._keys=e,this._values=e),{value:u,done:!0}},p}(),a=function(){function p(){this._keys=[],this._values=[],this._cacheKey=t,this._cacheIndex=-2}return Object.defineProperty(p.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),p.prototype.has=function(u){return this._find(u,!1)>=0},p.prototype.get=function(u){var c=this._find(u,!1);return c>=0?this._values[c]:void 0},p.prototype.set=function(u,c){var f=this._find(u,!0);return this._values[f]=c,this},p.prototype.delete=function(u){var c=this._find(u,!1);if(c>=0){for(var f=this._keys.length,l=c+1;l<f;l++)this._keys[l-1]=this._keys[l],this._values[l-1]=this._values[l];return this._keys.length--,this._values.length--,H(u,this._cacheKey)&&(this._cacheKey=t,this._cacheIndex=-2),!0}return!1},p.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=t,this._cacheIndex=-2},p.prototype.keys=function(){return new n(this._keys,this._values,h)},p.prototype.values=function(){return new n(this._keys,this._values,k)},p.prototype.entries=function(){return new n(this._keys,this._values,m)},p.prototype["@@iterator"]=function(){return this.entries()},p.prototype[S]=function(){return this.entries()},p.prototype._find=function(u,c){if(!H(this._cacheKey,u)){this._cacheIndex=-1;for(var f=0;f<this._keys.length;f++)if(H(this._keys[f],u)){this._cacheIndex=f;break}}return this._cacheIndex<0&&c&&(this._cacheIndex=this._keys.length,this._keys.push(u),this._values.push(void 0)),this._cacheIndex},p}();return a;function h(p,u){return p}function k(p,u){return u}function m(p,u){return[p,u]}}function Pt(){var t=function(){function e(){this._map=new A}return Object.defineProperty(e.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),e.prototype.has=function(n){return this._map.has(n)},e.prototype.add=function(n){return this._map.set(n,n),this},e.prototype.delete=function(n){return this._map.delete(n)},e.prototype.clear=function(){this._map.clear()},e.prototype.keys=function(){return this._map.keys()},e.prototype.values=function(){return this._map.keys()},e.prototype.entries=function(){return this._map.entries()},e.prototype["@@iterator"]=function(){return this.keys()},e.prototype[S]=function(){return this.keys()},e}();return t}function xt(){var t=16,e=E.create(),n=a();return function(){function u(){this._key=a()}return u.prototype.has=function(c){var f=h(c,!1);return f!==void 0?E.has(f,this._key):!1},u.prototype.get=function(c){var f=h(c,!1);return f!==void 0?E.get(f,this._key):void 0},u.prototype.set=function(c,f){var l=h(c,!0);return l[this._key]=f,this},u.prototype.delete=function(c){var f=h(c,!1);return f!==void 0?delete f[this._key]:!1},u.prototype.clear=function(){this._key=a()},u}();function a(){var u;do u="@@WeakMap@@"+p();while(E.has(e,u));return e[u]=!0,u}function h(u,c){if(!w.call(u,n)){if(!c)return;Object.defineProperty(u,n,{value:E.create()})}return u[n]}function k(u,c){for(var f=0;f<c;++f)u[f]=Math.random()*255|0;return u}function m(u){if(typeof Uint8Array=="function"){var c=new Uint8Array(u);return typeof crypto<"u"?crypto.getRandomValues(c):typeof msCrypto<"u"?msCrypto.getRandomValues(c):k(c,u),c}return k(new Array(u),u)}function p(){var u=m(t);u[6]=u[6]&79|64,u[8]=u[8]&191|128;for(var c="",f=0;f<t;++f){var l=u[f];(f===4||f===6||f===8)&&(c+="-"),l<16&&(c+="0"),c+=l.toString(16).toLowerCase()}return c}}function L(t){return t.__=void 0,delete t.__,t}})}(i||(i={})),Re}Sr();const he=Symbol("ARTIFACTS");let Mr=class{constructor(r){le(this,"_recognizableHooks",new Map),le(this,"_hookDependencies",new Map),le(this,"_installedHooks",new Map);for(const[o,{hook:s,deps:w}]of Object.entries(r))this._recognizableHooks.set(o,s),w&&this._hookDependencies.set(o,w||[])}isHookInstalled(r,o){const s=this._recognizableHooks.get(o);if(!s||!this._installedHooks.has(r))return!1;const w=this._installedHooks.get(r);return w?w.some(g=>g===s):!1}markHookAsInstalled(r,o){var s;const w=this._recognizableHooks.get(o);if(!w)throw new Error(`Hook ${o} not found`);this._installedHooks.has(r)||this._installedHooks.set(r,[]),(s=this._installedHooks.get(r))==null||s.push(w)}async installHook(r,o){const s=this._recognizableHooks.get(r);if(!s)throw new Error(`Hook ${r} not found`);if(this.isHookInstalled(o,r))return;const w=this._hookDependencies.get(r)||[];for(const T of w)await this.installHook(T,o);const g=Reflect.getMetadata(he,o)||{};Reflect.hasMetadata(he,o)||Reflect.defineMetadata(he,g,o);for(const T of s){const S=await T.install({sdk:o,artifacts:g});!S||typeof S!="object"||Object.assign(g,S)}this.markHookAsInstalled(o,r)}async installAllHooks(r){for(const o of this._recognizableHooks.keys())await this.installHook(o,r)}};var Er=Object.defineProperty,jr=(i,r,o)=>r in i?Er(i,r,{enumerable:!0,configurable:!0,writable:!0,value:o}):i[r]=o,Kt=(i,r,o)=>jr(i,typeof r!="symbol"?r+"":r,o),Tr=Object.defineProperty,Ir=(i,r,o)=>r in i?Tr(i,r,{enumerable:!0,configurable:!0,writable:!0,value:o}):i[r]=o,ee=(i,r,o)=>Ir(i,typeof r!="symbol"?r+"":r,o),$e=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},De={};/*! *****************************************************************************
  Copyright (C) Microsoft. All rights reserved.
  Licensed under the Apache License, Version 2.0 (the "License"); you may not use
  this file except in compliance with the License. You may obtain a copy of the
  License at http://www.apache.org/licenses/LICENSE-2.0

  THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
  WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
  MERCHANTABLITY OR NON-INFRINGEMENT.

  See the Apache Version 2.0 License for specific language governing permissions
  and limitations under the License.
  ***************************************************************************** */var Fe;function Pr(){if(Fe)return De;Fe=1;var i;return function(r){(function(o){var s=typeof globalThis=="object"?globalThis:typeof $e=="object"?$e:typeof self=="object"?self:typeof this=="object"?this:j(),w=g(r);typeof s.Reflect<"u"&&(w=g(s.Reflect,w)),o(w,s),typeof s.Reflect>"u"&&(s.Reflect=r);function g($,I){return function(E,R){Object.defineProperty($,E,{configurable:!0,writable:!0,value:R}),I&&I(E,R)}}function T(){try{return Function("return this;")()}catch{}}function S(){try{return(0,eval)("(function() { return this; })()")}catch{}}function j(){return T()||S()}})(function(o,s){var w=Object.prototype.hasOwnProperty,g=typeof Symbol=="function",T=g&&typeof Symbol.toPrimitive<"u"?Symbol.toPrimitive:"@@toPrimitive",S=g&&typeof Symbol.iterator<"u"?Symbol.iterator:"@@iterator",j=typeof Object.create=="function",$={__proto__:[]}instanceof Array,I=!j&&!$,E={create:j?function(){return L(Object.create(null))}:$?function(){return L({__proto__:null})}:function(){return L({})},has:I?function(t,e){return w.call(t,e)}:function(t,e){return e in t},get:I?function(t,e){return w.call(t,e)?t[e]:void 0}:function(t,e){return t[e]}},R=Object.getPrototypeOf(Function),A=typeof Map=="function"&&typeof Map.prototype.entries=="function"?Map:It(),W=typeof Set=="function"&&typeof Set.prototype.entries=="function"?Set:Pt(),K=typeof WeakMap=="function"?WeakMap:xt(),P=g?Symbol.for("@reflect-metadata:registry"):void 0,V=Et(),J=jt(V);function wt(t,e,n,a){if(d(n)){if(!at(t))throw new TypeError;if(!st(e))throw new TypeError;return vt(t,e)}else{if(!at(t))throw new TypeError;if(!b(e))throw new TypeError;if(!b(a)&&!d(a)&&!x(a))throw new TypeError;return x(a)&&(a=void 0),n=M(n),gt(t,e,n,a)}}o("decorate",wt);function F(t,e){function n(a,h){if(!b(a))throw new TypeError;if(!d(h)&&!St(h))throw new TypeError;et(t,e,a,h)}return n}o("metadata",F);function C(t,e,n,a){if(!b(n))throw new TypeError;return d(a)||(a=M(a)),et(t,e,n,a)}o("defineMetadata",C);function q(t,e,n){if(!b(e))throw new TypeError;return d(n)||(n=M(n)),Q(t,e,n)}o("hasMetadata",q);function G(t,e,n){if(!b(e))throw new TypeError;return d(n)||(n=M(n)),N(t,e,n)}o("hasOwnMetadata",G);function yt(t,e,n){if(!b(e))throw new TypeError;return d(n)||(n=M(n)),X(t,e,n)}o("getMetadata",yt);function Z(t,e,n){if(!b(e))throw new TypeError;return d(n)||(n=M(n)),tt(t,e,n)}o("getOwnMetadata",Z);function Y(t,e){if(!b(t))throw new TypeError;return d(e)||(e=M(e)),rt(t,e)}o("getMetadataKeys",Y);function pt(t,e){if(!b(t))throw new TypeError;return d(e)||(e=M(e)),nt(t,e)}o("getOwnMetadataKeys",pt);function _t(t,e,n){if(!b(e))throw new TypeError;if(d(n)||(n=M(n)),!b(e))throw new TypeError;d(n)||(n=M(n));var a=D(e,n,!1);return d(a)?!1:a.OrdinaryDeleteMetadata(t,e,n)}o("deleteMetadata",_t);function vt(t,e){for(var n=t.length-1;n>=0;--n){var a=t[n],h=a(e);if(!d(h)&&!x(h)){if(!st(h))throw new TypeError;e=h}}return e}function gt(t,e,n,a){for(var h=t.length-1;h>=0;--h){var k=t[h],m=k(e,n,a);if(!d(m)&&!x(m)){if(!b(m))throw new TypeError;a=m}}return a}function Q(t,e,n){var a=N(t,e,n);if(a)return!0;var h=U(e);return x(h)?!1:Q(t,h,n)}function N(t,e,n){var a=D(e,n,!1);return d(a)?!1:ot(a.OrdinaryHasOwnMetadata(t,e,n))}function X(t,e,n){var a=N(t,e,n);if(a)return tt(t,e,n);var h=U(e);if(!x(h))return X(t,h,n)}function tt(t,e,n){var a=D(e,n,!1);if(!d(a))return a.OrdinaryGetOwnMetadata(t,e,n)}function et(t,e,n,a){var h=D(n,a,!0);h.OrdinaryDefineOwnMetadata(t,e,n,a)}function rt(t,e){var n=nt(t,e),a=U(t);if(a===null)return n;var h=rt(a,e);if(h.length<=0)return n;if(n.length<=0)return h;for(var k=new W,m=[],p=0,u=n;p<u.length;p++){var c=u[p],f=k.has(c);f||(k.add(c),m.push(c))}for(var l=0,y=h;l<y.length;l++){var c=y[l],f=k.has(c);f||(k.add(c),m.push(c))}return m}function nt(t,e){var n=D(t,e,!1);return n?n.OrdinaryOwnMetadataKeys(t,e):[]}function it(t){if(t===null)return 1;switch(typeof t){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return t===null?1:6;default:return 6}}function d(t){return t===void 0}function x(t){return t===null}function bt(t){return typeof t=="symbol"}function b(t){return typeof t=="object"?t!==null:typeof t=="function"}function mt(t,e){switch(it(t)){case 0:return t;case 1:return t;case 2:return t;case 3:return t;case 4:return t;case 5:return t}var n="string",a=ut(t,T);if(a!==void 0){var h=a.call(t,n);if(b(h))throw new TypeError;return h}return kt(t)}function kt(t,e){var n,a;{var h=t.toString;if(z(h)){var a=h.call(t);if(!b(a))return a}var n=t.valueOf;if(z(n)){var a=n.call(t);if(!b(a))return a}}throw new TypeError}function ot(t){return!!t}function Ot(t){return""+t}function M(t){var e=mt(t);return bt(e)?e:Ot(e)}function at(t){return Array.isArray?Array.isArray(t):t instanceof Object?t instanceof Array:Object.prototype.toString.call(t)==="[object Array]"}function z(t){return typeof t=="function"}function st(t){return typeof t=="function"}function St(t){switch(it(t)){case 3:return!0;case 4:return!0;default:return!1}}function H(t,e){return t===e||t!==t&&e!==e}function ut(t,e){var n=t[e];if(n!=null){if(!z(n))throw new TypeError;return n}}function ct(t){var e=ut(t,S);if(!z(e))throw new TypeError;var n=e.call(t);if(!b(n))throw new TypeError;return n}function ft(t){return t.value}function lt(t){var e=t.next();return e.done?!1:e}function ht(t){var e=t.return;e&&e.call(t)}function U(t){var e=Object.getPrototypeOf(t);if(typeof t!="function"||t===R||e!==R)return e;var n=t.prototype,a=n&&Object.getPrototypeOf(n);if(a==null||a===Object.prototype)return e;var h=a.constructor;return typeof h!="function"||h===t?e:h}function Mt(){var t;!d(P)&&typeof s.Reflect<"u"&&!(P in s.Reflect)&&typeof s.Reflect.defineMetadata=="function"&&(t=Tt(s.Reflect));var e,n,a,h=new K,k={registerProvider:m,getProvider:u,setProvider:f};return k;function m(l){if(!Object.isExtensible(k))throw new Error("Cannot add provider to a frozen registry.");switch(!0){case t===l:break;case d(e):e=l;break;case e===l:break;case d(n):n=l;break;case n===l:break;default:a===void 0&&(a=new W),a.add(l);break}}function p(l,y){if(!d(e)){if(e.isProviderFor(l,y))return e;if(!d(n)){if(n.isProviderFor(l,y))return e;if(!d(a))for(var _=ct(a);;){var v=lt(_);if(!v)return;var O=ft(v);if(O.isProviderFor(l,y))return ht(_),O}}}if(!d(t)&&t.isProviderFor(l,y))return t}function u(l,y){var _=h.get(l),v;return d(_)||(v=_.get(y)),d(v)&&(v=p(l,y),d(v)||(d(_)&&(_=new A,h.set(l,_)),_.set(y,v))),v}function c(l){if(d(l))throw new TypeError;return e===l||n===l||!d(a)&&a.has(l)}function f(l,y,_){if(!c(_))throw new Error("Metadata provider not registered.");var v=u(l,y);if(v!==_){if(!d(v))return!1;var O=h.get(l);d(O)&&(O=new A,h.set(l,O)),O.set(y,_)}return!0}}function Et(){var t;return!d(P)&&b(s.Reflect)&&Object.isExtensible(s.Reflect)&&(t=s.Reflect[P]),d(t)&&(t=Mt()),!d(P)&&b(s.Reflect)&&Object.isExtensible(s.Reflect)&&Object.defineProperty(s.Reflect,P,{enumerable:!1,configurable:!1,writable:!1,value:t}),t}function jt(t){var e=new K,n={isProviderFor:function(c,f){var l=e.get(c);return d(l)?!1:l.has(f)},OrdinaryDefineOwnMetadata:m,OrdinaryHasOwnMetadata:h,OrdinaryGetOwnMetadata:k,OrdinaryOwnMetadataKeys:p,OrdinaryDeleteMetadata:u};return V.registerProvider(n),n;function a(c,f,l){var y=e.get(c),_=!1;if(d(y)){if(!l)return;y=new A,e.set(c,y),_=!0}var v=y.get(f);if(d(v)){if(!l)return;if(v=new A,y.set(f,v),!t.setProvider(c,f,n))throw y.delete(f),_&&e.delete(c),new Error("Wrong provider for target.")}return v}function h(c,f,l){var y=a(f,l,!1);return d(y)?!1:ot(y.has(c))}function k(c,f,l){var y=a(f,l,!1);if(!d(y))return y.get(c)}function m(c,f,l,y){var _=a(l,y,!0);_.set(c,f)}function p(c,f){var l=[],y=a(c,f,!1);if(d(y))return l;for(var _=y.keys(),v=ct(_),O=0;;){var dt=lt(v);if(!dt)return l.length=O,l;var Rt=ft(dt);try{l[O]=Rt}catch(At){try{ht(v)}finally{throw At}}O++}}function u(c,f,l){var y=a(f,l,!1);if(d(y)||!y.delete(c))return!1;if(y.size===0){var _=e.get(f);d(_)||(_.delete(l),_.size===0&&e.delete(_))}return!0}}function Tt(t){var e=t.defineMetadata,n=t.hasOwnMetadata,a=t.getOwnMetadata,h=t.getOwnMetadataKeys,k=t.deleteMetadata,m=new K,p={isProviderFor:function(u,c){var f=m.get(u);return!d(f)&&f.has(c)?!0:h(u,c).length?(d(f)&&(f=new W,m.set(u,f)),f.add(c),!0):!1},OrdinaryDefineOwnMetadata:e,OrdinaryHasOwnMetadata:n,OrdinaryGetOwnMetadata:a,OrdinaryOwnMetadataKeys:h,OrdinaryDeleteMetadata:k};return p}function D(t,e,n){var a=V.getProvider(t,e);if(!d(a))return a;if(n){if(V.setProvider(t,e,J))return J;throw new Error("Illegal state.")}}function It(){var t={},e=[],n=function(){function p(u,c,f){this._index=0,this._keys=u,this._values=c,this._selector=f}return p.prototype["@@iterator"]=function(){return this},p.prototype[S]=function(){return this},p.prototype.next=function(){var u=this._index;if(u>=0&&u<this._keys.length){var c=this._selector(this._keys[u],this._values[u]);return u+1>=this._keys.length?(this._index=-1,this._keys=e,this._values=e):this._index++,{value:c,done:!1}}return{value:void 0,done:!0}},p.prototype.throw=function(u){throw this._index>=0&&(this._index=-1,this._keys=e,this._values=e),u},p.prototype.return=function(u){return this._index>=0&&(this._index=-1,this._keys=e,this._values=e),{value:u,done:!0}},p}(),a=function(){function p(){this._keys=[],this._values=[],this._cacheKey=t,this._cacheIndex=-2}return Object.defineProperty(p.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),p.prototype.has=function(u){return this._find(u,!1)>=0},p.prototype.get=function(u){var c=this._find(u,!1);return c>=0?this._values[c]:void 0},p.prototype.set=function(u,c){var f=this._find(u,!0);return this._values[f]=c,this},p.prototype.delete=function(u){var c=this._find(u,!1);if(c>=0){for(var f=this._keys.length,l=c+1;l<f;l++)this._keys[l-1]=this._keys[l],this._values[l-1]=this._values[l];return this._keys.length--,this._values.length--,H(u,this._cacheKey)&&(this._cacheKey=t,this._cacheIndex=-2),!0}return!1},p.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=t,this._cacheIndex=-2},p.prototype.keys=function(){return new n(this._keys,this._values,h)},p.prototype.values=function(){return new n(this._keys,this._values,k)},p.prototype.entries=function(){return new n(this._keys,this._values,m)},p.prototype["@@iterator"]=function(){return this.entries()},p.prototype[S]=function(){return this.entries()},p.prototype._find=function(u,c){if(!H(this._cacheKey,u)){this._cacheIndex=-1;for(var f=0;f<this._keys.length;f++)if(H(this._keys[f],u)){this._cacheIndex=f;break}}return this._cacheIndex<0&&c&&(this._cacheIndex=this._keys.length,this._keys.push(u),this._values.push(void 0)),this._cacheIndex},p}();return a;function h(p,u){return p}function k(p,u){return u}function m(p,u){return[p,u]}}function Pt(){var t=function(){function e(){this._map=new A}return Object.defineProperty(e.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),e.prototype.has=function(n){return this._map.has(n)},e.prototype.add=function(n){return this._map.set(n,n),this},e.prototype.delete=function(n){return this._map.delete(n)},e.prototype.clear=function(){this._map.clear()},e.prototype.keys=function(){return this._map.keys()},e.prototype.values=function(){return this._map.keys()},e.prototype.entries=function(){return this._map.entries()},e.prototype["@@iterator"]=function(){return this.keys()},e.prototype[S]=function(){return this.keys()},e}();return t}function xt(){var t=16,e=E.create(),n=a();return function(){function u(){this._key=a()}return u.prototype.has=function(c){var f=h(c,!1);return f!==void 0?E.has(f,this._key):!1},u.prototype.get=function(c){var f=h(c,!1);return f!==void 0?E.get(f,this._key):void 0},u.prototype.set=function(c,f){var l=h(c,!0);return l[this._key]=f,this},u.prototype.delete=function(c){var f=h(c,!1);return f!==void 0?delete f[this._key]:!1},u.prototype.clear=function(){this._key=a()},u}();function a(){var u;do u="@@WeakMap@@"+p();while(E.has(e,u));return e[u]=!0,u}function h(u,c){if(!w.call(u,n)){if(!c)return;Object.defineProperty(u,n,{value:E.create()})}return u[n]}function k(u,c){for(var f=0;f<c;++f)u[f]=Math.random()*255|0;return u}function m(u){if(typeof Uint8Array=="function"){var c=new Uint8Array(u);return typeof crypto<"u"?crypto.getRandomValues(c):typeof msCrypto<"u"?msCrypto.getRandomValues(c):k(c,u),c}return k(new Array(u),u)}function p(){var u=m(t);u[6]=u[6]&79|64,u[8]=u[8]&191|128;for(var c="",f=0;f<t;++f){var l=u[f];(f===4||f===6||f===8)&&(c+="-"),l<16&&(c+="0"),c+=l.toString(16).toLowerCase()}return c}}function L(t){return t.__=void 0,delete t.__,t}})}(i||(i={})),De}Pr();var xr=Object.defineProperty,Rr=(i,r,o)=>r in i?xr(i,r,{enumerable:!0,configurable:!0,writable:!0,value:o}):i[r]=o,Wt=(i,r,o)=>Rr(i,typeof r!="symbol"?r+"":r,o);let Ar=class{constructor(r,o){Wt(this,"_target"),Wt(this,"_key"),Wt(this,"_oldValue"),Wt(this,"_wasDefined",!1),Wt(this,"_isSwapped",!1),this._target=r,this._key=o,this._oldValue=this._target[this._key]}get isSwapped(){return this._isSwapped}get originalValue(){return this._oldValue}get value(){return this._target[this._key]}get target(){return this._target}restore(){this.isSwapped&&(this._wasDefined?this._target[this._key]=this._oldValue:delete this._target[this._key],this._isSwapped=!1)}swap(r){this.isSwapped||(this._wasDefined=Object.hasOwn(this._target,this._key),this._oldValue=this._target[this._key]),this._target[this._key]=r,this._isSwapped=!0}};const $r={onlyIfNotExists:!0,isFactory:!1};class re{constructor(r,o,s={}){if(ee(this,"_installedInstances",new Map),ee(this,"_path"),ee(this,"_targetValue"),ee(this,"_options"),this._path=r.split("."),this._path.length===0)throw new Error("Path must not be empty");this._targetValue=o,this._options={...$r,...s}}_getTargetObject(r){let o=r;for(const s of this._path.slice(0,this._path.length-1))o[s]||(o[s]={}),o=o[s];return o}_createSwapper(r){const o=this._getTargetObject(r);return new Ar(o,this._path.at(-1))}install({sdk:r,...o}){if(this._installedInstances.has(r))return;const s=this._createSwapper(r);if(!(s.value&&this._options.onlyIfNotExists)){if(this._options.isFactory&&typeof this._targetValue=="function"){const w=this._targetValue({sdk:r,...o});s.swap(w)}else s.swap(this._targetValue);this._installedInstances.set(r,s)}}uninstall({sdk:r}){const o=this._installedInstances.get(r);o&&(o.restore(),this._installedInstances.delete(r))}}function Ve(){return"unsafeWindow"in window?window.unsafeWindow:window}var Dr=Object.defineProperty,Fr=(i,r,o)=>r in i?Dr(i,r,{enumerable:!0,configurable:!0,writable:!0,value:o}):i[r]=o,$t=(i,r,o)=>Fr(i,typeof r!="symbol"?r+"":r,o);class Vr{constructor(r,o){$t(this,"_target"),$t(this,"_key"),$t(this,"_oldValue"),$t(this,"_wasDefined",!1),$t(this,"_isSwapped",!1),this._target=r,this._key=o,this._oldValue=this._target[this._key]}get isSwapped(){return this._isSwapped}get originalValue(){return this._oldValue}get value(){return this._target[this._key]}get target(){return this._target}restore(){this.isSwapped&&(this._wasDefined?this._target[this._key]=this._oldValue:delete this._target[this._key],this._isSwapped=!1)}swap(r){this.isSwapped||(this._wasDefined=Object.hasOwn(this._target,this._key),this._oldValue=this._target[this._key]),this._target[this._key]=r,this._isSwapped=!0}}let de=class{constructor(r,o,s){$t(this,"_enabled",!1),$t(this,"_fnSwapper"),$t(this,"_interceptionFunction"),$t(this,"_middlewares",[]),this._fnSwapper=new Vr(r,o),this._interceptionFunction=s}get enabled(){return this._fnSwapper.isSwapped&&this._enabled}disable(){this._enabled=!1,this.enabled}restore(){this._fnSwapper.restore()}enable(){this._enabled=!0,this._fnSwapper.isSwapped||this.swapToInterceptor()}swapToInterceptor(){const r=this;this._fnSwapper.swap(function(...o){if(!r._enabled)return r.callOriginalInvocator(...o);const s=r.runMiddlewares(o);if(s){if("output"in s)return s.output;"input"in s&&(o=s.input)}return r._interceptionFunction.call(this,r.getOriginalInvocator(this),...o)})}getOriginalInvocator(r){return this._fnSwapper.originalValue.bind(r??this._fnSwapper.target)}callOriginalInvocator(...r){return this.getOriginalInvocator()(...r)}runMiddlewares(r){for(const o of this._middlewares){const s=o(...r);if(s){if("output"in s)return s;"input"in s&&(r=s.input)}}return{input:r}}registerMiddleware(r){this._middlewares.push(r)}};function Cr(i,r){try{return i()}catch{return r}}let zr=class extends de{constructor(r,o,s){super(r,o,s),$t(this,"_loggedInvocationRequests",[]),this.registerMiddleware((...w)=>this.logRequest(...w))}logRequest(...r){this._loggedInvocationRequests.push(r)}flushLoggedRequests(){const r=this.getLoggedRequests();return this._loggedInvocationRequests=[],r}getLoggedRequests(){return this._loggedInvocationRequests}executeOriginalLoggedRequests(){this.flushLoggedRequests().forEach(r=>Cr(()=>this.callOriginalInvocator(...r)))}},Kr=class{constructor(){Kt(this,"_hasResult",!1),Kt(this,"result")}store(r){return this.result=r,this._hasResult=!0,r}clear(){this.result=void 0,this._hasResult=!1}getResult(){if(!this.hasResult)throw new Error("No result is stored");return this.result}get hasResult(){return this._hasResult}};function Wr(i){const r=new Kr;new de(i,"doAction",(o,...s)=>r.hasResult?r.getResult():r.store(o(...s))).enable(),new de(i,"undoAction",(o,...s)=>{const w=o(...s);return r.clear(),w}).enable()}let Nr=class{constructor(){Kt(this,"actions",[]),Kt(this,"undoableActions",[])}acceptAction(r,o){const s={action:r,dataModel:o};r.undoSupported()&&(Wr(r),r.doAction(o),this.undoableActions.push(s)),this.actions.push(s)}undoAll(){this.undoableActions.forEach(({action:r,dataModel:o})=>r.undoAction(o))}getActions(){return this.actions.map(({action:r})=>r)}};function Hr(){try{return Ve().require("Waze/Action/MultiAction")}catch{return null}}function Ur(i){const r=Hr();if(!r)throw new Error("Unable to retrieve MultiAction");return new r(i)}let Lr=class{constructor(r){Kt(this,"_activeTransaction",null),Kt(this,"_actionManagerAddInterceptor"),this._actionManagerAddInterceptor=new zr(r,"add",(o,s)=>{var w,g;return(g=(w=this._activeTransaction)==null?void 0:w.acceptAction)==null||g.call(w,s,r.dataModel),!0})}openTransaction(){this._activeTransaction=new Nr,this._actionManagerAddInterceptor.enable()}closeTransaction(){const r=this._activeTransaction;return this._activeTransaction=null,this._actionManagerAddInterceptor.flushLoggedRequests(),this._actionManagerAddInterceptor.disable(),r}get hasTransaction(){return this._activeTransaction!==null}beginTransaction(){this.openTransaction()}commitTransaction(r){if(!this.hasTransaction)throw new Error("No open transaction found");try{const o=this._activeTransaction.getActions(),s=Ur(o);r&&(s._description=r),this._actionManagerAddInterceptor.callOriginalInvocator(s)}catch{this._actionManagerAddInterceptor.executeOriginalLoggedRequests()}finally{this.closeTransaction()}}cancelTransaction(){var r;(r=this._activeTransaction)==null||r.undoAll(),this.closeTransaction()}},pe;function ne(){if(!pe){const i=Ve();pe=new Lr(i.W.model.actionManager)}return pe}const qr=[new re("Editing.beginTransaction",()=>ne().beginTransaction()),new re("Editing.commitTransaction",i=>ne().commitTransaction(i)),new re("Editing.cancelTransaction",()=>ne().cancelTransaction()),new re("Editing.doActions",(i,r)=>{const o=ne();o.beginTransaction();try{i(),o.commitTransaction(r)}catch(s){throw o.cancelTransaction(),s}})];var Gr=Object.defineProperty,Br=(i,r,o)=>r in i?Gr(i,r,{enumerable:!0,configurable:!0,writable:!0,value:o}):i[r]=o,ie=(i,r,o)=>Br(i,typeof r!="symbol"?r+"":r,o),Ce=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},ze={};/*! *****************************************************************************
  Copyright (C) Microsoft. All rights reserved.
  Licensed under the Apache License, Version 2.0 (the "License"); you may not use
  this file except in compliance with the License. You may obtain a copy of the
  License at http://www.apache.org/licenses/LICENSE-2.0

  THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
  WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
  MERCHANTABLITY OR NON-INFRINGEMENT.

  See the Apache Version 2.0 License for specific language governing permissions
  and limitations under the License.
  ***************************************************************************** */var Ke;function Jr(){if(Ke)return ze;Ke=1;var i;return function(r){(function(o){var s=typeof globalThis=="object"?globalThis:typeof Ce=="object"?Ce:typeof self=="object"?self:typeof this=="object"?this:j(),w=g(r);typeof s.Reflect<"u"&&(w=g(s.Reflect,w)),o(w,s),typeof s.Reflect>"u"&&(s.Reflect=r);function g($,I){return function(E,R){Object.defineProperty($,E,{configurable:!0,writable:!0,value:R}),I&&I(E,R)}}function T(){try{return Function("return this;")()}catch{}}function S(){try{return(0,eval)("(function() { return this; })()")}catch{}}function j(){return T()||S()}})(function(o,s){var w=Object.prototype.hasOwnProperty,g=typeof Symbol=="function",T=g&&typeof Symbol.toPrimitive<"u"?Symbol.toPrimitive:"@@toPrimitive",S=g&&typeof Symbol.iterator<"u"?Symbol.iterator:"@@iterator",j=typeof Object.create=="function",$={__proto__:[]}instanceof Array,I=!j&&!$,E={create:j?function(){return L(Object.create(null))}:$?function(){return L({__proto__:null})}:function(){return L({})},has:I?function(t,e){return w.call(t,e)}:function(t,e){return e in t},get:I?function(t,e){return w.call(t,e)?t[e]:void 0}:function(t,e){return t[e]}},R=Object.getPrototypeOf(Function),A=typeof Map=="function"&&typeof Map.prototype.entries=="function"?Map:It(),W=typeof Set=="function"&&typeof Set.prototype.entries=="function"?Set:Pt(),K=typeof WeakMap=="function"?WeakMap:xt(),P=g?Symbol.for("@reflect-metadata:registry"):void 0,V=Et(),J=jt(V);function wt(t,e,n,a){if(d(n)){if(!at(t))throw new TypeError;if(!st(e))throw new TypeError;return vt(t,e)}else{if(!at(t))throw new TypeError;if(!b(e))throw new TypeError;if(!b(a)&&!d(a)&&!x(a))throw new TypeError;return x(a)&&(a=void 0),n=M(n),gt(t,e,n,a)}}o("decorate",wt);function F(t,e){function n(a,h){if(!b(a))throw new TypeError;if(!d(h)&&!St(h))throw new TypeError;et(t,e,a,h)}return n}o("metadata",F);function C(t,e,n,a){if(!b(n))throw new TypeError;return d(a)||(a=M(a)),et(t,e,n,a)}o("defineMetadata",C);function q(t,e,n){if(!b(e))throw new TypeError;return d(n)||(n=M(n)),Q(t,e,n)}o("hasMetadata",q);function G(t,e,n){if(!b(e))throw new TypeError;return d(n)||(n=M(n)),N(t,e,n)}o("hasOwnMetadata",G);function yt(t,e,n){if(!b(e))throw new TypeError;return d(n)||(n=M(n)),X(t,e,n)}o("getMetadata",yt);function Z(t,e,n){if(!b(e))throw new TypeError;return d(n)||(n=M(n)),tt(t,e,n)}o("getOwnMetadata",Z);function Y(t,e){if(!b(t))throw new TypeError;return d(e)||(e=M(e)),rt(t,e)}o("getMetadataKeys",Y);function pt(t,e){if(!b(t))throw new TypeError;return d(e)||(e=M(e)),nt(t,e)}o("getOwnMetadataKeys",pt);function _t(t,e,n){if(!b(e))throw new TypeError;if(d(n)||(n=M(n)),!b(e))throw new TypeError;d(n)||(n=M(n));var a=D(e,n,!1);return d(a)?!1:a.OrdinaryDeleteMetadata(t,e,n)}o("deleteMetadata",_t);function vt(t,e){for(var n=t.length-1;n>=0;--n){var a=t[n],h=a(e);if(!d(h)&&!x(h)){if(!st(h))throw new TypeError;e=h}}return e}function gt(t,e,n,a){for(var h=t.length-1;h>=0;--h){var k=t[h],m=k(e,n,a);if(!d(m)&&!x(m)){if(!b(m))throw new TypeError;a=m}}return a}function Q(t,e,n){var a=N(t,e,n);if(a)return!0;var h=U(e);return x(h)?!1:Q(t,h,n)}function N(t,e,n){var a=D(e,n,!1);return d(a)?!1:ot(a.OrdinaryHasOwnMetadata(t,e,n))}function X(t,e,n){var a=N(t,e,n);if(a)return tt(t,e,n);var h=U(e);if(!x(h))return X(t,h,n)}function tt(t,e,n){var a=D(e,n,!1);if(!d(a))return a.OrdinaryGetOwnMetadata(t,e,n)}function et(t,e,n,a){var h=D(n,a,!0);h.OrdinaryDefineOwnMetadata(t,e,n,a)}function rt(t,e){var n=nt(t,e),a=U(t);if(a===null)return n;var h=rt(a,e);if(h.length<=0)return n;if(n.length<=0)return h;for(var k=new W,m=[],p=0,u=n;p<u.length;p++){var c=u[p],f=k.has(c);f||(k.add(c),m.push(c))}for(var l=0,y=h;l<y.length;l++){var c=y[l],f=k.has(c);f||(k.add(c),m.push(c))}return m}function nt(t,e){var n=D(t,e,!1);return n?n.OrdinaryOwnMetadataKeys(t,e):[]}function it(t){if(t===null)return 1;switch(typeof t){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return t===null?1:6;default:return 6}}function d(t){return t===void 0}function x(t){return t===null}function bt(t){return typeof t=="symbol"}function b(t){return typeof t=="object"?t!==null:typeof t=="function"}function mt(t,e){switch(it(t)){case 0:return t;case 1:return t;case 2:return t;case 3:return t;case 4:return t;case 5:return t}var n="string",a=ut(t,T);if(a!==void 0){var h=a.call(t,n);if(b(h))throw new TypeError;return h}return kt(t)}function kt(t,e){var n,a;{var h=t.toString;if(z(h)){var a=h.call(t);if(!b(a))return a}var n=t.valueOf;if(z(n)){var a=n.call(t);if(!b(a))return a}}throw new TypeError}function ot(t){return!!t}function Ot(t){return""+t}function M(t){var e=mt(t);return bt(e)?e:Ot(e)}function at(t){return Array.isArray?Array.isArray(t):t instanceof Object?t instanceof Array:Object.prototype.toString.call(t)==="[object Array]"}function z(t){return typeof t=="function"}function st(t){return typeof t=="function"}function St(t){switch(it(t)){case 3:return!0;case 4:return!0;default:return!1}}function H(t,e){return t===e||t!==t&&e!==e}function ut(t,e){var n=t[e];if(n!=null){if(!z(n))throw new TypeError;return n}}function ct(t){var e=ut(t,S);if(!z(e))throw new TypeError;var n=e.call(t);if(!b(n))throw new TypeError;return n}function ft(t){return t.value}function lt(t){var e=t.next();return e.done?!1:e}function ht(t){var e=t.return;e&&e.call(t)}function U(t){var e=Object.getPrototypeOf(t);if(typeof t!="function"||t===R||e!==R)return e;var n=t.prototype,a=n&&Object.getPrototypeOf(n);if(a==null||a===Object.prototype)return e;var h=a.constructor;return typeof h!="function"||h===t?e:h}function Mt(){var t;!d(P)&&typeof s.Reflect<"u"&&!(P in s.Reflect)&&typeof s.Reflect.defineMetadata=="function"&&(t=Tt(s.Reflect));var e,n,a,h=new K,k={registerProvider:m,getProvider:u,setProvider:f};return k;function m(l){if(!Object.isExtensible(k))throw new Error("Cannot add provider to a frozen registry.");switch(!0){case t===l:break;case d(e):e=l;break;case e===l:break;case d(n):n=l;break;case n===l:break;default:a===void 0&&(a=new W),a.add(l);break}}function p(l,y){if(!d(e)){if(e.isProviderFor(l,y))return e;if(!d(n)){if(n.isProviderFor(l,y))return e;if(!d(a))for(var _=ct(a);;){var v=lt(_);if(!v)return;var O=ft(v);if(O.isProviderFor(l,y))return ht(_),O}}}if(!d(t)&&t.isProviderFor(l,y))return t}function u(l,y){var _=h.get(l),v;return d(_)||(v=_.get(y)),d(v)&&(v=p(l,y),d(v)||(d(_)&&(_=new A,h.set(l,_)),_.set(y,v))),v}function c(l){if(d(l))throw new TypeError;return e===l||n===l||!d(a)&&a.has(l)}function f(l,y,_){if(!c(_))throw new Error("Metadata provider not registered.");var v=u(l,y);if(v!==_){if(!d(v))return!1;var O=h.get(l);d(O)&&(O=new A,h.set(l,O)),O.set(y,_)}return!0}}function Et(){var t;return!d(P)&&b(s.Reflect)&&Object.isExtensible(s.Reflect)&&(t=s.Reflect[P]),d(t)&&(t=Mt()),!d(P)&&b(s.Reflect)&&Object.isExtensible(s.Reflect)&&Object.defineProperty(s.Reflect,P,{enumerable:!1,configurable:!1,writable:!1,value:t}),t}function jt(t){var e=new K,n={isProviderFor:function(c,f){var l=e.get(c);return d(l)?!1:l.has(f)},OrdinaryDefineOwnMetadata:m,OrdinaryHasOwnMetadata:h,OrdinaryGetOwnMetadata:k,OrdinaryOwnMetadataKeys:p,OrdinaryDeleteMetadata:u};return V.registerProvider(n),n;function a(c,f,l){var y=e.get(c),_=!1;if(d(y)){if(!l)return;y=new A,e.set(c,y),_=!0}var v=y.get(f);if(d(v)){if(!l)return;if(v=new A,y.set(f,v),!t.setProvider(c,f,n))throw y.delete(f),_&&e.delete(c),new Error("Wrong provider for target.")}return v}function h(c,f,l){var y=a(f,l,!1);return d(y)?!1:ot(y.has(c))}function k(c,f,l){var y=a(f,l,!1);if(!d(y))return y.get(c)}function m(c,f,l,y){var _=a(l,y,!0);_.set(c,f)}function p(c,f){var l=[],y=a(c,f,!1);if(d(y))return l;for(var _=y.keys(),v=ct(_),O=0;;){var dt=lt(v);if(!dt)return l.length=O,l;var Rt=ft(dt);try{l[O]=Rt}catch(At){try{ht(v)}finally{throw At}}O++}}function u(c,f,l){var y=a(f,l,!1);if(d(y)||!y.delete(c))return!1;if(y.size===0){var _=e.get(f);d(_)||(_.delete(l),_.size===0&&e.delete(_))}return!0}}function Tt(t){var e=t.defineMetadata,n=t.hasOwnMetadata,a=t.getOwnMetadata,h=t.getOwnMetadataKeys,k=t.deleteMetadata,m=new K,p={isProviderFor:function(u,c){var f=m.get(u);return!d(f)&&f.has(c)?!0:h(u,c).length?(d(f)&&(f=new W,m.set(u,f)),f.add(c),!0):!1},OrdinaryDefineOwnMetadata:e,OrdinaryHasOwnMetadata:n,OrdinaryGetOwnMetadata:a,OrdinaryOwnMetadataKeys:h,OrdinaryDeleteMetadata:k};return p}function D(t,e,n){var a=V.getProvider(t,e);if(!d(a))return a;if(n){if(V.setProvider(t,e,J))return J;throw new Error("Illegal state.")}}function It(){var t={},e=[],n=function(){function p(u,c,f){this._index=0,this._keys=u,this._values=c,this._selector=f}return p.prototype["@@iterator"]=function(){return this},p.prototype[S]=function(){return this},p.prototype.next=function(){var u=this._index;if(u>=0&&u<this._keys.length){var c=this._selector(this._keys[u],this._values[u]);return u+1>=this._keys.length?(this._index=-1,this._keys=e,this._values=e):this._index++,{value:c,done:!1}}return{value:void 0,done:!0}},p.prototype.throw=function(u){throw this._index>=0&&(this._index=-1,this._keys=e,this._values=e),u},p.prototype.return=function(u){return this._index>=0&&(this._index=-1,this._keys=e,this._values=e),{value:u,done:!0}},p}(),a=function(){function p(){this._keys=[],this._values=[],this._cacheKey=t,this._cacheIndex=-2}return Object.defineProperty(p.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),p.prototype.has=function(u){return this._find(u,!1)>=0},p.prototype.get=function(u){var c=this._find(u,!1);return c>=0?this._values[c]:void 0},p.prototype.set=function(u,c){var f=this._find(u,!0);return this._values[f]=c,this},p.prototype.delete=function(u){var c=this._find(u,!1);if(c>=0){for(var f=this._keys.length,l=c+1;l<f;l++)this._keys[l-1]=this._keys[l],this._values[l-1]=this._values[l];return this._keys.length--,this._values.length--,H(u,this._cacheKey)&&(this._cacheKey=t,this._cacheIndex=-2),!0}return!1},p.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=t,this._cacheIndex=-2},p.prototype.keys=function(){return new n(this._keys,this._values,h)},p.prototype.values=function(){return new n(this._keys,this._values,k)},p.prototype.entries=function(){return new n(this._keys,this._values,m)},p.prototype["@@iterator"]=function(){return this.entries()},p.prototype[S]=function(){return this.entries()},p.prototype._find=function(u,c){if(!H(this._cacheKey,u)){this._cacheIndex=-1;for(var f=0;f<this._keys.length;f++)if(H(this._keys[f],u)){this._cacheIndex=f;break}}return this._cacheIndex<0&&c&&(this._cacheIndex=this._keys.length,this._keys.push(u),this._values.push(void 0)),this._cacheIndex},p}();return a;function h(p,u){return p}function k(p,u){return u}function m(p,u){return[p,u]}}function Pt(){var t=function(){function e(){this._map=new A}return Object.defineProperty(e.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),e.prototype.has=function(n){return this._map.has(n)},e.prototype.add=function(n){return this._map.set(n,n),this},e.prototype.delete=function(n){return this._map.delete(n)},e.prototype.clear=function(){this._map.clear()},e.prototype.keys=function(){return this._map.keys()},e.prototype.values=function(){return this._map.keys()},e.prototype.entries=function(){return this._map.entries()},e.prototype["@@iterator"]=function(){return this.keys()},e.prototype[S]=function(){return this.keys()},e}();return t}function xt(){var t=16,e=E.create(),n=a();return function(){function u(){this._key=a()}return u.prototype.has=function(c){var f=h(c,!1);return f!==void 0?E.has(f,this._key):!1},u.prototype.get=function(c){var f=h(c,!1);return f!==void 0?E.get(f,this._key):void 0},u.prototype.set=function(c,f){var l=h(c,!0);return l[this._key]=f,this},u.prototype.delete=function(c){var f=h(c,!1);return f!==void 0?delete f[this._key]:!1},u.prototype.clear=function(){this._key=a()},u}();function a(){var u;do u="@@WeakMap@@"+p();while(E.has(e,u));return e[u]=!0,u}function h(u,c){if(!w.call(u,n)){if(!c)return;Object.defineProperty(u,n,{value:E.create()})}return u[n]}function k(u,c){for(var f=0;f<c;++f)u[f]=Math.random()*255|0;return u}function m(u){if(typeof Uint8Array=="function"){var c=new Uint8Array(u);return typeof crypto<"u"?crypto.getRandomValues(c):typeof msCrypto<"u"?msCrypto.getRandomValues(c):k(c,u),c}return k(new Array(u),u)}function p(){var u=m(t);u[6]=u[6]&79|64,u[8]=u[8]&191|128;for(var c="",f=0;f<t;++f){var l=u[f];(f===4||f===6||f===8)&&(c+="-"),l<16&&(c+="0"),c+=l.toString(16).toLowerCase()}return c}}function L(t){return t.__=void 0,delete t.__,t}})}(i||(i={})),ze}Jr();var Zr=Object.defineProperty,Yr=(i,r,o)=>r in i?Zr(i,r,{enumerable:!0,configurable:!0,writable:!0,value:o}):i[r]=o,Nt=(i,r,o)=>Yr(i,typeof r!="symbol"?r+"":r,o);let Qr=class{constructor(r,o){Nt(this,"_target"),Nt(this,"_key"),Nt(this,"_oldValue"),Nt(this,"_wasDefined",!1),Nt(this,"_isSwapped",!1),this._target=r,this._key=o,this._oldValue=this._target[this._key]}get isSwapped(){return this._isSwapped}get originalValue(){return this._oldValue}get value(){return this._target[this._key]}get target(){return this._target}restore(){this.isSwapped&&(this._wasDefined?this._target[this._key]=this._oldValue:delete this._target[this._key],this._isSwapped=!1)}swap(r){this.isSwapped||(this._wasDefined=Object.hasOwn(this._target,this._key),this._oldValue=this._target[this._key]),this._target[this._key]=r,this._isSwapped=!0}};const Xr={onlyIfNotExists:!0,isFactory:!1};let We=class{constructor(r,o,s={}){if(ie(this,"_installedInstances",new Map),ie(this,"_path"),ie(this,"_targetValue"),ie(this,"_options"),this._path=r.split("."),this._path.length===0)throw new Error("Path must not be empty");this._targetValue=o,this._options={...Xr,...s}}_getTargetObject(r){let o=r;for(const s of this._path.slice(0,this._path.length-1))o[s]||(o[s]={}),o=o[s];return o}_createSwapper(r){const o=this._getTargetObject(r);return new Qr(o,this._path.at(-1))}install({sdk:r,...o}){if(this._installedInstances.has(r))return;const s=this._createSwapper(r);if(!(s.value&&this._options.onlyIfNotExists)){if(this._options.isFactory&&typeof this._targetValue=="function"){const w=this._targetValue({sdk:r,...o});s.swap(w)}else s.swap(this._targetValue);this._installedInstances.set(r,s)}}uninstall({sdk:r}){const o=this._installedInstances.get(r);o&&(o.restore(),this._installedInstances.delete(r))}};var tn=Object.defineProperty,en=(i,r,o)=>r in i?tn(i,r,{enumerable:!0,configurable:!0,writable:!0,value:o}):i[r]=o,Ht=(i,r,o)=>en(i,typeof r!="symbol"?r+"":r,o);let rn=class{constructor(r,o){Ht(this,"_target"),Ht(this,"_key"),Ht(this,"_oldValue"),Ht(this,"_wasDefined",!1),Ht(this,"_isSwapped",!1),this._target=r,this._key=o,this._oldValue=this._target[this._key]}get isSwapped(){return this._isSwapped}get originalValue(){return this._oldValue}get value(){return this._target[this._key]}get target(){return this._target}restore(){this.isSwapped&&(this._wasDefined?this._target[this._key]=this._oldValue:delete this._target[this._key],this._isSwapped=!1)}swap(r){this.isSwapped||(this._wasDefined=Object.hasOwn(this._target,this._key),this._oldValue=this._target[this._key]),this._target[this._key]=r,this._isSwapped=!0}};function ye(){return"unsafeWindow"in window?window.unsafeWindow:window}var nn=Object.defineProperty,on=(i,r,o)=>r in i?nn(i,r,{enumerable:!0,configurable:!0,writable:!0,value:o}):i[r]=o,Ne=(i,r,o)=>on(i,typeof r!="symbol"?r+"":r,o);function Ut(){return"unsafeWindow"in window?window.unsafeWindow:window}var an=Object.defineProperty,sn=(i,r,o)=>r in i?an(i,r,{enumerable:!0,configurable:!0,writable:!0,value:o}):i[r]=o,Dt=(i,r,o)=>sn(i,typeof r!="symbol"?r+"":r,o);let un=class{constructor(r,o){Dt(this,"_target"),Dt(this,"_key"),Dt(this,"_oldValue"),Dt(this,"_wasDefined",!1),Dt(this,"_isSwapped",!1),this._target=r,this._key=o,this._oldValue=this._target[this._key]}get isSwapped(){return this._isSwapped}get originalValue(){return this._oldValue}get value(){return this._target[this._key]}get target(){return this._target}restore(){this.isSwapped&&(this._wasDefined?this._target[this._key]=this._oldValue:delete this._target[this._key],this._isSwapped=!1)}swap(r){this.isSwapped||(this._wasDefined=Object.hasOwn(this._target,this._key),this._oldValue=this._target[this._key]),this._target[this._key]=r,this._isSwapped=!0}},cn=class{constructor(r,o,s){Dt(this,"_enabled",!1),Dt(this,"_fnSwapper"),Dt(this,"_interceptionFunction"),Dt(this,"_middlewares",[]),this._fnSwapper=new un(r,o),this._interceptionFunction=s}get enabled(){return this._fnSwapper.isSwapped&&this._enabled}disable(){this._enabled=!1,this.enabled}restore(){this._fnSwapper.restore()}enable(){this._enabled=!0,this._fnSwapper.isSwapped||this.swapToInterceptor()}swapToInterceptor(){const r=this;this._fnSwapper.swap(function(...o){if(!r._enabled)return r.callOriginalInvocator(...o);const s=r.runMiddlewares(o);if(s){if("output"in s)return s.output;"input"in s&&(o=s.input)}return r._interceptionFunction.call(this,r.getOriginalInvocator(this),...o)})}getOriginalInvocator(r){return this._fnSwapper.originalValue.bind(r??this._fnSwapper.target)}callOriginalInvocator(...r){return this.getOriginalInvocator()(...r)}runMiddlewares(r){for(const o of this._middlewares){const s=o(...r);if(s){if("output"in s)return s;"input"in s&&(r=s.input)}}return{input:r}}registerMiddleware(r){this._middlewares.push(r)}},fn=class{constructor(r){Ne(this,"_fetchInterceptor"),Ne(this,"_interceptionFilters",new Set),this._fetchInterceptor=new cn(r,"fetch",(o,s,w)=>{for(const g of this._interceptionFilters)if(g.shouldIntercept(s,w))return this.shouldKeepFilter(g,s,w)||this.removeInterceptionFilter(g),g.intercept(s,w);return o(s,w)})}enable(){this._fetchInterceptor.enable()}disable(){this._fetchInterceptor.disable()}addInterceptionFilter(r){this.enable(),this._interceptionFilters.add(r)}removeInterceptionFilter(r){this._interceptionFilters.delete(r)}shouldKeepFilter(r,o,s){return typeof r.shouldKeep=="function"?r.shouldKeep(o,s):typeof r.shouldKeep=="boolean"?r.shouldKeep:!1}};function ln(i){return i=i instanceof URL?i:new URL(i,Ut().location.href),r=>typeof r=="string"?new URL(r,Ut().location.href).pathname===i.pathname:r instanceof URL?r.pathname===i.pathname:new URL(r.url,Ut().location.href).pathname===new URL(i,Ut().location.href).pathname}function hn(i,r,o){const s=new Response(r,o),w=new URL(i,location.toString());return Object.defineProperty(s,"url",{value:w}),s}function dn(i,r){const o=JSON.stringify(r),s=new Headers({"Content-Type":"application/json"});return hn(i,o,{headers:s})}const pn=new fn(Ut());function yn(){const i=ye(),r=new rn(i.W.controller.descartesClient,"createAbortController");r.swap(()=>(r.restore(),new AbortController))}function wn(i){const r=ye();return yn(),r.W.controller.descartesClient.getFeatures([0,0,0,0],{[i]:!0},{})}async function _n(i,r){const o=ye().W.Config.paths.features;pn.addInterceptionFilter({shouldIntercept:ln(o),intercept(){return Promise.resolve(dn(o,{[i]:{objects:[r]}}))}});const{[i]:s}=await wn(i),[w]=s.objects;return w.constructor}function vn(i,r,o={}){const s={type:"Feature"};return(o.id===0||o.id)&&(s.id=o.id),o.bbox&&(s.bbox=o.bbox),s.properties={},s.geometry=i,s}function gn(i,r,o={}){if(!i)throw new Error("coordinates is required");if(!Array.isArray(i))throw new Error("coordinates must be an Array");if(i.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!He(i[0])||!He(i[1]))throw new Error("coordinates must contain numbers");return vn({type:"Point",coordinates:i},r,o)}function He(i){return!isNaN(i)&&i!==null&&!Array.isArray(i)}function Lt(){return"unsafeWindow"in window?window.unsafeWindow:window}function bn(i){const r=Lt().require("Waze/Action/CreateObject");return new r(i)}function mn(i){Lt().W.model.actionManager.add(bn(i))}function kn(i){return i.toISOString().slice(0,16).replace("T"," ")}function On(i){return Lt().W.model.mapComments.getObjectById(i)}function Sn(i,r){const o=Lt().require("Waze/Action/UpdateObject");return new o(i,r)}function Mn(i,r){Lt().W.model.actionManager.add(Sn(i,r))}let we;function En(){if(!we)throw new Error("MapComment not initialized. Make sure to await the enhancedSDK function before using it.")}const jn=[{async install(){we=await _n("mapComments",{geometry:gn([0,0]).geometry})}},new We("DataModel.MapComments.addMapComment",i=>{En();const r=new we({geoJSONGeometry:i.geometry,subject:i.subject,body:i.body,lockRank:i.lockRank,endDate:i.endDate?kn(i.endDate):null});return mn(r),r.getID()}),new We("DataModel.MapComments.updateMapComment",({sdkInstance:i})=>r=>{const o=On(r.mapCommentId);if(!o)throw new i.Errors.DataModelNotFoundError("mapComment",r.mapCommentId);const s={};r.geometry&&(s.geoJSONGeometry=r.geometry),r.subject&&(s.subject=r.subject),r.body&&(s.body=r.body),r.lockRank&&(s.lockRank=r.lockRank),Mn(o,s)},{isFactory:!0})];var Tn=Object.defineProperty,In=(i,r,o)=>r in i?Tn(i,r,{enumerable:!0,configurable:!0,writable:!0,value:o}):i[r]=o,oe=(i,r,o)=>In(i,typeof r!="symbol"?r+"":r,o),Ue=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Le={};/*! *****************************************************************************
  Copyright (C) Microsoft. All rights reserved.
  Licensed under the Apache License, Version 2.0 (the "License"); you may not use
  this file except in compliance with the License. You may obtain a copy of the
  License at http://www.apache.org/licenses/LICENSE-2.0

  THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
  WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
  MERCHANTABLITY OR NON-INFRINGEMENT.

  See the Apache Version 2.0 License for specific language governing permissions
  and limitations under the License.
  ***************************************************************************** */var qe;function Pn(){if(qe)return Le;qe=1;var i;return function(r){(function(o){var s=typeof globalThis=="object"?globalThis:typeof Ue=="object"?Ue:typeof self=="object"?self:typeof this=="object"?this:j(),w=g(r);typeof s.Reflect<"u"&&(w=g(s.Reflect,w)),o(w,s),typeof s.Reflect>"u"&&(s.Reflect=r);function g($,I){return function(E,R){Object.defineProperty($,E,{configurable:!0,writable:!0,value:R}),I&&I(E,R)}}function T(){try{return Function("return this;")()}catch{}}function S(){try{return(0,eval)("(function() { return this; })()")}catch{}}function j(){return T()||S()}})(function(o,s){var w=Object.prototype.hasOwnProperty,g=typeof Symbol=="function",T=g&&typeof Symbol.toPrimitive<"u"?Symbol.toPrimitive:"@@toPrimitive",S=g&&typeof Symbol.iterator<"u"?Symbol.iterator:"@@iterator",j=typeof Object.create=="function",$={__proto__:[]}instanceof Array,I=!j&&!$,E={create:j?function(){return L(Object.create(null))}:$?function(){return L({__proto__:null})}:function(){return L({})},has:I?function(t,e){return w.call(t,e)}:function(t,e){return e in t},get:I?function(t,e){return w.call(t,e)?t[e]:void 0}:function(t,e){return t[e]}},R=Object.getPrototypeOf(Function),A=typeof Map=="function"&&typeof Map.prototype.entries=="function"?Map:It(),W=typeof Set=="function"&&typeof Set.prototype.entries=="function"?Set:Pt(),K=typeof WeakMap=="function"?WeakMap:xt(),P=g?Symbol.for("@reflect-metadata:registry"):void 0,V=Et(),J=jt(V);function wt(t,e,n,a){if(d(n)){if(!at(t))throw new TypeError;if(!st(e))throw new TypeError;return vt(t,e)}else{if(!at(t))throw new TypeError;if(!b(e))throw new TypeError;if(!b(a)&&!d(a)&&!x(a))throw new TypeError;return x(a)&&(a=void 0),n=M(n),gt(t,e,n,a)}}o("decorate",wt);function F(t,e){function n(a,h){if(!b(a))throw new TypeError;if(!d(h)&&!St(h))throw new TypeError;et(t,e,a,h)}return n}o("metadata",F);function C(t,e,n,a){if(!b(n))throw new TypeError;return d(a)||(a=M(a)),et(t,e,n,a)}o("defineMetadata",C);function q(t,e,n){if(!b(e))throw new TypeError;return d(n)||(n=M(n)),Q(t,e,n)}o("hasMetadata",q);function G(t,e,n){if(!b(e))throw new TypeError;return d(n)||(n=M(n)),N(t,e,n)}o("hasOwnMetadata",G);function yt(t,e,n){if(!b(e))throw new TypeError;return d(n)||(n=M(n)),X(t,e,n)}o("getMetadata",yt);function Z(t,e,n){if(!b(e))throw new TypeError;return d(n)||(n=M(n)),tt(t,e,n)}o("getOwnMetadata",Z);function Y(t,e){if(!b(t))throw new TypeError;return d(e)||(e=M(e)),rt(t,e)}o("getMetadataKeys",Y);function pt(t,e){if(!b(t))throw new TypeError;return d(e)||(e=M(e)),nt(t,e)}o("getOwnMetadataKeys",pt);function _t(t,e,n){if(!b(e))throw new TypeError;if(d(n)||(n=M(n)),!b(e))throw new TypeError;d(n)||(n=M(n));var a=D(e,n,!1);return d(a)?!1:a.OrdinaryDeleteMetadata(t,e,n)}o("deleteMetadata",_t);function vt(t,e){for(var n=t.length-1;n>=0;--n){var a=t[n],h=a(e);if(!d(h)&&!x(h)){if(!st(h))throw new TypeError;e=h}}return e}function gt(t,e,n,a){for(var h=t.length-1;h>=0;--h){var k=t[h],m=k(e,n,a);if(!d(m)&&!x(m)){if(!b(m))throw new TypeError;a=m}}return a}function Q(t,e,n){var a=N(t,e,n);if(a)return!0;var h=U(e);return x(h)?!1:Q(t,h,n)}function N(t,e,n){var a=D(e,n,!1);return d(a)?!1:ot(a.OrdinaryHasOwnMetadata(t,e,n))}function X(t,e,n){var a=N(t,e,n);if(a)return tt(t,e,n);var h=U(e);if(!x(h))return X(t,h,n)}function tt(t,e,n){var a=D(e,n,!1);if(!d(a))return a.OrdinaryGetOwnMetadata(t,e,n)}function et(t,e,n,a){var h=D(n,a,!0);h.OrdinaryDefineOwnMetadata(t,e,n,a)}function rt(t,e){var n=nt(t,e),a=U(t);if(a===null)return n;var h=rt(a,e);if(h.length<=0)return n;if(n.length<=0)return h;for(var k=new W,m=[],p=0,u=n;p<u.length;p++){var c=u[p],f=k.has(c);f||(k.add(c),m.push(c))}for(var l=0,y=h;l<y.length;l++){var c=y[l],f=k.has(c);f||(k.add(c),m.push(c))}return m}function nt(t,e){var n=D(t,e,!1);return n?n.OrdinaryOwnMetadataKeys(t,e):[]}function it(t){if(t===null)return 1;switch(typeof t){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return t===null?1:6;default:return 6}}function d(t){return t===void 0}function x(t){return t===null}function bt(t){return typeof t=="symbol"}function b(t){return typeof t=="object"?t!==null:typeof t=="function"}function mt(t,e){switch(it(t)){case 0:return t;case 1:return t;case 2:return t;case 3:return t;case 4:return t;case 5:return t}var n="string",a=ut(t,T);if(a!==void 0){var h=a.call(t,n);if(b(h))throw new TypeError;return h}return kt(t)}function kt(t,e){var n,a;{var h=t.toString;if(z(h)){var a=h.call(t);if(!b(a))return a}var n=t.valueOf;if(z(n)){var a=n.call(t);if(!b(a))return a}}throw new TypeError}function ot(t){return!!t}function Ot(t){return""+t}function M(t){var e=mt(t);return bt(e)?e:Ot(e)}function at(t){return Array.isArray?Array.isArray(t):t instanceof Object?t instanceof Array:Object.prototype.toString.call(t)==="[object Array]"}function z(t){return typeof t=="function"}function st(t){return typeof t=="function"}function St(t){switch(it(t)){case 3:return!0;case 4:return!0;default:return!1}}function H(t,e){return t===e||t!==t&&e!==e}function ut(t,e){var n=t[e];if(n!=null){if(!z(n))throw new TypeError;return n}}function ct(t){var e=ut(t,S);if(!z(e))throw new TypeError;var n=e.call(t);if(!b(n))throw new TypeError;return n}function ft(t){return t.value}function lt(t){var e=t.next();return e.done?!1:e}function ht(t){var e=t.return;e&&e.call(t)}function U(t){var e=Object.getPrototypeOf(t);if(typeof t!="function"||t===R||e!==R)return e;var n=t.prototype,a=n&&Object.getPrototypeOf(n);if(a==null||a===Object.prototype)return e;var h=a.constructor;return typeof h!="function"||h===t?e:h}function Mt(){var t;!d(P)&&typeof s.Reflect<"u"&&!(P in s.Reflect)&&typeof s.Reflect.defineMetadata=="function"&&(t=Tt(s.Reflect));var e,n,a,h=new K,k={registerProvider:m,getProvider:u,setProvider:f};return k;function m(l){if(!Object.isExtensible(k))throw new Error("Cannot add provider to a frozen registry.");switch(!0){case t===l:break;case d(e):e=l;break;case e===l:break;case d(n):n=l;break;case n===l:break;default:a===void 0&&(a=new W),a.add(l);break}}function p(l,y){if(!d(e)){if(e.isProviderFor(l,y))return e;if(!d(n)){if(n.isProviderFor(l,y))return e;if(!d(a))for(var _=ct(a);;){var v=lt(_);if(!v)return;var O=ft(v);if(O.isProviderFor(l,y))return ht(_),O}}}if(!d(t)&&t.isProviderFor(l,y))return t}function u(l,y){var _=h.get(l),v;return d(_)||(v=_.get(y)),d(v)&&(v=p(l,y),d(v)||(d(_)&&(_=new A,h.set(l,_)),_.set(y,v))),v}function c(l){if(d(l))throw new TypeError;return e===l||n===l||!d(a)&&a.has(l)}function f(l,y,_){if(!c(_))throw new Error("Metadata provider not registered.");var v=u(l,y);if(v!==_){if(!d(v))return!1;var O=h.get(l);d(O)&&(O=new A,h.set(l,O)),O.set(y,_)}return!0}}function Et(){var t;return!d(P)&&b(s.Reflect)&&Object.isExtensible(s.Reflect)&&(t=s.Reflect[P]),d(t)&&(t=Mt()),!d(P)&&b(s.Reflect)&&Object.isExtensible(s.Reflect)&&Object.defineProperty(s.Reflect,P,{enumerable:!1,configurable:!1,writable:!1,value:t}),t}function jt(t){var e=new K,n={isProviderFor:function(c,f){var l=e.get(c);return d(l)?!1:l.has(f)},OrdinaryDefineOwnMetadata:m,OrdinaryHasOwnMetadata:h,OrdinaryGetOwnMetadata:k,OrdinaryOwnMetadataKeys:p,OrdinaryDeleteMetadata:u};return V.registerProvider(n),n;function a(c,f,l){var y=e.get(c),_=!1;if(d(y)){if(!l)return;y=new A,e.set(c,y),_=!0}var v=y.get(f);if(d(v)){if(!l)return;if(v=new A,y.set(f,v),!t.setProvider(c,f,n))throw y.delete(f),_&&e.delete(c),new Error("Wrong provider for target.")}return v}function h(c,f,l){var y=a(f,l,!1);return d(y)?!1:ot(y.has(c))}function k(c,f,l){var y=a(f,l,!1);if(!d(y))return y.get(c)}function m(c,f,l,y){var _=a(l,y,!0);_.set(c,f)}function p(c,f){var l=[],y=a(c,f,!1);if(d(y))return l;for(var _=y.keys(),v=ct(_),O=0;;){var dt=lt(v);if(!dt)return l.length=O,l;var Rt=ft(dt);try{l[O]=Rt}catch(At){try{ht(v)}finally{throw At}}O++}}function u(c,f,l){var y=a(f,l,!1);if(d(y)||!y.delete(c))return!1;if(y.size===0){var _=e.get(f);d(_)||(_.delete(l),_.size===0&&e.delete(_))}return!0}}function Tt(t){var e=t.defineMetadata,n=t.hasOwnMetadata,a=t.getOwnMetadata,h=t.getOwnMetadataKeys,k=t.deleteMetadata,m=new K,p={isProviderFor:function(u,c){var f=m.get(u);return!d(f)&&f.has(c)?!0:h(u,c).length?(d(f)&&(f=new W,m.set(u,f)),f.add(c),!0):!1},OrdinaryDefineOwnMetadata:e,OrdinaryHasOwnMetadata:n,OrdinaryGetOwnMetadata:a,OrdinaryOwnMetadataKeys:h,OrdinaryDeleteMetadata:k};return p}function D(t,e,n){var a=V.getProvider(t,e);if(!d(a))return a;if(n){if(V.setProvider(t,e,J))return J;throw new Error("Illegal state.")}}function It(){var t={},e=[],n=function(){function p(u,c,f){this._index=0,this._keys=u,this._values=c,this._selector=f}return p.prototype["@@iterator"]=function(){return this},p.prototype[S]=function(){return this},p.prototype.next=function(){var u=this._index;if(u>=0&&u<this._keys.length){var c=this._selector(this._keys[u],this._values[u]);return u+1>=this._keys.length?(this._index=-1,this._keys=e,this._values=e):this._index++,{value:c,done:!1}}return{value:void 0,done:!0}},p.prototype.throw=function(u){throw this._index>=0&&(this._index=-1,this._keys=e,this._values=e),u},p.prototype.return=function(u){return this._index>=0&&(this._index=-1,this._keys=e,this._values=e),{value:u,done:!0}},p}(),a=function(){function p(){this._keys=[],this._values=[],this._cacheKey=t,this._cacheIndex=-2}return Object.defineProperty(p.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),p.prototype.has=function(u){return this._find(u,!1)>=0},p.prototype.get=function(u){var c=this._find(u,!1);return c>=0?this._values[c]:void 0},p.prototype.set=function(u,c){var f=this._find(u,!0);return this._values[f]=c,this},p.prototype.delete=function(u){var c=this._find(u,!1);if(c>=0){for(var f=this._keys.length,l=c+1;l<f;l++)this._keys[l-1]=this._keys[l],this._values[l-1]=this._values[l];return this._keys.length--,this._values.length--,H(u,this._cacheKey)&&(this._cacheKey=t,this._cacheIndex=-2),!0}return!1},p.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=t,this._cacheIndex=-2},p.prototype.keys=function(){return new n(this._keys,this._values,h)},p.prototype.values=function(){return new n(this._keys,this._values,k)},p.prototype.entries=function(){return new n(this._keys,this._values,m)},p.prototype["@@iterator"]=function(){return this.entries()},p.prototype[S]=function(){return this.entries()},p.prototype._find=function(u,c){if(!H(this._cacheKey,u)){this._cacheIndex=-1;for(var f=0;f<this._keys.length;f++)if(H(this._keys[f],u)){this._cacheIndex=f;break}}return this._cacheIndex<0&&c&&(this._cacheIndex=this._keys.length,this._keys.push(u),this._values.push(void 0)),this._cacheIndex},p}();return a;function h(p,u){return p}function k(p,u){return u}function m(p,u){return[p,u]}}function Pt(){var t=function(){function e(){this._map=new A}return Object.defineProperty(e.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),e.prototype.has=function(n){return this._map.has(n)},e.prototype.add=function(n){return this._map.set(n,n),this},e.prototype.delete=function(n){return this._map.delete(n)},e.prototype.clear=function(){this._map.clear()},e.prototype.keys=function(){return this._map.keys()},e.prototype.values=function(){return this._map.keys()},e.prototype.entries=function(){return this._map.entries()},e.prototype["@@iterator"]=function(){return this.keys()},e.prototype[S]=function(){return this.keys()},e}();return t}function xt(){var t=16,e=E.create(),n=a();return function(){function u(){this._key=a()}return u.prototype.has=function(c){var f=h(c,!1);return f!==void 0?E.has(f,this._key):!1},u.prototype.get=function(c){var f=h(c,!1);return f!==void 0?E.get(f,this._key):void 0},u.prototype.set=function(c,f){var l=h(c,!0);return l[this._key]=f,this},u.prototype.delete=function(c){var f=h(c,!1);return f!==void 0?delete f[this._key]:!1},u.prototype.clear=function(){this._key=a()},u}();function a(){var u;do u="@@WeakMap@@"+p();while(E.has(e,u));return e[u]=!0,u}function h(u,c){if(!w.call(u,n)){if(!c)return;Object.defineProperty(u,n,{value:E.create()})}return u[n]}function k(u,c){for(var f=0;f<c;++f)u[f]=Math.random()*255|0;return u}function m(u){if(typeof Uint8Array=="function"){var c=new Uint8Array(u);return typeof crypto<"u"?crypto.getRandomValues(c):typeof msCrypto<"u"?msCrypto.getRandomValues(c):k(c,u),c}return k(new Array(u),u)}function p(){var u=m(t);u[6]=u[6]&79|64,u[8]=u[8]&191|128;for(var c="",f=0;f<t;++f){var l=u[f];(f===4||f===6||f===8)&&(c+="-"),l<16&&(c+="0"),c+=l.toString(16).toLowerCase()}return c}}function L(t){return t.__=void 0,delete t.__,t}})}(i||(i={})),Le}Pn();var xn=Object.defineProperty,Rn=(i,r,o)=>r in i?xn(i,r,{enumerable:!0,configurable:!0,writable:!0,value:o}):i[r]=o,qt=(i,r,o)=>Rn(i,typeof r!="symbol"?r+"":r,o);let An=class{constructor(r,o){qt(this,"_target"),qt(this,"_key"),qt(this,"_oldValue"),qt(this,"_wasDefined",!1),qt(this,"_isSwapped",!1),this._target=r,this._key=o,this._oldValue=this._target[this._key]}get isSwapped(){return this._isSwapped}get originalValue(){return this._oldValue}get value(){return this._target[this._key]}get target(){return this._target}restore(){this.isSwapped&&(this._wasDefined?this._target[this._key]=this._oldValue:delete this._target[this._key],this._isSwapped=!1)}swap(r){this.isSwapped||(this._wasDefined=Object.hasOwn(this._target,this._key),this._oldValue=this._target[this._key]),this._target[this._key]=r,this._isSwapped=!0}};const $n={onlyIfNotExists:!0,isFactory:!1};class _e{constructor(r,o,s={}){if(oe(this,"_installedInstances",new Map),oe(this,"_path"),oe(this,"_targetValue"),oe(this,"_options"),this._path=r.split("."),this._path.length===0)throw new Error("Path must not be empty");this._targetValue=o,this._options={...$n,...s}}_getTargetObject(r){let o=r;for(const s of this._path.slice(0,this._path.length-1))o[s]||(o[s]={}),o=o[s];return o}_createSwapper(r){const o=this._getTargetObject(r);return new An(o,this._path.at(-1))}install({sdk:r,...o}){if(this._installedInstances.has(r))return;const s=this._createSwapper(r);if(!(s.value&&this._options.onlyIfNotExists)){if(this._options.isFactory&&typeof this._targetValue=="function"){const w=this._targetValue({sdk:r,...o});s.swap(w)}else s.swap(this._targetValue);this._installedInstances.set(r,s)}}uninstall({sdk:r}){const o=this._installedInstances.get(r);o&&(o.restore(),this._installedInstances.delete(r))}}var Dn=Object.defineProperty,Fn=(i,r,o)=>r in i?Dn(i,r,{enumerable:!0,configurable:!0,writable:!0,value:o}):i[r]=o,Gt=(i,r,o)=>Fn(i,typeof r!="symbol"?r+"":r,o);let Ge=class{constructor(i,r){Gt(this,"_target"),Gt(this,"_key"),Gt(this,"_oldValue"),Gt(this,"_wasDefined",!1),Gt(this,"_isSwapped",!1),this._target=i,this._key=r,this._oldValue=this._target[this._key]}get isSwapped(){return this._isSwapped}get originalValue(){return this._oldValue}get value(){return this._target[this._key]}get target(){return this._target}restore(){this.isSwapped&&(this._wasDefined?this._target[this._key]=this._oldValue:delete this._target[this._key],this._isSwapped=!1)}swap(i){this.isSwapped||(this._wasDefined=Object.hasOwn(this._target,this._key),this._oldValue=this._target[this._key]),this._target[this._key]=i,this._isSwapped=!0}};function ve(){return"unsafeWindow"in window?window.unsafeWindow:window}async function Vn(i){const r=[],o=new Ge(ve().W.model.actionManager,"add");o.swap(s=>{r.push(s)});try{await i()}finally{o.restore()}return r}function Cn(i){return i.memoizedProps||{}}function zn(i){return typeof i=="object"&&i!==null&&"memoizedState"in i&&Array.isArray(i.memoizedState)&&i.memoizedState.length===2&&"queue"in i&&i.queue===null&&Array.isArray(i.memoizedState[1])}function Kn(i){return typeof i=="object"&&i!==null&&"memoizedState"in i&&typeof i.memoizedState=="object"&&i.memoizedState!==null&&"current"in i.memoizedState&&"queue"in i&&i.queue===null}function Wn(i){return typeof i=="object"&&i!==null&&"memoizedState"in i&&"queue"in i&&typeof i.queue=="object"&&i.queue!==null&&"dispatch"in i.queue&&typeof i.queue.dispatch=="function"}function Nn(i){return Wn(i)?{type:"useState",value:i.memoizedState,dispatch:i.queue.dispatch}:zn(i)?{type:"useMemo",value:i.memoizedState[0],dependencies:i.memoizedState[1]}:Kn(i)?{type:"useRef",current:i.memoizedState}:null}function Hn(i,r){const o=[];let s=i.memoizedState;for(;s;){const w=Nn(s);w&&o.push(w),s=s.next}return o}function Un(i,r,o=1/0){let s=i,w=0;for(;s&&w<o;){const g=s.memoizedState?Hn(s):[],T=Cn(s),S={fiber:s,hooks:{all:g,useState:g.filter(j=>j.type==="useState"),useMemo:g.filter(j=>j.type==="useMemo"),useRef:g.filter(j=>j.type==="useRef")},props:T};if(r(S))return S;s=s.return,w++}return null}const Ln="__reactFiber$";function qn(i){const r=Object.keys(i).find(s=>s.startsWith(Ln));if(!r)throw new Error(`No fiber key found for element: ${i}`);const o=i[r];if(!o)throw new Error(`No fiber found for element: ${i}`);return o}const Gn=i=>new Promise(r=>{const o=ve(),s=new Ge(o.W.map.olMap,"addControl");s.swap(w=>{i==null||i(w),r(w),s.restore()})});function Bn(i){const r=ve(),o=r.W.userscripts.toOLGeometry(i);return new r.OpenLayers.Feature.Vector(o)}async function Jn(i,r){const o=Un(qn(i),g=>"onClick"in g.props&&typeof g.props.onClick=="function");if(!o)throw new Error("No fiber found with draw initiator");const{onClick:s}=o.props;//! OpenLayers dependent code below - implementation might change over time
const w=Gn(g=>{g.activate=()=>{}});s(new Event("click")),(await w).events.triggerEvent("featureadded",{feature:Bn(r)})}var Zn=Object.defineProperty,Yn=(i,r,o)=>r in i?Zn(i,r,{enumerable:!0,configurable:!0,writable:!0,value:o}):i[r]=o,Be=(i,r,o)=>Yn(i,typeof r!="symbol"?r+"":r,o);function Qn(){return"unsafeWindow"in window?window.unsafeWindow:window}var Xn=Object.defineProperty,ti=(i,r,o)=>r in i?Xn(i,r,{enumerable:!0,configurable:!0,writable:!0,value:o}):i[r]=o,Ft=(i,r,o)=>ti(i,typeof r!="symbol"?r+"":r,o);let ei=class{constructor(r,o){Ft(this,"_target"),Ft(this,"_key"),Ft(this,"_oldValue"),Ft(this,"_wasDefined",!1),Ft(this,"_isSwapped",!1),this._target=r,this._key=o,this._oldValue=this._target[this._key]}get isSwapped(){return this._isSwapped}get originalValue(){return this._oldValue}get value(){return this._target[this._key]}get target(){return this._target}restore(){this.isSwapped&&(this._wasDefined?this._target[this._key]=this._oldValue:delete this._target[this._key],this._isSwapped=!1)}swap(r){this.isSwapped||(this._wasDefined=Object.hasOwn(this._target,this._key),this._oldValue=this._target[this._key]),this._target[this._key]=r,this._isSwapped=!0}},ri=class{constructor(r,o,s){Ft(this,"_enabled",!1),Ft(this,"_fnSwapper"),Ft(this,"_interceptionFunction"),Ft(this,"_middlewares",[]),this._fnSwapper=new ei(r,o),this._interceptionFunction=s}get enabled(){return this._fnSwapper.isSwapped&&this._enabled}disable(){this._enabled=!1,this.enabled}restore(){this._fnSwapper.restore()}enable(){this._enabled=!0,this._fnSwapper.isSwapped||this.swapToInterceptor()}swapToInterceptor(){const r=this;this._fnSwapper.swap(function(...o){if(!r._enabled)return r.callOriginalInvocator(...o);const s=r.runMiddlewares(o);if(s){if("output"in s)return s.output;"input"in s&&(o=s.input)}return r._interceptionFunction.call(this,r.getOriginalInvocator(this),...o)})}getOriginalInvocator(r){return this._fnSwapper.originalValue.bind(r??this._fnSwapper.target)}callOriginalInvocator(...r){return this.getOriginalInvocator()(...r)}runMiddlewares(r){for(const o of this._middlewares){const s=o(...r);if(s){if("output"in s)return s;"input"in s&&(r=s.input)}}return{input:r}}registerMiddleware(r){this._middlewares.push(r)}},ni=class{constructor(r){Be(this,"_fetchInterceptor"),Be(this,"_interceptionFilters",new Set),this._fetchInterceptor=new ri(r,"fetch",(o,s,w)=>{for(const g of this._interceptionFilters)if(g.shouldIntercept(s,w))return this.shouldKeepFilter(g,s,w)||this.removeInterceptionFilter(g),g.intercept(s,w);return o(s,w)})}enable(){this._fetchInterceptor.enable()}disable(){this._fetchInterceptor.disable()}addInterceptionFilter(r){this.enable(),this._interceptionFilters.add(r)}removeInterceptionFilter(r){this._interceptionFilters.delete(r)}shouldKeepFilter(r,o,s){return typeof r.shouldKeep=="function"?r.shouldKeep(o,s):typeof r.shouldKeep=="boolean"?r.shouldKeep:!1}};new ni(Qn());function ii(i,r,o={}){const s={type:"Feature"};return(o.id===0||o.id)&&(s.id=o.id),o.bbox&&(s.bbox=o.bbox),s.properties={},s.geometry=i,s}function oi(i,r,o={}){for(const s of i){if(s.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");if(s[s.length-1].length!==s[0].length)throw new Error("First and last Position are not equivalent.");for(let w=0;w<s[s.length-1].length;w++)if(s[s.length-1][w]!==s[0][w])throw new Error("First and last Position are not equivalent.")}return ii({type:"Polygon",coordinates:i},r,o)}function ae(){return"unsafeWindow"in window?window.unsafeWindow:window}function ai(i,r,o){const s=new i(o),w=new r(s);return ae().W.model.actionManager.add(w),s}function Je(i){return ae().W.model.permanentHazards.getObjectById(i)}function si(i,r){const o=ae().require("Waze/Action/UpdateObject");return new o(i,r)}function ui(i,r){ae().W.model.actionManager.add(si(i,r))}function ci(i){return Object.fromEntries(Object.entries(i).filter(([,r])=>r!==void 0))}let ge,be;const fi=[{async install(){const i=document.querySelector("#drawer wz-menu > wz-menu-sub-menu:nth-child(3) > wz-menu-item:nth-of-type(2)");if(!i||!(i instanceof HTMLElement))throw new Error("Unable to find school zone drawing menu item");const[r]=await Vn(async()=>{await Jn(i,oi([[[0,0],[0,1],[1,1],[0,0]]]).geometry)});if(r.actionName!=="ADD_PERMANENT_HAZARD")throw new Error("Unexpected action discovered when tried to resolve AddPermanentHazard action: "+r.actionName);const o=r.object;if(!o)throw new Error("Unexpected state: Added object does not exist");if(o.type!=="permanentHazard")throw new Error("Unexpected state: Expected the added object to be a PermanentHazard instead of "+r.type);ge=r.constructor,be=o.constructor}},new _e("DataModel.PermanentHazards.addSchoolZone",i=>{if(!be||!ge)throw new Error("PermanentHazard or AddPermanentHazard are not initialized. Make sure to await the enhancedSDK function before using it.");return ai(be,ge,{type:9,geoJSONGeometry:i.geometry,name:i.name,speedLimit:i.speedLimit,excludedRoadTypes:i.excludedRoadTypes}).getID()}),new _e("DataModel.PermanentHazards.updateSchoolZone",({sdkInstance:i})=>r=>{const o=Je(r.schoolZoneId);if(!o||o.getAttribute("type")!==9)throw new i.Errors.DataModelNotFoundError("permanentHazard.SchoolZone",r.schoolZoneId);ui(o,ci({geoJSONGeometry:r.geometry,name:r.name,speedLimit:r.speedLimit,excludedRoadTypes:r.excludedRoadTypes}))},{isFactory:!0}),new _e("DataModel.PermanentHazards.getSchoolZoneById",()=>i=>{const r=Je(i.schoolZoneId);return!r||r.getAttribute("type")!==9?null:r},{isFactory:!0})];var li=Object.defineProperty,hi=(i,r,o)=>r in i?li(i,r,{enumerable:!0,configurable:!0,writable:!0,value:o}):i[r]=o,se=(i,r,o)=>hi(i,typeof r!="symbol"?r+"":r,o),Ze=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Ye={};/*! *****************************************************************************
  Copyright (C) Microsoft. All rights reserved.
  Licensed under the Apache License, Version 2.0 (the "License"); you may not use
  this file except in compliance with the License. You may obtain a copy of the
  License at http://www.apache.org/licenses/LICENSE-2.0

  THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
  WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
  MERCHANTABLITY OR NON-INFRINGEMENT.

  See the Apache Version 2.0 License for specific language governing permissions
  and limitations under the License.
  ***************************************************************************** */var Qe;function di(){if(Qe)return Ye;Qe=1;var i;return function(r){(function(o){var s=typeof globalThis=="object"?globalThis:typeof Ze=="object"?Ze:typeof self=="object"?self:typeof this=="object"?this:j(),w=g(r);typeof s.Reflect<"u"&&(w=g(s.Reflect,w)),o(w,s),typeof s.Reflect>"u"&&(s.Reflect=r);function g($,I){return function(E,R){Object.defineProperty($,E,{configurable:!0,writable:!0,value:R}),I&&I(E,R)}}function T(){try{return Function("return this;")()}catch{}}function S(){try{return(0,eval)("(function() { return this; })()")}catch{}}function j(){return T()||S()}})(function(o,s){var w=Object.prototype.hasOwnProperty,g=typeof Symbol=="function",T=g&&typeof Symbol.toPrimitive<"u"?Symbol.toPrimitive:"@@toPrimitive",S=g&&typeof Symbol.iterator<"u"?Symbol.iterator:"@@iterator",j=typeof Object.create=="function",$={__proto__:[]}instanceof Array,I=!j&&!$,E={create:j?function(){return L(Object.create(null))}:$?function(){return L({__proto__:null})}:function(){return L({})},has:I?function(t,e){return w.call(t,e)}:function(t,e){return e in t},get:I?function(t,e){return w.call(t,e)?t[e]:void 0}:function(t,e){return t[e]}},R=Object.getPrototypeOf(Function),A=typeof Map=="function"&&typeof Map.prototype.entries=="function"?Map:It(),W=typeof Set=="function"&&typeof Set.prototype.entries=="function"?Set:Pt(),K=typeof WeakMap=="function"?WeakMap:xt(),P=g?Symbol.for("@reflect-metadata:registry"):void 0,V=Et(),J=jt(V);function wt(t,e,n,a){if(d(n)){if(!at(t))throw new TypeError;if(!st(e))throw new TypeError;return vt(t,e)}else{if(!at(t))throw new TypeError;if(!b(e))throw new TypeError;if(!b(a)&&!d(a)&&!x(a))throw new TypeError;return x(a)&&(a=void 0),n=M(n),gt(t,e,n,a)}}o("decorate",wt);function F(t,e){function n(a,h){if(!b(a))throw new TypeError;if(!d(h)&&!St(h))throw new TypeError;et(t,e,a,h)}return n}o("metadata",F);function C(t,e,n,a){if(!b(n))throw new TypeError;return d(a)||(a=M(a)),et(t,e,n,a)}o("defineMetadata",C);function q(t,e,n){if(!b(e))throw new TypeError;return d(n)||(n=M(n)),Q(t,e,n)}o("hasMetadata",q);function G(t,e,n){if(!b(e))throw new TypeError;return d(n)||(n=M(n)),N(t,e,n)}o("hasOwnMetadata",G);function yt(t,e,n){if(!b(e))throw new TypeError;return d(n)||(n=M(n)),X(t,e,n)}o("getMetadata",yt);function Z(t,e,n){if(!b(e))throw new TypeError;return d(n)||(n=M(n)),tt(t,e,n)}o("getOwnMetadata",Z);function Y(t,e){if(!b(t))throw new TypeError;return d(e)||(e=M(e)),rt(t,e)}o("getMetadataKeys",Y);function pt(t,e){if(!b(t))throw new TypeError;return d(e)||(e=M(e)),nt(t,e)}o("getOwnMetadataKeys",pt);function _t(t,e,n){if(!b(e))throw new TypeError;if(d(n)||(n=M(n)),!b(e))throw new TypeError;d(n)||(n=M(n));var a=D(e,n,!1);return d(a)?!1:a.OrdinaryDeleteMetadata(t,e,n)}o("deleteMetadata",_t);function vt(t,e){for(var n=t.length-1;n>=0;--n){var a=t[n],h=a(e);if(!d(h)&&!x(h)){if(!st(h))throw new TypeError;e=h}}return e}function gt(t,e,n,a){for(var h=t.length-1;h>=0;--h){var k=t[h],m=k(e,n,a);if(!d(m)&&!x(m)){if(!b(m))throw new TypeError;a=m}}return a}function Q(t,e,n){var a=N(t,e,n);if(a)return!0;var h=U(e);return x(h)?!1:Q(t,h,n)}function N(t,e,n){var a=D(e,n,!1);return d(a)?!1:ot(a.OrdinaryHasOwnMetadata(t,e,n))}function X(t,e,n){var a=N(t,e,n);if(a)return tt(t,e,n);var h=U(e);if(!x(h))return X(t,h,n)}function tt(t,e,n){var a=D(e,n,!1);if(!d(a))return a.OrdinaryGetOwnMetadata(t,e,n)}function et(t,e,n,a){var h=D(n,a,!0);h.OrdinaryDefineOwnMetadata(t,e,n,a)}function rt(t,e){var n=nt(t,e),a=U(t);if(a===null)return n;var h=rt(a,e);if(h.length<=0)return n;if(n.length<=0)return h;for(var k=new W,m=[],p=0,u=n;p<u.length;p++){var c=u[p],f=k.has(c);f||(k.add(c),m.push(c))}for(var l=0,y=h;l<y.length;l++){var c=y[l],f=k.has(c);f||(k.add(c),m.push(c))}return m}function nt(t,e){var n=D(t,e,!1);return n?n.OrdinaryOwnMetadataKeys(t,e):[]}function it(t){if(t===null)return 1;switch(typeof t){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return t===null?1:6;default:return 6}}function d(t){return t===void 0}function x(t){return t===null}function bt(t){return typeof t=="symbol"}function b(t){return typeof t=="object"?t!==null:typeof t=="function"}function mt(t,e){switch(it(t)){case 0:return t;case 1:return t;case 2:return t;case 3:return t;case 4:return t;case 5:return t}var n="string",a=ut(t,T);if(a!==void 0){var h=a.call(t,n);if(b(h))throw new TypeError;return h}return kt(t)}function kt(t,e){var n,a;{var h=t.toString;if(z(h)){var a=h.call(t);if(!b(a))return a}var n=t.valueOf;if(z(n)){var a=n.call(t);if(!b(a))return a}}throw new TypeError}function ot(t){return!!t}function Ot(t){return""+t}function M(t){var e=mt(t);return bt(e)?e:Ot(e)}function at(t){return Array.isArray?Array.isArray(t):t instanceof Object?t instanceof Array:Object.prototype.toString.call(t)==="[object Array]"}function z(t){return typeof t=="function"}function st(t){return typeof t=="function"}function St(t){switch(it(t)){case 3:return!0;case 4:return!0;default:return!1}}function H(t,e){return t===e||t!==t&&e!==e}function ut(t,e){var n=t[e];if(n!=null){if(!z(n))throw new TypeError;return n}}function ct(t){var e=ut(t,S);if(!z(e))throw new TypeError;var n=e.call(t);if(!b(n))throw new TypeError;return n}function ft(t){return t.value}function lt(t){var e=t.next();return e.done?!1:e}function ht(t){var e=t.return;e&&e.call(t)}function U(t){var e=Object.getPrototypeOf(t);if(typeof t!="function"||t===R||e!==R)return e;var n=t.prototype,a=n&&Object.getPrototypeOf(n);if(a==null||a===Object.prototype)return e;var h=a.constructor;return typeof h!="function"||h===t?e:h}function Mt(){var t;!d(P)&&typeof s.Reflect<"u"&&!(P in s.Reflect)&&typeof s.Reflect.defineMetadata=="function"&&(t=Tt(s.Reflect));var e,n,a,h=new K,k={registerProvider:m,getProvider:u,setProvider:f};return k;function m(l){if(!Object.isExtensible(k))throw new Error("Cannot add provider to a frozen registry.");switch(!0){case t===l:break;case d(e):e=l;break;case e===l:break;case d(n):n=l;break;case n===l:break;default:a===void 0&&(a=new W),a.add(l);break}}function p(l,y){if(!d(e)){if(e.isProviderFor(l,y))return e;if(!d(n)){if(n.isProviderFor(l,y))return e;if(!d(a))for(var _=ct(a);;){var v=lt(_);if(!v)return;var O=ft(v);if(O.isProviderFor(l,y))return ht(_),O}}}if(!d(t)&&t.isProviderFor(l,y))return t}function u(l,y){var _=h.get(l),v;return d(_)||(v=_.get(y)),d(v)&&(v=p(l,y),d(v)||(d(_)&&(_=new A,h.set(l,_)),_.set(y,v))),v}function c(l){if(d(l))throw new TypeError;return e===l||n===l||!d(a)&&a.has(l)}function f(l,y,_){if(!c(_))throw new Error("Metadata provider not registered.");var v=u(l,y);if(v!==_){if(!d(v))return!1;var O=h.get(l);d(O)&&(O=new A,h.set(l,O)),O.set(y,_)}return!0}}function Et(){var t;return!d(P)&&b(s.Reflect)&&Object.isExtensible(s.Reflect)&&(t=s.Reflect[P]),d(t)&&(t=Mt()),!d(P)&&b(s.Reflect)&&Object.isExtensible(s.Reflect)&&Object.defineProperty(s.Reflect,P,{enumerable:!1,configurable:!1,writable:!1,value:t}),t}function jt(t){var e=new K,n={isProviderFor:function(c,f){var l=e.get(c);return d(l)?!1:l.has(f)},OrdinaryDefineOwnMetadata:m,OrdinaryHasOwnMetadata:h,OrdinaryGetOwnMetadata:k,OrdinaryOwnMetadataKeys:p,OrdinaryDeleteMetadata:u};return V.registerProvider(n),n;function a(c,f,l){var y=e.get(c),_=!1;if(d(y)){if(!l)return;y=new A,e.set(c,y),_=!0}var v=y.get(f);if(d(v)){if(!l)return;if(v=new A,y.set(f,v),!t.setProvider(c,f,n))throw y.delete(f),_&&e.delete(c),new Error("Wrong provider for target.")}return v}function h(c,f,l){var y=a(f,l,!1);return d(y)?!1:ot(y.has(c))}function k(c,f,l){var y=a(f,l,!1);if(!d(y))return y.get(c)}function m(c,f,l,y){var _=a(l,y,!0);_.set(c,f)}function p(c,f){var l=[],y=a(c,f,!1);if(d(y))return l;for(var _=y.keys(),v=ct(_),O=0;;){var dt=lt(v);if(!dt)return l.length=O,l;var Rt=ft(dt);try{l[O]=Rt}catch(At){try{ht(v)}finally{throw At}}O++}}function u(c,f,l){var y=a(f,l,!1);if(d(y)||!y.delete(c))return!1;if(y.size===0){var _=e.get(f);d(_)||(_.delete(l),_.size===0&&e.delete(_))}return!0}}function Tt(t){var e=t.defineMetadata,n=t.hasOwnMetadata,a=t.getOwnMetadata,h=t.getOwnMetadataKeys,k=t.deleteMetadata,m=new K,p={isProviderFor:function(u,c){var f=m.get(u);return!d(f)&&f.has(c)?!0:h(u,c).length?(d(f)&&(f=new W,m.set(u,f)),f.add(c),!0):!1},OrdinaryDefineOwnMetadata:e,OrdinaryHasOwnMetadata:n,OrdinaryGetOwnMetadata:a,OrdinaryOwnMetadataKeys:h,OrdinaryDeleteMetadata:k};return p}function D(t,e,n){var a=V.getProvider(t,e);if(!d(a))return a;if(n){if(V.setProvider(t,e,J))return J;throw new Error("Illegal state.")}}function It(){var t={},e=[],n=function(){function p(u,c,f){this._index=0,this._keys=u,this._values=c,this._selector=f}return p.prototype["@@iterator"]=function(){return this},p.prototype[S]=function(){return this},p.prototype.next=function(){var u=this._index;if(u>=0&&u<this._keys.length){var c=this._selector(this._keys[u],this._values[u]);return u+1>=this._keys.length?(this._index=-1,this._keys=e,this._values=e):this._index++,{value:c,done:!1}}return{value:void 0,done:!0}},p.prototype.throw=function(u){throw this._index>=0&&(this._index=-1,this._keys=e,this._values=e),u},p.prototype.return=function(u){return this._index>=0&&(this._index=-1,this._keys=e,this._values=e),{value:u,done:!0}},p}(),a=function(){function p(){this._keys=[],this._values=[],this._cacheKey=t,this._cacheIndex=-2}return Object.defineProperty(p.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),p.prototype.has=function(u){return this._find(u,!1)>=0},p.prototype.get=function(u){var c=this._find(u,!1);return c>=0?this._values[c]:void 0},p.prototype.set=function(u,c){var f=this._find(u,!0);return this._values[f]=c,this},p.prototype.delete=function(u){var c=this._find(u,!1);if(c>=0){for(var f=this._keys.length,l=c+1;l<f;l++)this._keys[l-1]=this._keys[l],this._values[l-1]=this._values[l];return this._keys.length--,this._values.length--,H(u,this._cacheKey)&&(this._cacheKey=t,this._cacheIndex=-2),!0}return!1},p.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=t,this._cacheIndex=-2},p.prototype.keys=function(){return new n(this._keys,this._values,h)},p.prototype.values=function(){return new n(this._keys,this._values,k)},p.prototype.entries=function(){return new n(this._keys,this._values,m)},p.prototype["@@iterator"]=function(){return this.entries()},p.prototype[S]=function(){return this.entries()},p.prototype._find=function(u,c){if(!H(this._cacheKey,u)){this._cacheIndex=-1;for(var f=0;f<this._keys.length;f++)if(H(this._keys[f],u)){this._cacheIndex=f;break}}return this._cacheIndex<0&&c&&(this._cacheIndex=this._keys.length,this._keys.push(u),this._values.push(void 0)),this._cacheIndex},p}();return a;function h(p,u){return p}function k(p,u){return u}function m(p,u){return[p,u]}}function Pt(){var t=function(){function e(){this._map=new A}return Object.defineProperty(e.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),e.prototype.has=function(n){return this._map.has(n)},e.prototype.add=function(n){return this._map.set(n,n),this},e.prototype.delete=function(n){return this._map.delete(n)},e.prototype.clear=function(){this._map.clear()},e.prototype.keys=function(){return this._map.keys()},e.prototype.values=function(){return this._map.keys()},e.prototype.entries=function(){return this._map.entries()},e.prototype["@@iterator"]=function(){return this.keys()},e.prototype[S]=function(){return this.keys()},e}();return t}function xt(){var t=16,e=E.create(),n=a();return function(){function u(){this._key=a()}return u.prototype.has=function(c){var f=h(c,!1);return f!==void 0?E.has(f,this._key):!1},u.prototype.get=function(c){var f=h(c,!1);return f!==void 0?E.get(f,this._key):void 0},u.prototype.set=function(c,f){var l=h(c,!0);return l[this._key]=f,this},u.prototype.delete=function(c){var f=h(c,!1);return f!==void 0?delete f[this._key]:!1},u.prototype.clear=function(){this._key=a()},u}();function a(){var u;do u="@@WeakMap@@"+p();while(E.has(e,u));return e[u]=!0,u}function h(u,c){if(!w.call(u,n)){if(!c)return;Object.defineProperty(u,n,{value:E.create()})}return u[n]}function k(u,c){for(var f=0;f<c;++f)u[f]=Math.random()*255|0;return u}function m(u){if(typeof Uint8Array=="function"){var c=new Uint8Array(u);return typeof crypto<"u"?crypto.getRandomValues(c):typeof msCrypto<"u"?msCrypto.getRandomValues(c):k(c,u),c}return k(new Array(u),u)}function p(){var u=m(t);u[6]=u[6]&79|64,u[8]=u[8]&191|128;for(var c="",f=0;f<t;++f){var l=u[f];(f===4||f===6||f===8)&&(c+="-"),l<16&&(c+="0"),c+=l.toString(16).toLowerCase()}return c}}function L(t){return t.__=void 0,delete t.__,t}})}(i||(i={})),Ye}di();var pi=Object.defineProperty,yi=(i,r,o)=>r in i?pi(i,r,{enumerable:!0,configurable:!0,writable:!0,value:o}):i[r]=o,Bt=(i,r,o)=>yi(i,typeof r!="symbol"?r+"":r,o);let wi=class{constructor(r,o){Bt(this,"_target"),Bt(this,"_key"),Bt(this,"_oldValue"),Bt(this,"_wasDefined",!1),Bt(this,"_isSwapped",!1),this._target=r,this._key=o,this._oldValue=this._target[this._key]}get isSwapped(){return this._isSwapped}get originalValue(){return this._oldValue}get value(){return this._target[this._key]}get target(){return this._target}restore(){this.isSwapped&&(this._wasDefined?this._target[this._key]=this._oldValue:delete this._target[this._key],this._isSwapped=!1)}swap(r){this.isSwapped||(this._wasDefined=Object.hasOwn(this._target,this._key),this._oldValue=this._target[this._key]),this._target[this._key]=r,this._isSwapped=!0}};const _i={onlyIfNotExists:!0,isFactory:!1};let vi=class{constructor(r,o,s={}){if(se(this,"_installedInstances",new Map),se(this,"_path"),se(this,"_targetValue"),se(this,"_options"),this._path=r.split("."),this._path.length===0)throw new Error("Path must not be empty");this._targetValue=o,this._options={..._i,...s}}_getTargetObject(r){let o=r;for(const s of this._path.slice(0,this._path.length-1))o[s]||(o[s]={}),o=o[s];return o}_createSwapper(r){const o=this._getTargetObject(r);return new wi(o,this._path.at(-1))}install({sdk:r,...o}){if(this._installedInstances.has(r))return;const s=this._createSwapper(r);if(!(s.value&&this._options.onlyIfNotExists)){if(this._options.isFactory&&typeof this._targetValue=="function"){const w=this._targetValue({sdk:r,...o});s.swap(w)}else s.swap(this._targetValue);this._installedInstances.set(r,s)}}uninstall({sdk:r}){const o=this._installedInstances.get(r);o&&(o.restore(),this._installedInstances.delete(r))}};const Xe=Symbol("BigJunction"),tr=Symbol("AddBigJunction");function gi(){return"unsafeWindow"in window?window.unsafeWindow:window}function bi(i,r,o){const s=new i(o),w=new r(s);return gi().W.model.actionManager.add(w),s}const mi=[new vi("DataModel.BigJunctions.addBigJunction",({artifacts:i})=>r=>bi(i[Xe],i[tr],{geoJSONGeometry:r.geometry}).getID(),{isFactory:!0})];function ki(i,r,o={}){const s={type:"Feature"};return(o.id===0||o.id)&&(s.id=o.id),o.bbox&&(s.bbox=o.bbox),s.properties={},s.geometry=i,s}function Oi(i,r,o={}){for(const s of i){if(s.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");if(s[s.length-1].length!==s[0].length)throw new Error("First and last Position are not equivalent.");for(let w=0;w<s[s.length-1].length;w++)if(s[s.length-1][w]!==s[0][w])throw new Error("First and last Position are not equivalent.")}return ki({type:"Polygon",coordinates:i},r,o)}var Si=Object.defineProperty,Mi=(i,r,o)=>r in i?Si(i,r,{enumerable:!0,configurable:!0,writable:!0,value:o}):i[r]=o,Jt=(i,r,o)=>Mi(i,typeof r!="symbol"?r+"":r,o);let er=class{constructor(r,o){Jt(this,"_target"),Jt(this,"_key"),Jt(this,"_oldValue"),Jt(this,"_wasDefined",!1),Jt(this,"_isSwapped",!1),this._target=r,this._key=o,this._oldValue=this._target[this._key]}get isSwapped(){return this._isSwapped}get originalValue(){return this._oldValue}get value(){return this._target[this._key]}get target(){return this._target}restore(){this.isSwapped&&(this._wasDefined?this._target[this._key]=this._oldValue:delete this._target[this._key],this._isSwapped=!1)}swap(r){this.isSwapped||(this._wasDefined=Object.hasOwn(this._target,this._key),this._oldValue=this._target[this._key]),this._target[this._key]=r,this._isSwapped=!0}};function me(){return"unsafeWindow"in window?window.unsafeWindow:window}async function Ei(i){const r=[],o=new er(me().W.model.actionManager,"add");o.swap(s=>{r.push(s)});try{await i()}finally{o.restore()}return r}function ji(i){return i.memoizedProps||{}}function Ti(i){return typeof i=="object"&&i!==null&&"memoizedState"in i&&Array.isArray(i.memoizedState)&&i.memoizedState.length===2&&"queue"in i&&i.queue===null&&Array.isArray(i.memoizedState[1])}function Ii(i){return typeof i=="object"&&i!==null&&"memoizedState"in i&&typeof i.memoizedState=="object"&&i.memoizedState!==null&&"current"in i.memoizedState&&"queue"in i&&i.queue===null}function Pi(i){return typeof i=="object"&&i!==null&&"memoizedState"in i&&"queue"in i&&typeof i.queue=="object"&&i.queue!==null&&"dispatch"in i.queue&&typeof i.queue.dispatch=="function"}function xi(i){return Pi(i)?{type:"useState",value:i.memoizedState,dispatch:i.queue.dispatch}:Ti(i)?{type:"useMemo",value:i.memoizedState[0],dependencies:i.memoizedState[1]}:Ii(i)?{type:"useRef",current:i.memoizedState}:null}function Ri(i,r){const o=[];let s=i.memoizedState;for(;s;){const w=xi(s);w&&o.push(w),s=s.next}return o}function Ai(i,r,o=1/0){let s=i,w=0;for(;s&&w<o;){const g=s.memoizedState?Ri(s):[],T=ji(s),S={fiber:s,hooks:{all:g,useState:g.filter(j=>j.type==="useState"),useMemo:g.filter(j=>j.type==="useMemo"),useRef:g.filter(j=>j.type==="useRef")},props:T};if(r(S))return S;s=s.return,w++}return null}const $i="__reactFiber$";function Di(i){const r=Object.keys(i).find(s=>s.startsWith($i));if(!r)throw new Error(`No fiber key found for element: ${i}`);const o=i[r];if(!o)throw new Error(`No fiber found for element: ${i}`);return o}const Fi=i=>new Promise(r=>{const o=me(),s=new er(o.W.map.olMap,"addControl");s.swap(w=>{i==null||i(w),r(w),s.restore()})});function Vi(i){const r=me(),o=r.W.userscripts.toOLGeometry(i);return new r.OpenLayers.Feature.Vector(o)}async function Ci(i,r){const o=Ai(Di(i),g=>"onClick"in g.props&&typeof g.props.onClick=="function");if(!o)throw new Error("No fiber found with draw initiator");const{onClick:s}=o.props;//! OpenLayers dependent code below - implementation might change over time
const w=Fi(g=>{g.activate=()=>{}});s(new Event("click")),(await w).events.triggerEvent("featureadded",{feature:Vi(r)})}var zi=Object.defineProperty,Ki=(i,r,o)=>r in i?zi(i,r,{enumerable:!0,configurable:!0,writable:!0,value:o}):i[r]=o,rr=(i,r,o)=>Ki(i,typeof r!="symbol"?r+"":r,o);function Wi(){return"unsafeWindow"in window?window.unsafeWindow:window}var Ni=Object.defineProperty,Hi=(i,r,o)=>r in i?Ni(i,r,{enumerable:!0,configurable:!0,writable:!0,value:o}):i[r]=o,Vt=(i,r,o)=>Hi(i,typeof r!="symbol"?r+"":r,o);let Ui=class{constructor(r,o){Vt(this,"_target"),Vt(this,"_key"),Vt(this,"_oldValue"),Vt(this,"_wasDefined",!1),Vt(this,"_isSwapped",!1),this._target=r,this._key=o,this._oldValue=this._target[this._key]}get isSwapped(){return this._isSwapped}get originalValue(){return this._oldValue}get value(){return this._target[this._key]}get target(){return this._target}restore(){this.isSwapped&&(this._wasDefined?this._target[this._key]=this._oldValue:delete this._target[this._key],this._isSwapped=!1)}swap(r){this.isSwapped||(this._wasDefined=Object.hasOwn(this._target,this._key),this._oldValue=this._target[this._key]),this._target[this._key]=r,this._isSwapped=!0}},Li=class{constructor(r,o,s){Vt(this,"_enabled",!1),Vt(this,"_fnSwapper"),Vt(this,"_interceptionFunction"),Vt(this,"_middlewares",[]),this._fnSwapper=new Ui(r,o),this._interceptionFunction=s}get enabled(){return this._fnSwapper.isSwapped&&this._enabled}disable(){this._enabled=!1,this.enabled}restore(){this._fnSwapper.restore()}enable(){this._enabled=!0,this._fnSwapper.isSwapped||this.swapToInterceptor()}swapToInterceptor(){const r=this;this._fnSwapper.swap(function(...o){if(!r._enabled)return r.callOriginalInvocator(...o);const s=r.runMiddlewares(o);if(s){if("output"in s)return s.output;"input"in s&&(o=s.input)}return r._interceptionFunction.call(this,r.getOriginalInvocator(this),...o)})}getOriginalInvocator(r){return this._fnSwapper.originalValue.bind(r??this._fnSwapper.target)}callOriginalInvocator(...r){return this.getOriginalInvocator()(...r)}runMiddlewares(r){for(const o of this._middlewares){const s=o(...r);if(s){if("output"in s)return s;"input"in s&&(r=s.input)}}return{input:r}}registerMiddleware(r){this._middlewares.push(r)}},qi=class{constructor(r){rr(this,"_fetchInterceptor"),rr(this,"_interceptionFilters",new Set),this._fetchInterceptor=new Li(r,"fetch",(o,s,w)=>{for(const g of this._interceptionFilters)if(g.shouldIntercept(s,w))return this.shouldKeepFilter(g,s,w)||this.removeInterceptionFilter(g),g.intercept(s,w);return o(s,w)})}enable(){this._fetchInterceptor.enable()}disable(){this._fetchInterceptor.disable()}addInterceptionFilter(r){this.enable(),this._interceptionFilters.add(r)}removeInterceptionFilter(r){this._interceptionFilters.delete(r)}shouldKeepFilter(r,o,s){return typeof r.shouldKeep=="function"?r.shouldKeep(o,s):typeof r.shouldKeep=="boolean"?r.shouldKeep:!1}};new qi(Wi());const Gi=[{async install(){const i=document.querySelector("#drawer wz-menu > wz-menu-sub-menu:nth-child(1) > wz-menu-item:nth-of-type(4)");if(!i||!(i instanceof HTMLElement))throw new Error("Unable to find school zone drawing menu item");const[r]=await Ei(async()=>{await Ci(i,Oi([[[0,0],[0,1],[1,1],[0,0]]]).geometry)});if(r.actionName!=="ADD_BIG_JUNCTION")throw new Error("Unexpected action discovered when tried to resolve AddBigJunction action: "+r.actionName);const o=r.bigJunction;if(!o)throw new Error("Unexpected state: Added object does not exist");if(o.type!=="bigJunction")throw new Error("Unexpected state: Expected the added object to be a BigJunction instead of "+r.type);return{[Xe]:o.constructor,[tr]:r.constructor}}}],Bi=[...Gi,...mi];var Ji=Object.defineProperty,Zi=(i,r,o)=>r in i?Ji(i,r,{enumerable:!0,configurable:!0,writable:!0,value:o}):i[r]=o,B=(i,r,o)=>Zi(i,typeof r!="symbol"?r+"":r,o),Yi=Object.defineProperty,Qi=(i,r,o)=>r in i?Yi(i,r,{enumerable:!0,configurable:!0,writable:!0,value:o}):i[r]=o,ue=(i,r,o)=>Qi(i,typeof r!="symbol"?r+"":r,o),nr=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},ir={};/*! *****************************************************************************
  Copyright (C) Microsoft. All rights reserved.
  Licensed under the Apache License, Version 2.0 (the "License"); you may not use
  this file except in compliance with the License. You may obtain a copy of the
  License at http://www.apache.org/licenses/LICENSE-2.0

  THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
  WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
  MERCHANTABLITY OR NON-INFRINGEMENT.

  See the Apache Version 2.0 License for specific language governing permissions
  and limitations under the License.
  ***************************************************************************** */var or;function Xi(){if(or)return ir;or=1;var i;return function(r){(function(o){var s=typeof globalThis=="object"?globalThis:typeof nr=="object"?nr:typeof self=="object"?self:typeof this=="object"?this:j(),w=g(r);typeof s.Reflect<"u"&&(w=g(s.Reflect,w)),o(w,s),typeof s.Reflect>"u"&&(s.Reflect=r);function g($,I){return function(E,R){Object.defineProperty($,E,{configurable:!0,writable:!0,value:R}),I&&I(E,R)}}function T(){try{return Function("return this;")()}catch{}}function S(){try{return(0,eval)("(function() { return this; })()")}catch{}}function j(){return T()||S()}})(function(o,s){var w=Object.prototype.hasOwnProperty,g=typeof Symbol=="function",T=g&&typeof Symbol.toPrimitive<"u"?Symbol.toPrimitive:"@@toPrimitive",S=g&&typeof Symbol.iterator<"u"?Symbol.iterator:"@@iterator",j=typeof Object.create=="function",$={__proto__:[]}instanceof Array,I=!j&&!$,E={create:j?function(){return L(Object.create(null))}:$?function(){return L({__proto__:null})}:function(){return L({})},has:I?function(t,e){return w.call(t,e)}:function(t,e){return e in t},get:I?function(t,e){return w.call(t,e)?t[e]:void 0}:function(t,e){return t[e]}},R=Object.getPrototypeOf(Function),A=typeof Map=="function"&&typeof Map.prototype.entries=="function"?Map:It(),W=typeof Set=="function"&&typeof Set.prototype.entries=="function"?Set:Pt(),K=typeof WeakMap=="function"?WeakMap:xt(),P=g?Symbol.for("@reflect-metadata:registry"):void 0,V=Et(),J=jt(V);function wt(t,e,n,a){if(d(n)){if(!at(t))throw new TypeError;if(!st(e))throw new TypeError;return vt(t,e)}else{if(!at(t))throw new TypeError;if(!b(e))throw new TypeError;if(!b(a)&&!d(a)&&!x(a))throw new TypeError;return x(a)&&(a=void 0),n=M(n),gt(t,e,n,a)}}o("decorate",wt);function F(t,e){function n(a,h){if(!b(a))throw new TypeError;if(!d(h)&&!St(h))throw new TypeError;et(t,e,a,h)}return n}o("metadata",F);function C(t,e,n,a){if(!b(n))throw new TypeError;return d(a)||(a=M(a)),et(t,e,n,a)}o("defineMetadata",C);function q(t,e,n){if(!b(e))throw new TypeError;return d(n)||(n=M(n)),Q(t,e,n)}o("hasMetadata",q);function G(t,e,n){if(!b(e))throw new TypeError;return d(n)||(n=M(n)),N(t,e,n)}o("hasOwnMetadata",G);function yt(t,e,n){if(!b(e))throw new TypeError;return d(n)||(n=M(n)),X(t,e,n)}o("getMetadata",yt);function Z(t,e,n){if(!b(e))throw new TypeError;return d(n)||(n=M(n)),tt(t,e,n)}o("getOwnMetadata",Z);function Y(t,e){if(!b(t))throw new TypeError;return d(e)||(e=M(e)),rt(t,e)}o("getMetadataKeys",Y);function pt(t,e){if(!b(t))throw new TypeError;return d(e)||(e=M(e)),nt(t,e)}o("getOwnMetadataKeys",pt);function _t(t,e,n){if(!b(e))throw new TypeError;if(d(n)||(n=M(n)),!b(e))throw new TypeError;d(n)||(n=M(n));var a=D(e,n,!1);return d(a)?!1:a.OrdinaryDeleteMetadata(t,e,n)}o("deleteMetadata",_t);function vt(t,e){for(var n=t.length-1;n>=0;--n){var a=t[n],h=a(e);if(!d(h)&&!x(h)){if(!st(h))throw new TypeError;e=h}}return e}function gt(t,e,n,a){for(var h=t.length-1;h>=0;--h){var k=t[h],m=k(e,n,a);if(!d(m)&&!x(m)){if(!b(m))throw new TypeError;a=m}}return a}function Q(t,e,n){var a=N(t,e,n);if(a)return!0;var h=U(e);return x(h)?!1:Q(t,h,n)}function N(t,e,n){var a=D(e,n,!1);return d(a)?!1:ot(a.OrdinaryHasOwnMetadata(t,e,n))}function X(t,e,n){var a=N(t,e,n);if(a)return tt(t,e,n);var h=U(e);if(!x(h))return X(t,h,n)}function tt(t,e,n){var a=D(e,n,!1);if(!d(a))return a.OrdinaryGetOwnMetadata(t,e,n)}function et(t,e,n,a){var h=D(n,a,!0);h.OrdinaryDefineOwnMetadata(t,e,n,a)}function rt(t,e){var n=nt(t,e),a=U(t);if(a===null)return n;var h=rt(a,e);if(h.length<=0)return n;if(n.length<=0)return h;for(var k=new W,m=[],p=0,u=n;p<u.length;p++){var c=u[p],f=k.has(c);f||(k.add(c),m.push(c))}for(var l=0,y=h;l<y.length;l++){var c=y[l],f=k.has(c);f||(k.add(c),m.push(c))}return m}function nt(t,e){var n=D(t,e,!1);return n?n.OrdinaryOwnMetadataKeys(t,e):[]}function it(t){if(t===null)return 1;switch(typeof t){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return t===null?1:6;default:return 6}}function d(t){return t===void 0}function x(t){return t===null}function bt(t){return typeof t=="symbol"}function b(t){return typeof t=="object"?t!==null:typeof t=="function"}function mt(t,e){switch(it(t)){case 0:return t;case 1:return t;case 2:return t;case 3:return t;case 4:return t;case 5:return t}var n="string",a=ut(t,T);if(a!==void 0){var h=a.call(t,n);if(b(h))throw new TypeError;return h}return kt(t)}function kt(t,e){var n,a;{var h=t.toString;if(z(h)){var a=h.call(t);if(!b(a))return a}var n=t.valueOf;if(z(n)){var a=n.call(t);if(!b(a))return a}}throw new TypeError}function ot(t){return!!t}function Ot(t){return""+t}function M(t){var e=mt(t);return bt(e)?e:Ot(e)}function at(t){return Array.isArray?Array.isArray(t):t instanceof Object?t instanceof Array:Object.prototype.toString.call(t)==="[object Array]"}function z(t){return typeof t=="function"}function st(t){return typeof t=="function"}function St(t){switch(it(t)){case 3:return!0;case 4:return!0;default:return!1}}function H(t,e){return t===e||t!==t&&e!==e}function ut(t,e){var n=t[e];if(n!=null){if(!z(n))throw new TypeError;return n}}function ct(t){var e=ut(t,S);if(!z(e))throw new TypeError;var n=e.call(t);if(!b(n))throw new TypeError;return n}function ft(t){return t.value}function lt(t){var e=t.next();return e.done?!1:e}function ht(t){var e=t.return;e&&e.call(t)}function U(t){var e=Object.getPrototypeOf(t);if(typeof t!="function"||t===R||e!==R)return e;var n=t.prototype,a=n&&Object.getPrototypeOf(n);if(a==null||a===Object.prototype)return e;var h=a.constructor;return typeof h!="function"||h===t?e:h}function Mt(){var t;!d(P)&&typeof s.Reflect<"u"&&!(P in s.Reflect)&&typeof s.Reflect.defineMetadata=="function"&&(t=Tt(s.Reflect));var e,n,a,h=new K,k={registerProvider:m,getProvider:u,setProvider:f};return k;function m(l){if(!Object.isExtensible(k))throw new Error("Cannot add provider to a frozen registry.");switch(!0){case t===l:break;case d(e):e=l;break;case e===l:break;case d(n):n=l;break;case n===l:break;default:a===void 0&&(a=new W),a.add(l);break}}function p(l,y){if(!d(e)){if(e.isProviderFor(l,y))return e;if(!d(n)){if(n.isProviderFor(l,y))return e;if(!d(a))for(var _=ct(a);;){var v=lt(_);if(!v)return;var O=ft(v);if(O.isProviderFor(l,y))return ht(_),O}}}if(!d(t)&&t.isProviderFor(l,y))return t}function u(l,y){var _=h.get(l),v;return d(_)||(v=_.get(y)),d(v)&&(v=p(l,y),d(v)||(d(_)&&(_=new A,h.set(l,_)),_.set(y,v))),v}function c(l){if(d(l))throw new TypeError;return e===l||n===l||!d(a)&&a.has(l)}function f(l,y,_){if(!c(_))throw new Error("Metadata provider not registered.");var v=u(l,y);if(v!==_){if(!d(v))return!1;var O=h.get(l);d(O)&&(O=new A,h.set(l,O)),O.set(y,_)}return!0}}function Et(){var t;return!d(P)&&b(s.Reflect)&&Object.isExtensible(s.Reflect)&&(t=s.Reflect[P]),d(t)&&(t=Mt()),!d(P)&&b(s.Reflect)&&Object.isExtensible(s.Reflect)&&Object.defineProperty(s.Reflect,P,{enumerable:!1,configurable:!1,writable:!1,value:t}),t}function jt(t){var e=new K,n={isProviderFor:function(c,f){var l=e.get(c);return d(l)?!1:l.has(f)},OrdinaryDefineOwnMetadata:m,OrdinaryHasOwnMetadata:h,OrdinaryGetOwnMetadata:k,OrdinaryOwnMetadataKeys:p,OrdinaryDeleteMetadata:u};return V.registerProvider(n),n;function a(c,f,l){var y=e.get(c),_=!1;if(d(y)){if(!l)return;y=new A,e.set(c,y),_=!0}var v=y.get(f);if(d(v)){if(!l)return;if(v=new A,y.set(f,v),!t.setProvider(c,f,n))throw y.delete(f),_&&e.delete(c),new Error("Wrong provider for target.")}return v}function h(c,f,l){var y=a(f,l,!1);return d(y)?!1:ot(y.has(c))}function k(c,f,l){var y=a(f,l,!1);if(!d(y))return y.get(c)}function m(c,f,l,y){var _=a(l,y,!0);_.set(c,f)}function p(c,f){var l=[],y=a(c,f,!1);if(d(y))return l;for(var _=y.keys(),v=ct(_),O=0;;){var dt=lt(v);if(!dt)return l.length=O,l;var Rt=ft(dt);try{l[O]=Rt}catch(At){try{ht(v)}finally{throw At}}O++}}function u(c,f,l){var y=a(f,l,!1);if(d(y)||!y.delete(c))return!1;if(y.size===0){var _=e.get(f);d(_)||(_.delete(l),_.size===0&&e.delete(_))}return!0}}function Tt(t){var e=t.defineMetadata,n=t.hasOwnMetadata,a=t.getOwnMetadata,h=t.getOwnMetadataKeys,k=t.deleteMetadata,m=new K,p={isProviderFor:function(u,c){var f=m.get(u);return!d(f)&&f.has(c)?!0:h(u,c).length?(d(f)&&(f=new W,m.set(u,f)),f.add(c),!0):!1},OrdinaryDefineOwnMetadata:e,OrdinaryHasOwnMetadata:n,OrdinaryGetOwnMetadata:a,OrdinaryOwnMetadataKeys:h,OrdinaryDeleteMetadata:k};return p}function D(t,e,n){var a=V.getProvider(t,e);if(!d(a))return a;if(n){if(V.setProvider(t,e,J))return J;throw new Error("Illegal state.")}}function It(){var t={},e=[],n=function(){function p(u,c,f){this._index=0,this._keys=u,this._values=c,this._selector=f}return p.prototype["@@iterator"]=function(){return this},p.prototype[S]=function(){return this},p.prototype.next=function(){var u=this._index;if(u>=0&&u<this._keys.length){var c=this._selector(this._keys[u],this._values[u]);return u+1>=this._keys.length?(this._index=-1,this._keys=e,this._values=e):this._index++,{value:c,done:!1}}return{value:void 0,done:!0}},p.prototype.throw=function(u){throw this._index>=0&&(this._index=-1,this._keys=e,this._values=e),u},p.prototype.return=function(u){return this._index>=0&&(this._index=-1,this._keys=e,this._values=e),{value:u,done:!0}},p}(),a=function(){function p(){this._keys=[],this._values=[],this._cacheKey=t,this._cacheIndex=-2}return Object.defineProperty(p.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),p.prototype.has=function(u){return this._find(u,!1)>=0},p.prototype.get=function(u){var c=this._find(u,!1);return c>=0?this._values[c]:void 0},p.prototype.set=function(u,c){var f=this._find(u,!0);return this._values[f]=c,this},p.prototype.delete=function(u){var c=this._find(u,!1);if(c>=0){for(var f=this._keys.length,l=c+1;l<f;l++)this._keys[l-1]=this._keys[l],this._values[l-1]=this._values[l];return this._keys.length--,this._values.length--,H(u,this._cacheKey)&&(this._cacheKey=t,this._cacheIndex=-2),!0}return!1},p.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=t,this._cacheIndex=-2},p.prototype.keys=function(){return new n(this._keys,this._values,h)},p.prototype.values=function(){return new n(this._keys,this._values,k)},p.prototype.entries=function(){return new n(this._keys,this._values,m)},p.prototype["@@iterator"]=function(){return this.entries()},p.prototype[S]=function(){return this.entries()},p.prototype._find=function(u,c){if(!H(this._cacheKey,u)){this._cacheIndex=-1;for(var f=0;f<this._keys.length;f++)if(H(this._keys[f],u)){this._cacheIndex=f;break}}return this._cacheIndex<0&&c&&(this._cacheIndex=this._keys.length,this._keys.push(u),this._values.push(void 0)),this._cacheIndex},p}();return a;function h(p,u){return p}function k(p,u){return u}function m(p,u){return[p,u]}}function Pt(){var t=function(){function e(){this._map=new A}return Object.defineProperty(e.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),e.prototype.has=function(n){return this._map.has(n)},e.prototype.add=function(n){return this._map.set(n,n),this},e.prototype.delete=function(n){return this._map.delete(n)},e.prototype.clear=function(){this._map.clear()},e.prototype.keys=function(){return this._map.keys()},e.prototype.values=function(){return this._map.keys()},e.prototype.entries=function(){return this._map.entries()},e.prototype["@@iterator"]=function(){return this.keys()},e.prototype[S]=function(){return this.keys()},e}();return t}function xt(){var t=16,e=E.create(),n=a();return function(){function u(){this._key=a()}return u.prototype.has=function(c){var f=h(c,!1);return f!==void 0?E.has(f,this._key):!1},u.prototype.get=function(c){var f=h(c,!1);return f!==void 0?E.get(f,this._key):void 0},u.prototype.set=function(c,f){var l=h(c,!0);return l[this._key]=f,this},u.prototype.delete=function(c){var f=h(c,!1);return f!==void 0?delete f[this._key]:!1},u.prototype.clear=function(){this._key=a()},u}();function a(){var u;do u="@@WeakMap@@"+p();while(E.has(e,u));return e[u]=!0,u}function h(u,c){if(!w.call(u,n)){if(!c)return;Object.defineProperty(u,n,{value:E.create()})}return u[n]}function k(u,c){for(var f=0;f<c;++f)u[f]=Math.random()*255|0;return u}function m(u){if(typeof Uint8Array=="function"){var c=new Uint8Array(u);return typeof crypto<"u"?crypto.getRandomValues(c):typeof msCrypto<"u"?msCrypto.getRandomValues(c):k(c,u),c}return k(new Array(u),u)}function p(){var u=m(t);u[6]=u[6]&79|64,u[8]=u[8]&191|128;for(var c="",f=0;f<t;++f){var l=u[f];(f===4||f===6||f===8)&&(c+="-"),l<16&&(c+="0"),c+=l.toString(16).toLowerCase()}return c}}function L(t){return t.__=void 0,delete t.__,t}})}(i||(i={})),ir}Xi();var to=Object.defineProperty,eo=(i,r,o)=>r in i?to(i,r,{enumerable:!0,configurable:!0,writable:!0,value:o}):i[r]=o,Zt=(i,r,o)=>eo(i,typeof r!="symbol"?r+"":r,o);class ro{constructor(r,o){Zt(this,"_target"),Zt(this,"_key"),Zt(this,"_oldValue"),Zt(this,"_wasDefined",!1),Zt(this,"_isSwapped",!1),this._target=r,this._key=o,this._oldValue=this._target[this._key]}get isSwapped(){return this._isSwapped}get originalValue(){return this._oldValue}get value(){return this._target[this._key]}get target(){return this._target}restore(){this.isSwapped&&(this._wasDefined?this._target[this._key]=this._oldValue:delete this._target[this._key],this._isSwapped=!1)}swap(r){this.isSwapped||(this._wasDefined=Object.hasOwn(this._target,this._key),this._oldValue=this._target[this._key]),this._target[this._key]=r,this._isSwapped=!0}}const no={onlyIfNotExists:!0,isFactory:!1};class io{constructor(r,o,s={}){if(ue(this,"_installedInstances",new Map),ue(this,"_path"),ue(this,"_targetValue"),ue(this,"_options"),this._path=r.split("."),this._path.length===0)throw new Error("Path must not be empty");this._targetValue=o,this._options={...no,...s}}_getTargetObject(r){let o=r;for(const s of this._path.slice(0,this._path.length-1))o[s]||(o[s]={}),o=o[s];return o}_createSwapper(r){const o=this._getTargetObject(r);return new ro(o,this._path.at(-1))}install({sdk:r,...o}){if(this._installedInstances.has(r))return;const s=this._createSwapper(r);if(!(s.value&&this._options.onlyIfNotExists)){if(this._options.isFactory&&typeof this._targetValue=="function"){const w=this._targetValue({sdk:r,...o});s.swap(w)}else s.swap(this._targetValue);this._installedInstances.set(r,s)}}uninstall({sdk:r}){const o=this._installedInstances.get(r);o&&(o.restore(),this._installedInstances.delete(r))}}class ke extends Error{constructor(r){super(r),this.name="MiddlewareError"}}class oo extends ke{constructor(r){super(r),this.name="MiddlewareFlowError"}}class ao extends ke{constructor(r="Action prevented by middleware."){super(r),this.name="MiddlewarePreventedError"}}function ce(i){if(i===null||typeof i!="object")return i;if(Array.isArray(i))return i.map(o=>ce(o));if(i instanceof Date)return new Date(i);const r={};for(const o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=ce(i[o]));return r}function ar(i){Object.freeze(i);for(const r in i)if(Object.prototype.hasOwnProperty.call(i,r)){const o=i[r];o&&typeof o=="object"&&ar(o)}return i}function so(i){let r=!1,o=null;const s=()=>r,w=()=>r=!0;return[function(...g){return w(),o=i.apply(this,g)},s,()=>{if(!r)throw new Error("Function has not been called yet");return o}]}class uo{constructor(r,o,s,w){B(this,"actionPoint"),B(this,"data"),B(this,"originalData"),B(this,"wmeSdk"),this.data=o,Object.defineProperty(this,"actionPoint",{value:r,writable:!1,configurable:!1,enumerable:!0}),Object.defineProperty(this,"originalData",{value:s,writable:!1,configurable:!1,enumerable:!0}),Object.defineProperty(this,"wmeSdk",{value:w,writable:!1,configurable:!1,enumerable:!0})}}class co{constructor(r,o,s,w){B(this,"actionPoint"),B(this,"data"),B(this,"mutatedData"),B(this,"wmeSdk"),B(this,"handlers"),this.actionPoint=r,this.data=this.mutatedData=o,this.wmeSdk=s,this.handlers=w}getSafeImmutableData(){return ar(ce(this.data))}getSafeMutableData(){return ce(this.mutatedData)}createContext(){return new uo(this.actionPoint,this.getSafeMutableData(),this.getSafeImmutableData(),this.wmeSdk)}async run(r){let o=-1;const s=async w=>{if(w<=o)throw await new Promise(I=>setTimeout(I,1e3)),new oo("next() called multiple times within the same middleware or improperly nested.");if(o=w,w>=this.handlers.length)return r(this.mutatedData);const g=this.handlers[o],T=this.createContext(),[S,j,$]=so(()=>(this.mutatedData=T.data,s(w+1)));try{return await Promise.resolve(g(T,S)),j()?await $():(console.warn(`Middleware handler "${g.name||"anonymous"}" did not call next() and did not throw an error. This is not recommended and may cause unexpected behavior.
Ensure to always call next() or throw an error to stop the middleware chain.`),await S())}catch(I){if(I instanceof ao)return null;throw I}};return await s(0)}}class fo extends EventTarget{constructor(r){super(),B(this,"middleware",new Map),B(this,"wmeSdk"),this.wmeSdk=r}register(r,o){if(typeof o!="function")throw new ke("Middleware handler must be a function.");const s=this.middleware.get(r)||[],w={handler:o};s.push(w),this.middleware.set(r,s),this.dispatchEvent(new CustomEvent("middlewareRegistered",{detail:{actionPoint:r}}));let g=!1;return()=>{if(g)return;const T=this.middleware.get(r);if(!T)return;const S=T.indexOf(w);S!==-1&&(T.splice(S,1),T.length===0&&this.middleware.delete(r),g=!0,this.dispatchEvent(new CustomEvent("middlewareUnregistered",{detail:{actionPoint:r}})))}}async execute(r,o,s){const w=this.middleware.get(r)||[];await new co(r,o,this.wmeSdk,w.map(g=>g.handler)).run(s)}hasListeners(r){return this.middleware.has(r)&&(this.middleware.get(r)||[]).length>0}}const Oe=Symbol("REGISTRY");var lo=Object.defineProperty,ho=(i,r,o)=>r in i?lo(i,r,{enumerable:!0,configurable:!0,writable:!0,value:o}):i[r]=o,Ct=(i,r,o)=>ho(i,typeof r!="symbol"?r+"":r,o);class po{constructor(r,o){Ct(this,"_target"),Ct(this,"_key"),Ct(this,"_oldValue"),Ct(this,"_wasDefined",!1),Ct(this,"_isSwapped",!1),this._target=r,this._key=o,this._oldValue=this._target[this._key]}get isSwapped(){return this._isSwapped}get originalValue(){return this._oldValue}get value(){return this._target[this._key]}get target(){return this._target}restore(){this.isSwapped&&(this._wasDefined?this._target[this._key]=this._oldValue:delete this._target[this._key],this._isSwapped=!1)}swap(r){this.isSwapped||(this._wasDefined=Object.hasOwn(this._target,this._key),this._oldValue=this._target[this._key]),this._target[this._key]=r,this._isSwapped=!0}}let sr=class{constructor(i,r,o){Ct(this,"_enabled",!1),Ct(this,"_fnSwapper"),Ct(this,"_interceptionFunction"),Ct(this,"_middlewares",[]),this._fnSwapper=new po(i,r),this._interceptionFunction=o}get enabled(){return this._fnSwapper.isSwapped&&this._enabled}disable(){this._enabled=!1,this.enabled}restore(){this._fnSwapper.restore()}enable(){this._enabled=!0,this._fnSwapper.isSwapped||this.swapToInterceptor()}swapToInterceptor(){const i=this;this._fnSwapper.swap(function(...r){if(!i._enabled)return i.callOriginalInvocator(...r);const o=i.runMiddlewares(r);if(o){if("output"in o)return o.output;"input"in o&&(r=o.input)}return i._interceptionFunction.call(this,i.getOriginalInvocator(this),...r)})}getOriginalInvocator(i){return this._fnSwapper.originalValue.bind(i??this._fnSwapper.target)}callOriginalInvocator(...i){return this.getOriginalInvocator()(...i)}runMiddlewares(i){for(const r of this._middlewares){const o=r(...i);if(o){if("output"in o)return o;"input"in o&&(i=o.input)}}return{input:i}}registerMiddleware(i){this._middlewares.push(i)}};function Yt(){return"unsafeWindow"in window?window.unsafeWindow:window}class ur{constructor(r){B(this,"isMiddlewareDefined",!1),B(this,"uninstaller",null),B(this,"registry"),B(this,"artifacts"),B(this,"handleMiddlewareRegistered",o=>{o.detail.actionPoint===this.options.actionPoint&&this.defineMiddleware(this.artifacts)}),B(this,"handleMiddlewareUnregistered",o=>{var s;o.detail.actionPoint===this.options.actionPoint&&((s=this.registry)!=null&&s.hasListeners(this.options.actionPoint)||this.undefineMiddleware())}),this.options=r}addRegistryEvents(){var r,o;(r=this.registry)==null||r.addEventListener("middlewareRegistered",this.handleMiddlewareRegistered),(o=this.registry)==null||o.addEventListener("middlewareUnregistered",this.handleMiddlewareUnregistered)}removeRegistryEvents(){var r,o;(r=this.registry)==null||r.removeEventListener("middlewareRegistered",this.handleMiddlewareRegistered),(o=this.registry)==null||o.removeEventListener("middlewareUnregistered",this.handleMiddlewareUnregistered)}defineMiddleware(r){this.isMiddlewareDefined||(this.uninstaller=this.options.install(o=>new Promise(s=>{if(!this.registry)return s(o);this.registry.execute(this.options.actionPoint,o,s)}),r)||null,this.isMiddlewareDefined=!0)}undefineMiddleware(){var r;this.isMiddlewareDefined&&((r=this.uninstaller)==null||r.call(this),this.isMiddlewareDefined=!1)}install({artifacts:r}){var o;this.artifacts=r,this.registry=r[this.options.registryArtifactName??Oe],(o=this.registry)!=null&&o.hasListeners(this.options.actionPoint)&&this.defineMiddleware(r),this.addRegistryEvents()}uninstall(){this.removeRegistryEvents(),this.undefineMiddleware(),this.registry=void 0}}function yo(){return new Promise(i=>{const r="problems:shown",o=Yt(),s=async w=>{if(w.type!=="mapUpdateRequest")return;o.W.app.off(r,s);const g=await o.W.problemsController.editController.adapter.getCommentable();i(g.constructor)};o.W.app.on(r,s)})}const wo=new ur({actionPoint:"updateRequests.addComment",install:i=>{let r=null;return yo().then(o=>{r=new sr(o.prototype,"addComment",async function(s,w,...g){const T=await i({updateRequestId:this.conversation.getID(),message:w});return s(T.message,...g)}),r.enable()}),()=>{r==null||r.disable()}}});function _o(i){return"subActions"in i&&Array.isArray(i.subActions)}function cr(i,r){const o=[];if(typeof r!="function"){const s=r;r=w=>s===w}for(const s in i){const w=i[s];if(r(w))return o.concat(parseInt(s));if(w.subActions){const g=cr(w.subActions,r);if(g)return o.concat(parseInt(s),...g)}}return null}class fe{constructor(r){B(this,"actions"),this.actions=r}getActionsFlat(){return this.actions.flatMap(r=>_o(r)?r.getSubActions():[r])}getActionPath(r){return cr(this.actions,r)}hasAction(r){return this.getActionPath(r)!==null}removeAction(r){var o;const s=r.pop();let w={subActions:this.actions};for(;r.length;)w=(o=w.subActions)==null?void 0:o[r.shift()];s!==void 0&&w.subActions.splice(s,1)}replaceAction(r,...o){var s;const w=r.pop();let g={subActions:this.actions};for(;r.length;)g=(s=g.subActions)==null?void 0:s[r.shift()];w!==void 0&&g.subActions.splice(w,1,...o)}addAction(r){this.actions.push(r)}}class vo{constructor(r,o){B(this,"saveInterceptor"),this.saveInterceptor=new sr(r.controller,"save",async function(s,w,...g){const T=new fe((w==null?void 0:w.actions)||this.model.actionManager.getActions()),S=await Promise.resolve(o(T));if(S){const j={pendingEdits:null,saveCount:{bigJunctions:0,nodes:0,segments:0,venues:0},unsavedFeatures:[]};for(const $ of S){const I=await s({...w||{},actions:$.actions},...g);j.saveCount.bigJunctions+=I.saveCount.bigJunctions,j.saveCount.nodes+=I.saveCount.nodes,j.saveCount.segments+=I.saveCount.segments,j.saveCount.venues+=I.saveCount.venues,I.unsavedFeatures&&j.unsavedFeatures.push(...I.unsavedFeatures)}return j}return s({...w||{},actions:T.actions},...g)})}enable(){return this.saveInterceptor.enable()}disable(){return this.saveInterceptor.disable()}}const go="ADD_ROAD_CLOSURE";function Se(i){return i.actionName===go}const bo="ADD_TURN_CLOSURE";function Me(i){var r;return i.actionName===bo&&((r=i.getObject())==null?void 0:r.type)==="turnClosure"}function fr(i){return i.actionName==="UPDATE_OBJECT"}function lr(i){return fr(i)&&i.object.type==="roadClosure"}function hr(i){return fr(i)&&i.object.type==="turnClosure"}const mo="DELETE_ROAD_CLOSURE";function Ee(i){return i.actionName===mo}function ko(i){return i.actionName==="DELETE_OBJECT"}function je(i){return ko(i)&&i.object.type==="turnClosure"}function Oo(i){return i.filter(r=>Se(r)||Me(r)||lr(r)||hr(r)||Ee(r)||je(r))}const So={roadClosure:"SEGMENT",turnClosure:"TURN"};function Qt(i){const r={id:i.state==="INSERT"?null:i.attributes.id,closureType:So[i.type],startDate:new Date(i.attributes.startDate),endDate:new Date(i.attributes.endDate),description:i.attributes.reason,eventId:i.attributes.eventId};switch(i.type){case"roadClosure":return{...r,closureType:"SEGMENT",permanent:i.getAttribute("permanent"),segmentId:i.getAttribute("segID"),forward:i.getAttribute("forward"),nodeClousre:i.getAttribute("fromNodeClosed"),provider:i.getAttribute("provider")};case"turnClosure":return{...r,closureType:"TURN",permanent:!0,fromSegmentId:i.getAttribute("fromSegID"),fromSegmentForward:i.getAttribute("fromSegForward"),toSegmentId:i.getAttribute("toSegID"),toSegmentForward:i.getAttribute("toSegForward"),nodeId:i.getAttribute("nodeConnID")}}}function dr(i,r){return typeof i!=typeof r||typeof i!="object"||!i||!r?!1:Object.keys(i).every(o=>{if(!Object.prototype.hasOwnProperty.call(r,o))return!1;const s=i[o],w=r[o];return dr(s,w)})}function Mo(i,r){return r.some(o=>dr(o,i))}function pr(i,r){return i.length!==r.length?!1:i.every(o=>Mo(o,r))}var Eo=Object.defineProperty,jo=(i,r,o)=>r in i?Eo(i,r,{enumerable:!0,configurable:!0,writable:!0,value:o}):i[r]=o,Xt=(i,r,o)=>jo(i,typeof r!="symbol"?r+"":r,o);let To=class{constructor(i,r){Xt(this,"_target"),Xt(this,"_key"),Xt(this,"_oldValue"),Xt(this,"_wasDefined",!1),Xt(this,"_isSwapped",!1),this._target=i,this._key=r,this._oldValue=this._target[this._key]}get isSwapped(){return this._isSwapped}get originalValue(){return this._oldValue}get value(){return this._target[this._key]}get target(){return this._target}restore(){this.isSwapped&&(this._wasDefined?this._target[this._key]=this._oldValue:delete this._target[this._key],this._isSwapped=!1)}swap(i){this.isSwapped||(this._wasDefined=Object.hasOwn(this._target,this._key),this._oldValue=this._target[this._key]),this._target[this._key]=i,this._isSwapped=!0}};function Te(){return"unsafeWindow"in window?window.unsafeWindow:window}var Io=Object.defineProperty,Po=(i,r,o)=>r in i?Io(i,r,{enumerable:!0,configurable:!0,writable:!0,value:o}):i[r]=o,yr=(i,r,o)=>Po(i,typeof r!="symbol"?r+"":r,o);function te(){return"unsafeWindow"in window?window.unsafeWindow:window}var xo=Object.defineProperty,Ro=(i,r,o)=>r in i?xo(i,r,{enumerable:!0,configurable:!0,writable:!0,value:o}):i[r]=o,zt=(i,r,o)=>Ro(i,typeof r!="symbol"?r+"":r,o);class Ao{constructor(r,o){zt(this,"_target"),zt(this,"_key"),zt(this,"_oldValue"),zt(this,"_wasDefined",!1),zt(this,"_isSwapped",!1),this._target=r,this._key=o,this._oldValue=this._target[this._key]}get isSwapped(){return this._isSwapped}get originalValue(){return this._oldValue}get value(){return this._target[this._key]}get target(){return this._target}restore(){this.isSwapped&&(this._wasDefined?this._target[this._key]=this._oldValue:delete this._target[this._key],this._isSwapped=!1)}swap(r){this.isSwapped||(this._wasDefined=Object.hasOwn(this._target,this._key),this._oldValue=this._target[this._key]),this._target[this._key]=r,this._isSwapped=!0}}class $o{constructor(r,o,s){zt(this,"_enabled",!1),zt(this,"_fnSwapper"),zt(this,"_interceptionFunction"),zt(this,"_middlewares",[]),this._fnSwapper=new Ao(r,o),this._interceptionFunction=s}get enabled(){return this._fnSwapper.isSwapped&&this._enabled}disable(){this._enabled=!1,this.enabled}restore(){this._fnSwapper.restore()}enable(){this._enabled=!0,this._fnSwapper.isSwapped||this.swapToInterceptor()}swapToInterceptor(){const r=this;this._fnSwapper.swap(function(...o){if(!r._enabled)return r.callOriginalInvocator(...o);const s=r.runMiddlewares(o);if(s){if("output"in s)return s.output;"input"in s&&(o=s.input)}return r._interceptionFunction.call(this,r.getOriginalInvocator(this),...o)})}getOriginalInvocator(r){return this._fnSwapper.originalValue.bind(r??this._fnSwapper.target)}callOriginalInvocator(...r){return this.getOriginalInvocator()(...r)}runMiddlewares(r){for(const o of this._middlewares){const s=o(...r);if(s){if("output"in s)return s;"input"in s&&(r=s.input)}}return{input:r}}registerMiddleware(r){this._middlewares.push(r)}}class Do{constructor(r){yr(this,"_fetchInterceptor"),yr(this,"_interceptionFilters",new Set),this._fetchInterceptor=new $o(r,"fetch",(o,s,w)=>{for(const g of this._interceptionFilters)if(g.shouldIntercept(s,w))return this.shouldKeepFilter(g,s,w)||this.removeInterceptionFilter(g),g.intercept(s,w);return o(s,w)})}enable(){this._fetchInterceptor.enable()}disable(){this._fetchInterceptor.disable()}addInterceptionFilter(r){this.enable(),this._interceptionFilters.add(r)}removeInterceptionFilter(r){this._interceptionFilters.delete(r)}shouldKeepFilter(r,o,s){return typeof r.shouldKeep=="function"?r.shouldKeep(o,s):typeof r.shouldKeep=="boolean"?r.shouldKeep:!1}}function Fo(i){return i=i instanceof URL?i:new URL(i,te().location.href),r=>typeof r=="string"?new URL(r,te().location.href).pathname===i.pathname:r instanceof URL?r.pathname===i.pathname:new URL(r.url,te().location.href).pathname===new URL(i,te().location.href).pathname}function Vo(i,r,o){const s=new Response(r,o),w=new URL(i,location.toString());return Object.defineProperty(s,"url",{value:w}),s}function Co(i,r){const o=JSON.stringify(r),s=new Headers({"Content-Type":"application/json"});return Vo(i,o,{headers:s})}const zo=new Do(te());function Ko(){const i=Te(),r=new To(i.W.controller.descartesClient,"createAbortController");r.swap(()=>(r.restore(),new AbortController))}function Wo(i){const r=Te();return Ko(),r.W.controller.descartesClient.getFeatures([0,0,0,0],{[i]:!0},{})}async function wr(i,r){const o=Te().W.Config.paths.features;zo.addInterceptionFilter({shouldIntercept:Fo(o),intercept(){return Promise.resolve(Co(o,{[i]:{objects:[r]}}))}});const{[i]:s}=await Wo(i),[w]=s.objects;return w.constructor}const _r=Symbol("TurnClosure"),vr=Symbol("RoadClosure");function gr(i){const r=i.getFullYear().toString().padStart(2,"4"),o=(i.getMonth()+1).toString().padStart(2,"0"),s=i.getDate().toString().padStart(2,"0"),w=i.getHours().toString().padStart(2,"0"),g=i.getMinutes().toString().padStart(2,"0");return`${r}-${o}-${s} ${w}:${g}`}function No(i){const r=Yt(),o={SEGMENT:"roadClosure",TURN:"turnClosure"};return r.W.model.getRepository(o[i])}function Ho(i,r){const o={id:i.id||No(i.closureType).idGenerator.next(),attributions:null,reason:i.description,startDate:gr(i.startDate),endDate:gr(i.endDate),eventId:i.eventId,externalProvider:null,externalProviderId:null,provider:null,createdBy:null,createdOn:null,updatedBy:null,updatedOn:null,permissions:-1,geometry:null};switch(i.closureType){case"SEGMENT":return new r[vr]({...o,closureType:"SEGMENT",permanent:i.permanent,segID:i.segmentId,forward:i.forward,fromNodeClosed:i.nodeClousre});case"TURN":return new r[_r]({...o,closureType:"TURN",permanent:!0,fromSegID:i.fromSegmentId,fromSegForward:i.fromSegmentForward,toSegID:i.toSegmentId,toSegForward:i.toSegmentForward,nodeConnID:i.nodeId})}}function br(i){return Se(i)?{...Qt(i.closure),id:null}:Me(i)?{...Qt(i.getObject()),id:null}:lr(i)?Qt(i.getObject()):Ee(i)?Qt(i.closure):hr(i)||je(i)?Qt(i.getObject()):null}const Uo=[{async install(){const i=await wr("roadClosures",{});return{[vr]:i}}},{async install(){const i=await wr("turnClosures",{});return{[_r]:i}}},new ur({actionPoint:"closures.save",install:(i,r)=>{const o=Yt(),s=new vo(o.W,async w=>{var g,T;const S=w.getActionsFlat(),j=Oo(S);if(!j.length)return;const{delete:$,set:I}=j.reduce((F,C)=>((Ee(C)||je(C)?F.delete:F.set).push(C),F),{delete:[],set:[]}),E={source:void 0,closures:I.map(br).filter(Boolean),deleteClosures:$.map(br).filter(Boolean)},R=await i(E),A=pr(E.closures,R.closures),W=pr(E.deleteClosures,R.deleteClosures);if(!A&&!W)return;const K=(g=j.find(F=>Se(F)))==null?void 0:g.constructor,P=(T=j.find(F=>Me(F)))==null?void 0:T.constructor;j.forEach(F=>{const C=w.getActionPath(F);C&&(w.removeAction(C),F.undoAction(o.W.model))});const{addClosureActions:V,updateClosureActions:J}=R.closures.reduce((F,C)=>{const q=Yt(),G=Ho(C,r);if(!G)return F;if(!C.id){const Z=(()=>{switch(C.closureType){case"SEGMENT":{if(!K){const pt=q.require("Waze/Action/CreateObject");return new pt(G)}const Y=q.W.model.segments.getObjectById(C.segmentId);return new K(G,Y)}case"TURN":{if(!P){const _t=q.require("Waze/Action/CreateObject");return new _t(G)}const Y=q.W.model.segments.getObjectById(C.fromSegmentId),pt=q.W.model.segments.getObjectById(C.toSegmentId);return new P(G,Y,pt)}default:throw new Error("Unregistered closure factory for closure type "+C.closureType)}})();Z&&F.addClosureActions.push(Z)}const yt=(()=>{const Z=q.W.model.getRepository(C.closureType==="SEGMENT"?"roadClosure":"turnClosure").getObjectById(C.id);if(!Z)return null;const Y=q.require("Waze/Action/UpdateObject");return new Y(Z,G.attributes)})();return yt&&F.updateClosureActions.push(yt),F},{addClosureActions:[],updateClosureActions:[]}),wt=R.deleteClosures.map(F=>{const C=Yt(),q=C.W.model.getRepository(F.closureType==="SEGMENT"?"roadClosure":"turnClosure").getObjectById(F.id);if(!q)return null;const G=C.require("Waze/Action/DeleteObject");return new G(q)});return[new fe(J.filter(Boolean)),new fe(wt.filter(Boolean)),new fe(V.filter(Boolean))].filter(F=>F.actions.length>0)});return s.enable(),()=>{s.disable()}}})],Lo=[{install:({sdk:i})=>({[Oe]:new fo(i)})},new io("Events.registerMiddleware",({artifacts:i})=>(r,o)=>{const s=i[Oe];return s==null?void 0:s.register(r,o)},{isFactory:!0}),wo,...Uo],qo={"Editing.Transactions":{hook:qr},"DataModel.MapComments":{hook:jn},"DataModel.PermanentHazards":{hook:fi},"DataModel.BigJunctions":{hook:Bi},Middlewares:{hook:Lo}};function Ie(i){const[r,o,s]=i.split(".").map(Number);return{major:r,minor:o,patch:s}}function Pe(i,r){return i?r?i.major&&r.major&&i.major!==r.major?i.major-r.major:i.minor&&r.minor&&i.minor!==r.minor?i.minor-r.minor:i.patch&&r.patch&&i.patch!==r.patch?i.patch-r.patch:0:1:-1}function Go(i,r,o="highest"){let s=null;typeof i.highest=="string"&&(i.highest=Ie(i.highest)),typeof i.lowest=="string"&&(i.lowest=Ie(i.lowest));for(const w of r){if(!w.version)continue;if(!s){s=w;continue}if(i.highest&&Pe(w.version,i.highest)>0||i.lowest&&Pe(w.version,i.lowest)<0)continue;const g=w.version,T=s.version,S=Pe(g,T);(o==="highest"&&S>0||o==="lowest"&&S<0)&&(s=w)}if(!s)throw new Error("No matching version found");return s}const Bo={"0.1":i=>{const r=i.constructor;return new r(i.getScriptId(),i.getScriptName())}};function Jo(i){const r=Object.entries(Bo).map(([s,w])=>({version:Ie(s),cloner:w})),{cloner:o}=Go({highest:i.getSDKVersion()},r);return o(i)}const mr=new Mr(qo);async function Zo(i,r={}){if(r.immutable&&(i=Jo(i)),i.State.isInitialized()||await i.Events.once({eventName:"wme-initialized"}),r.hooks)for(const o of r.hooks)await mr.installHook(o,i);else await mr.installAllHooks(i);return i}return Zo}();
