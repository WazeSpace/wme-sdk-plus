var initWmeSdkPlus=function(){"use strict";var kr=Object.defineProperty,Or=(i,r,o)=>r in i?kr(i,r,{enumerable:!0,configurable:!0,writable:!0,value:o}):i[r]=o,lt=(i,r,o)=>Or(i,typeof r!="symbol"?r+"":r,o),xt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Rt={};/*! *****************************************************************************
  Copyright (C) Microsoft. All rights reserved.
  Licensed under the Apache License, Version 2.0 (the "License"); you may not use
  this file except in compliance with the License. You may obtain a copy of the
  License at http://www.apache.org/licenses/LICENSE-2.0

  THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
  WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
  MERCHANTABLITY OR NON-INFRINGEMENT.

  See the Apache Version 2.0 License for specific language governing permissions
  and limitations under the License.
  ***************************************************************************** */var At;function Sr(){if(At)return Rt;At=1;var i;return function(r){(function(o){var s=typeof globalThis=="object"?globalThis:typeof xt=="object"?xt:typeof self=="object"?self:typeof this=="object"?this:E(),w=g(r);typeof s.Reflect<"u"&&(w=g(s.Reflect,w)),o(w,s),typeof s.Reflect>"u"&&(s.Reflect=r);function g($,T){return function(j,R){Object.defineProperty($,j,{configurable:!0,writable:!0,value:R}),T&&T(j,R)}}function I(){try{return Function("return this;")()}catch{}}function S(){try{return(0,eval)("(function() { return this; })()")}catch{}}function E(){return I()||S()}})(function(o,s){var w=Object.prototype.hasOwnProperty,g=typeof Symbol=="function",I=g&&typeof Symbol.toPrimitive<"u"?Symbol.toPrimitive:"@@toPrimitive",S=g&&typeof Symbol.iterator<"u"?Symbol.iterator:"@@iterator",E=typeof Object.create=="function",$={__proto__:[]}instanceof Array,T=!E&&!$,j={create:E?function(){return L(Object.create(null))}:$?function(){return L({__proto__:null})}:function(){return L({})},has:T?function(e,t){return w.call(e,t)}:function(e,t){return t in e},get:T?function(e,t){return w.call(e,t)?e[t]:void 0}:function(e,t){return e[t]}},R=Object.getPrototypeOf(Function),A=typeof Map=="function"&&typeof Map.prototype.entries=="function"?Map:Ie(),W=typeof Set=="function"&&typeof Set.prototype.entries=="function"?Set:Pe(),K=typeof WeakMap=="function"?WeakMap:xe(),P=g?Symbol.for("@reflect-metadata:registry"):void 0,V=Ee(),J=je(V);function we(e,t,n,a){if(d(n)){if(!ae(e))throw new TypeError;if(!se(t))throw new TypeError;return ve(e,t)}else{if(!ae(e))throw new TypeError;if(!b(t))throw new TypeError;if(!b(a)&&!d(a)&&!x(a))throw new TypeError;return x(a)&&(a=void 0),n=M(n),ge(e,t,n,a)}}o("decorate",we);function F(e,t){function n(a,h){if(!b(a))throw new TypeError;if(!d(h)&&!Se(h))throw new TypeError;te(e,t,a,h)}return n}o("metadata",F);function C(e,t,n,a){if(!b(n))throw new TypeError;return d(a)||(a=M(a)),te(e,t,n,a)}o("defineMetadata",C);function q(e,t,n){if(!b(t))throw new TypeError;return d(n)||(n=M(n)),Q(e,t,n)}o("hasMetadata",q);function G(e,t,n){if(!b(t))throw new TypeError;return d(n)||(n=M(n)),N(e,t,n)}o("hasOwnMetadata",G);function ye(e,t,n){if(!b(t))throw new TypeError;return d(n)||(n=M(n)),X(e,t,n)}o("getMetadata",ye);function Z(e,t,n){if(!b(t))throw new TypeError;return d(n)||(n=M(n)),ee(e,t,n)}o("getOwnMetadata",Z);function Y(e,t){if(!b(e))throw new TypeError;return d(t)||(t=M(t)),re(e,t)}o("getMetadataKeys",Y);function pe(e,t){if(!b(e))throw new TypeError;return d(t)||(t=M(t)),ne(e,t)}o("getOwnMetadataKeys",pe);function _e(e,t,n){if(!b(t))throw new TypeError;if(d(n)||(n=M(n)),!b(t))throw new TypeError;d(n)||(n=M(n));var a=D(t,n,!1);return d(a)?!1:a.OrdinaryDeleteMetadata(e,t,n)}o("deleteMetadata",_e);function ve(e,t){for(var n=e.length-1;n>=0;--n){var a=e[n],h=a(t);if(!d(h)&&!x(h)){if(!se(h))throw new TypeError;t=h}}return t}function ge(e,t,n,a){for(var h=e.length-1;h>=0;--h){var k=e[h],m=k(t,n,a);if(!d(m)&&!x(m)){if(!b(m))throw new TypeError;a=m}}return a}function Q(e,t,n){var a=N(e,t,n);if(a)return!0;var h=U(t);return x(h)?!1:Q(e,h,n)}function N(e,t,n){var a=D(t,n,!1);return d(a)?!1:oe(a.OrdinaryHasOwnMetadata(e,t,n))}function X(e,t,n){var a=N(e,t,n);if(a)return ee(e,t,n);var h=U(t);if(!x(h))return X(e,h,n)}function ee(e,t,n){var a=D(t,n,!1);if(!d(a))return a.OrdinaryGetOwnMetadata(e,t,n)}function te(e,t,n,a){var h=D(n,a,!0);h.OrdinaryDefineOwnMetadata(e,t,n,a)}function re(e,t){var n=ne(e,t),a=U(e);if(a===null)return n;var h=re(a,t);if(h.length<=0)return n;if(n.length<=0)return h;for(var k=new W,m=[],p=0,u=n;p<u.length;p++){var c=u[p],f=k.has(c);f||(k.add(c),m.push(c))}for(var l=0,y=h;l<y.length;l++){var c=y[l],f=k.has(c);f||(k.add(c),m.push(c))}return m}function ne(e,t){var n=D(e,t,!1);return n?n.OrdinaryOwnMetadataKeys(e,t):[]}function ie(e){if(e===null)return 1;switch(typeof e){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return e===null?1:6;default:return 6}}function d(e){return e===void 0}function x(e){return e===null}function be(e){return typeof e=="symbol"}function b(e){return typeof e=="object"?e!==null:typeof e=="function"}function me(e,t){switch(ie(e)){case 0:return e;case 1:return e;case 2:return e;case 3:return e;case 4:return e;case 5:return e}var n="string",a=ue(e,I);if(a!==void 0){var h=a.call(e,n);if(b(h))throw new TypeError;return h}return ke(e)}function ke(e,t){var n,a;{var h=e.toString;if(z(h)){var a=h.call(e);if(!b(a))return a}var n=e.valueOf;if(z(n)){var a=n.call(e);if(!b(a))return a}}throw new TypeError}function oe(e){return!!e}function Oe(e){return""+e}function M(e){var t=me(e);return be(t)?t:Oe(t)}function ae(e){return Array.isArray?Array.isArray(e):e instanceof Object?e instanceof Array:Object.prototype.toString.call(e)==="[object Array]"}function z(e){return typeof e=="function"}function se(e){return typeof e=="function"}function Se(e){switch(ie(e)){case 3:return!0;case 4:return!0;default:return!1}}function H(e,t){return e===t||e!==e&&t!==t}function ue(e,t){var n=e[t];if(n!=null){if(!z(n))throw new TypeError;return n}}function ce(e){var t=ue(e,S);if(!z(t))throw new TypeError;var n=t.call(e);if(!b(n))throw new TypeError;return n}function fe(e){return e.value}function le(e){var t=e.next();return t.done?!1:t}function he(e){var t=e.return;t&&t.call(e)}function U(e){var t=Object.getPrototypeOf(e);if(typeof e!="function"||e===R||t!==R)return t;var n=e.prototype,a=n&&Object.getPrototypeOf(n);if(a==null||a===Object.prototype)return t;var h=a.constructor;return typeof h!="function"||h===e?t:h}function Me(){var e;!d(P)&&typeof s.Reflect<"u"&&!(P in s.Reflect)&&typeof s.Reflect.defineMetadata=="function"&&(e=Te(s.Reflect));var t,n,a,h=new K,k={registerProvider:m,getProvider:u,setProvider:f};return k;function m(l){if(!Object.isExtensible(k))throw new Error("Cannot add provider to a frozen registry.");switch(!0){case e===l:break;case d(t):t=l;break;case t===l:break;case d(n):n=l;break;case n===l:break;default:a===void 0&&(a=new W),a.add(l);break}}function p(l,y){if(!d(t)){if(t.isProviderFor(l,y))return t;if(!d(n)){if(n.isProviderFor(l,y))return t;if(!d(a))for(var _=ce(a);;){var v=le(_);if(!v)return;var O=fe(v);if(O.isProviderFor(l,y))return he(_),O}}}if(!d(e)&&e.isProviderFor(l,y))return e}function u(l,y){var _=h.get(l),v;return d(_)||(v=_.get(y)),d(v)&&(v=p(l,y),d(v)||(d(_)&&(_=new A,h.set(l,_)),_.set(y,v))),v}function c(l){if(d(l))throw new TypeError;return t===l||n===l||!d(a)&&a.has(l)}function f(l,y,_){if(!c(_))throw new Error("Metadata provider not registered.");var v=u(l,y);if(v!==_){if(!d(v))return!1;var O=h.get(l);d(O)&&(O=new A,h.set(l,O)),O.set(y,_)}return!0}}function Ee(){var e;return!d(P)&&b(s.Reflect)&&Object.isExtensible(s.Reflect)&&(e=s.Reflect[P]),d(e)&&(e=Me()),!d(P)&&b(s.Reflect)&&Object.isExtensible(s.Reflect)&&Object.defineProperty(s.Reflect,P,{enumerable:!1,configurable:!1,writable:!1,value:e}),e}function je(e){var t=new K,n={isProviderFor:function(c,f){var l=t.get(c);return d(l)?!1:l.has(f)},OrdinaryDefineOwnMetadata:m,OrdinaryHasOwnMetadata:h,OrdinaryGetOwnMetadata:k,OrdinaryOwnMetadataKeys:p,OrdinaryDeleteMetadata:u};return V.registerProvider(n),n;function a(c,f,l){var y=t.get(c),_=!1;if(d(y)){if(!l)return;y=new A,t.set(c,y),_=!0}var v=y.get(f);if(d(v)){if(!l)return;if(v=new A,y.set(f,v),!e.setProvider(c,f,n))throw y.delete(f),_&&t.delete(c),new Error("Wrong provider for target.")}return v}function h(c,f,l){var y=a(f,l,!1);return d(y)?!1:oe(y.has(c))}function k(c,f,l){var y=a(f,l,!1);if(!d(y))return y.get(c)}function m(c,f,l,y){var _=a(l,y,!0);_.set(c,f)}function p(c,f){var l=[],y=a(c,f,!1);if(d(y))return l;for(var _=y.keys(),v=ce(_),O=0;;){var de=le(v);if(!de)return l.length=O,l;var Re=fe(de);try{l[O]=Re}catch(Ae){try{he(v)}finally{throw Ae}}O++}}function u(c,f,l){var y=a(f,l,!1);if(d(y)||!y.delete(c))return!1;if(y.size===0){var _=t.get(f);d(_)||(_.delete(l),_.size===0&&t.delete(_))}return!0}}function Te(e){var t=e.defineMetadata,n=e.hasOwnMetadata,a=e.getOwnMetadata,h=e.getOwnMetadataKeys,k=e.deleteMetadata,m=new K,p={isProviderFor:function(u,c){var f=m.get(u);return!d(f)&&f.has(c)?!0:h(u,c).length?(d(f)&&(f=new W,m.set(u,f)),f.add(c),!0):!1},OrdinaryDefineOwnMetadata:t,OrdinaryHasOwnMetadata:n,OrdinaryGetOwnMetadata:a,OrdinaryOwnMetadataKeys:h,OrdinaryDeleteMetadata:k};return p}function D(e,t,n){var a=V.getProvider(e,t);if(!d(a))return a;if(n){if(V.setProvider(e,t,J))return J;throw new Error("Illegal state.")}}function Ie(){var e={},t=[],n=function(){function p(u,c,f){this._index=0,this._keys=u,this._values=c,this._selector=f}return p.prototype["@@iterator"]=function(){return this},p.prototype[S]=function(){return this},p.prototype.next=function(){var u=this._index;if(u>=0&&u<this._keys.length){var c=this._selector(this._keys[u],this._values[u]);return u+1>=this._keys.length?(this._index=-1,this._keys=t,this._values=t):this._index++,{value:c,done:!1}}return{value:void 0,done:!0}},p.prototype.throw=function(u){throw this._index>=0&&(this._index=-1,this._keys=t,this._values=t),u},p.prototype.return=function(u){return this._index>=0&&(this._index=-1,this._keys=t,this._values=t),{value:u,done:!0}},p}(),a=function(){function p(){this._keys=[],this._values=[],this._cacheKey=e,this._cacheIndex=-2}return Object.defineProperty(p.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),p.prototype.has=function(u){return this._find(u,!1)>=0},p.prototype.get=function(u){var c=this._find(u,!1);return c>=0?this._values[c]:void 0},p.prototype.set=function(u,c){var f=this._find(u,!0);return this._values[f]=c,this},p.prototype.delete=function(u){var c=this._find(u,!1);if(c>=0){for(var f=this._keys.length,l=c+1;l<f;l++)this._keys[l-1]=this._keys[l],this._values[l-1]=this._values[l];return this._keys.length--,this._values.length--,H(u,this._cacheKey)&&(this._cacheKey=e,this._cacheIndex=-2),!0}return!1},p.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=e,this._cacheIndex=-2},p.prototype.keys=function(){return new n(this._keys,this._values,h)},p.prototype.values=function(){return new n(this._keys,this._values,k)},p.prototype.entries=function(){return new n(this._keys,this._values,m)},p.prototype["@@iterator"]=function(){return this.entries()},p.prototype[S]=function(){return this.entries()},p.prototype._find=function(u,c){if(!H(this._cacheKey,u)){this._cacheIndex=-1;for(var f=0;f<this._keys.length;f++)if(H(this._keys[f],u)){this._cacheIndex=f;break}}return this._cacheIndex<0&&c&&(this._cacheIndex=this._keys.length,this._keys.push(u),this._values.push(void 0)),this._cacheIndex},p}();return a;function h(p,u){return p}function k(p,u){return u}function m(p,u){return[p,u]}}function Pe(){var e=function(){function t(){this._map=new A}return Object.defineProperty(t.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),t.prototype.has=function(n){return this._map.has(n)},t.prototype.add=function(n){return this._map.set(n,n),this},t.prototype.delete=function(n){return this._map.delete(n)},t.prototype.clear=function(){this._map.clear()},t.prototype.keys=function(){return this._map.keys()},t.prototype.values=function(){return this._map.keys()},t.prototype.entries=function(){return this._map.entries()},t.prototype["@@iterator"]=function(){return this.keys()},t.prototype[S]=function(){return this.keys()},t}();return e}function xe(){var e=16,t=j.create(),n=a();return function(){function u(){this._key=a()}return u.prototype.has=function(c){var f=h(c,!1);return f!==void 0?j.has(f,this._key):!1},u.prototype.get=function(c){var f=h(c,!1);return f!==void 0?j.get(f,this._key):void 0},u.prototype.set=function(c,f){var l=h(c,!0);return l[this._key]=f,this},u.prototype.delete=function(c){var f=h(c,!1);return f!==void 0?delete f[this._key]:!1},u.prototype.clear=function(){this._key=a()},u}();function a(){var u;do u="@@WeakMap@@"+p();while(j.has(t,u));return t[u]=!0,u}function h(u,c){if(!w.call(u,n)){if(!c)return;Object.defineProperty(u,n,{value:j.create()})}return u[n]}function k(u,c){for(var f=0;f<c;++f)u[f]=Math.random()*255|0;return u}function m(u){if(typeof Uint8Array=="function"){var c=new Uint8Array(u);return typeof crypto<"u"?crypto.getRandomValues(c):typeof msCrypto<"u"?msCrypto.getRandomValues(c):k(c,u),c}return k(new Array(u),u)}function p(){var u=m(e);u[6]=u[6]&79|64,u[8]=u[8]&191|128;for(var c="",f=0;f<e;++f){var l=u[f];(f===4||f===6||f===8)&&(c+="-"),l<16&&(c+="0"),c+=l.toString(16).toLowerCase()}return c}}function L(e){return e.__=void 0,delete e.__,e}})}(i||(i={})),Rt}Sr();const ht=Symbol("ARTIFACTS");let Mr=class{constructor(r){lt(this,"_recognizableHooks",new Map),lt(this,"_hookDependencies",new Map),lt(this,"_installedHooks",new Map);for(const[o,{hook:s,deps:w}]of Object.entries(r))this._recognizableHooks.set(o,s),w&&this._hookDependencies.set(o,w||[])}isHookInstalled(r,o){const s=this._recognizableHooks.get(o);if(!s||!this._installedHooks.has(r))return!1;const w=this._installedHooks.get(r);return w?w.some(g=>g===s):!1}markHookAsInstalled(r,o){var s;const w=this._recognizableHooks.get(o);if(!w)throw new Error(`Hook ${o} not found`);this._installedHooks.has(r)||this._installedHooks.set(r,[]),(s=this._installedHooks.get(r))==null||s.push(w)}async installHook(r,o){const s=this._recognizableHooks.get(r);if(!s)throw new Error(`Hook ${r} not found`);if(this.isHookInstalled(o,r))return;const w=this._hookDependencies.get(r)||[];for(const I of w)await this.installHook(I,o);const g=Reflect.getMetadata(ht,o)||{};Reflect.hasMetadata(ht,o)||Reflect.defineMetadata(ht,g,o);for(const I of s){const S=await I.install({sdk:o,artifacts:g});!S||typeof S!="object"||Object.assign(g,S)}this.markHookAsInstalled(o,r)}async installAllHooks(r){for(const o of this._recognizableHooks.keys())await this.installHook(o,r)}};var Er=Object.defineProperty,jr=(i,r,o)=>r in i?Er(i,r,{enumerable:!0,configurable:!0,writable:!0,value:o}):i[r]=o,Ke=(i,r,o)=>jr(i,typeof r!="symbol"?r+"":r,o),Tr=Object.defineProperty,Ir=(i,r,o)=>r in i?Tr(i,r,{enumerable:!0,configurable:!0,writable:!0,value:o}):i[r]=o,tt=(i,r,o)=>Ir(i,typeof r!="symbol"?r+"":r,o),$t=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Dt={};/*! *****************************************************************************
  Copyright (C) Microsoft. All rights reserved.
  Licensed under the Apache License, Version 2.0 (the "License"); you may not use
  this file except in compliance with the License. You may obtain a copy of the
  License at http://www.apache.org/licenses/LICENSE-2.0

  THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
  WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
  MERCHANTABLITY OR NON-INFRINGEMENT.

  See the Apache Version 2.0 License for specific language governing permissions
  and limitations under the License.
  ***************************************************************************** */var Ft;function Pr(){if(Ft)return Dt;Ft=1;var i;return function(r){(function(o){var s=typeof globalThis=="object"?globalThis:typeof $t=="object"?$t:typeof self=="object"?self:typeof this=="object"?this:E(),w=g(r);typeof s.Reflect<"u"&&(w=g(s.Reflect,w)),o(w,s),typeof s.Reflect>"u"&&(s.Reflect=r);function g($,T){return function(j,R){Object.defineProperty($,j,{configurable:!0,writable:!0,value:R}),T&&T(j,R)}}function I(){try{return Function("return this;")()}catch{}}function S(){try{return(0,eval)("(function() { return this; })()")}catch{}}function E(){return I()||S()}})(function(o,s){var w=Object.prototype.hasOwnProperty,g=typeof Symbol=="function",I=g&&typeof Symbol.toPrimitive<"u"?Symbol.toPrimitive:"@@toPrimitive",S=g&&typeof Symbol.iterator<"u"?Symbol.iterator:"@@iterator",E=typeof Object.create=="function",$={__proto__:[]}instanceof Array,T=!E&&!$,j={create:E?function(){return L(Object.create(null))}:$?function(){return L({__proto__:null})}:function(){return L({})},has:T?function(e,t){return w.call(e,t)}:function(e,t){return t in e},get:T?function(e,t){return w.call(e,t)?e[t]:void 0}:function(e,t){return e[t]}},R=Object.getPrototypeOf(Function),A=typeof Map=="function"&&typeof Map.prototype.entries=="function"?Map:Ie(),W=typeof Set=="function"&&typeof Set.prototype.entries=="function"?Set:Pe(),K=typeof WeakMap=="function"?WeakMap:xe(),P=g?Symbol.for("@reflect-metadata:registry"):void 0,V=Ee(),J=je(V);function we(e,t,n,a){if(d(n)){if(!ae(e))throw new TypeError;if(!se(t))throw new TypeError;return ve(e,t)}else{if(!ae(e))throw new TypeError;if(!b(t))throw new TypeError;if(!b(a)&&!d(a)&&!x(a))throw new TypeError;return x(a)&&(a=void 0),n=M(n),ge(e,t,n,a)}}o("decorate",we);function F(e,t){function n(a,h){if(!b(a))throw new TypeError;if(!d(h)&&!Se(h))throw new TypeError;te(e,t,a,h)}return n}o("metadata",F);function C(e,t,n,a){if(!b(n))throw new TypeError;return d(a)||(a=M(a)),te(e,t,n,a)}o("defineMetadata",C);function q(e,t,n){if(!b(t))throw new TypeError;return d(n)||(n=M(n)),Q(e,t,n)}o("hasMetadata",q);function G(e,t,n){if(!b(t))throw new TypeError;return d(n)||(n=M(n)),N(e,t,n)}o("hasOwnMetadata",G);function ye(e,t,n){if(!b(t))throw new TypeError;return d(n)||(n=M(n)),X(e,t,n)}o("getMetadata",ye);function Z(e,t,n){if(!b(t))throw new TypeError;return d(n)||(n=M(n)),ee(e,t,n)}o("getOwnMetadata",Z);function Y(e,t){if(!b(e))throw new TypeError;return d(t)||(t=M(t)),re(e,t)}o("getMetadataKeys",Y);function pe(e,t){if(!b(e))throw new TypeError;return d(t)||(t=M(t)),ne(e,t)}o("getOwnMetadataKeys",pe);function _e(e,t,n){if(!b(t))throw new TypeError;if(d(n)||(n=M(n)),!b(t))throw new TypeError;d(n)||(n=M(n));var a=D(t,n,!1);return d(a)?!1:a.OrdinaryDeleteMetadata(e,t,n)}o("deleteMetadata",_e);function ve(e,t){for(var n=e.length-1;n>=0;--n){var a=e[n],h=a(t);if(!d(h)&&!x(h)){if(!se(h))throw new TypeError;t=h}}return t}function ge(e,t,n,a){for(var h=e.length-1;h>=0;--h){var k=e[h],m=k(t,n,a);if(!d(m)&&!x(m)){if(!b(m))throw new TypeError;a=m}}return a}function Q(e,t,n){var a=N(e,t,n);if(a)return!0;var h=U(t);return x(h)?!1:Q(e,h,n)}function N(e,t,n){var a=D(t,n,!1);return d(a)?!1:oe(a.OrdinaryHasOwnMetadata(e,t,n))}function X(e,t,n){var a=N(e,t,n);if(a)return ee(e,t,n);var h=U(t);if(!x(h))return X(e,h,n)}function ee(e,t,n){var a=D(t,n,!1);if(!d(a))return a.OrdinaryGetOwnMetadata(e,t,n)}function te(e,t,n,a){var h=D(n,a,!0);h.OrdinaryDefineOwnMetadata(e,t,n,a)}function re(e,t){var n=ne(e,t),a=U(e);if(a===null)return n;var h=re(a,t);if(h.length<=0)return n;if(n.length<=0)return h;for(var k=new W,m=[],p=0,u=n;p<u.length;p++){var c=u[p],f=k.has(c);f||(k.add(c),m.push(c))}for(var l=0,y=h;l<y.length;l++){var c=y[l],f=k.has(c);f||(k.add(c),m.push(c))}return m}function ne(e,t){var n=D(e,t,!1);return n?n.OrdinaryOwnMetadataKeys(e,t):[]}function ie(e){if(e===null)return 1;switch(typeof e){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return e===null?1:6;default:return 6}}function d(e){return e===void 0}function x(e){return e===null}function be(e){return typeof e=="symbol"}function b(e){return typeof e=="object"?e!==null:typeof e=="function"}function me(e,t){switch(ie(e)){case 0:return e;case 1:return e;case 2:return e;case 3:return e;case 4:return e;case 5:return e}var n="string",a=ue(e,I);if(a!==void 0){var h=a.call(e,n);if(b(h))throw new TypeError;return h}return ke(e)}function ke(e,t){var n,a;{var h=e.toString;if(z(h)){var a=h.call(e);if(!b(a))return a}var n=e.valueOf;if(z(n)){var a=n.call(e);if(!b(a))return a}}throw new TypeError}function oe(e){return!!e}function Oe(e){return""+e}function M(e){var t=me(e);return be(t)?t:Oe(t)}function ae(e){return Array.isArray?Array.isArray(e):e instanceof Object?e instanceof Array:Object.prototype.toString.call(e)==="[object Array]"}function z(e){return typeof e=="function"}function se(e){return typeof e=="function"}function Se(e){switch(ie(e)){case 3:return!0;case 4:return!0;default:return!1}}function H(e,t){return e===t||e!==e&&t!==t}function ue(e,t){var n=e[t];if(n!=null){if(!z(n))throw new TypeError;return n}}function ce(e){var t=ue(e,S);if(!z(t))throw new TypeError;var n=t.call(e);if(!b(n))throw new TypeError;return n}function fe(e){return e.value}function le(e){var t=e.next();return t.done?!1:t}function he(e){var t=e.return;t&&t.call(e)}function U(e){var t=Object.getPrototypeOf(e);if(typeof e!="function"||e===R||t!==R)return t;var n=e.prototype,a=n&&Object.getPrototypeOf(n);if(a==null||a===Object.prototype)return t;var h=a.constructor;return typeof h!="function"||h===e?t:h}function Me(){var e;!d(P)&&typeof s.Reflect<"u"&&!(P in s.Reflect)&&typeof s.Reflect.defineMetadata=="function"&&(e=Te(s.Reflect));var t,n,a,h=new K,k={registerProvider:m,getProvider:u,setProvider:f};return k;function m(l){if(!Object.isExtensible(k))throw new Error("Cannot add provider to a frozen registry.");switch(!0){case e===l:break;case d(t):t=l;break;case t===l:break;case d(n):n=l;break;case n===l:break;default:a===void 0&&(a=new W),a.add(l);break}}function p(l,y){if(!d(t)){if(t.isProviderFor(l,y))return t;if(!d(n)){if(n.isProviderFor(l,y))return t;if(!d(a))for(var _=ce(a);;){var v=le(_);if(!v)return;var O=fe(v);if(O.isProviderFor(l,y))return he(_),O}}}if(!d(e)&&e.isProviderFor(l,y))return e}function u(l,y){var _=h.get(l),v;return d(_)||(v=_.get(y)),d(v)&&(v=p(l,y),d(v)||(d(_)&&(_=new A,h.set(l,_)),_.set(y,v))),v}function c(l){if(d(l))throw new TypeError;return t===l||n===l||!d(a)&&a.has(l)}function f(l,y,_){if(!c(_))throw new Error("Metadata provider not registered.");var v=u(l,y);if(v!==_){if(!d(v))return!1;var O=h.get(l);d(O)&&(O=new A,h.set(l,O)),O.set(y,_)}return!0}}function Ee(){var e;return!d(P)&&b(s.Reflect)&&Object.isExtensible(s.Reflect)&&(e=s.Reflect[P]),d(e)&&(e=Me()),!d(P)&&b(s.Reflect)&&Object.isExtensible(s.Reflect)&&Object.defineProperty(s.Reflect,P,{enumerable:!1,configurable:!1,writable:!1,value:e}),e}function je(e){var t=new K,n={isProviderFor:function(c,f){var l=t.get(c);return d(l)?!1:l.has(f)},OrdinaryDefineOwnMetadata:m,OrdinaryHasOwnMetadata:h,OrdinaryGetOwnMetadata:k,OrdinaryOwnMetadataKeys:p,OrdinaryDeleteMetadata:u};return V.registerProvider(n),n;function a(c,f,l){var y=t.get(c),_=!1;if(d(y)){if(!l)return;y=new A,t.set(c,y),_=!0}var v=y.get(f);if(d(v)){if(!l)return;if(v=new A,y.set(f,v),!e.setProvider(c,f,n))throw y.delete(f),_&&t.delete(c),new Error("Wrong provider for target.")}return v}function h(c,f,l){var y=a(f,l,!1);return d(y)?!1:oe(y.has(c))}function k(c,f,l){var y=a(f,l,!1);if(!d(y))return y.get(c)}function m(c,f,l,y){var _=a(l,y,!0);_.set(c,f)}function p(c,f){var l=[],y=a(c,f,!1);if(d(y))return l;for(var _=y.keys(),v=ce(_),O=0;;){var de=le(v);if(!de)return l.length=O,l;var Re=fe(de);try{l[O]=Re}catch(Ae){try{he(v)}finally{throw Ae}}O++}}function u(c,f,l){var y=a(f,l,!1);if(d(y)||!y.delete(c))return!1;if(y.size===0){var _=t.get(f);d(_)||(_.delete(l),_.size===0&&t.delete(_))}return!0}}function Te(e){var t=e.defineMetadata,n=e.hasOwnMetadata,a=e.getOwnMetadata,h=e.getOwnMetadataKeys,k=e.deleteMetadata,m=new K,p={isProviderFor:function(u,c){var f=m.get(u);return!d(f)&&f.has(c)?!0:h(u,c).length?(d(f)&&(f=new W,m.set(u,f)),f.add(c),!0):!1},OrdinaryDefineOwnMetadata:t,OrdinaryHasOwnMetadata:n,OrdinaryGetOwnMetadata:a,OrdinaryOwnMetadataKeys:h,OrdinaryDeleteMetadata:k};return p}function D(e,t,n){var a=V.getProvider(e,t);if(!d(a))return a;if(n){if(V.setProvider(e,t,J))return J;throw new Error("Illegal state.")}}function Ie(){var e={},t=[],n=function(){function p(u,c,f){this._index=0,this._keys=u,this._values=c,this._selector=f}return p.prototype["@@iterator"]=function(){return this},p.prototype[S]=function(){return this},p.prototype.next=function(){var u=this._index;if(u>=0&&u<this._keys.length){var c=this._selector(this._keys[u],this._values[u]);return u+1>=this._keys.length?(this._index=-1,this._keys=t,this._values=t):this._index++,{value:c,done:!1}}return{value:void 0,done:!0}},p.prototype.throw=function(u){throw this._index>=0&&(this._index=-1,this._keys=t,this._values=t),u},p.prototype.return=function(u){return this._index>=0&&(this._index=-1,this._keys=t,this._values=t),{value:u,done:!0}},p}(),a=function(){function p(){this._keys=[],this._values=[],this._cacheKey=e,this._cacheIndex=-2}return Object.defineProperty(p.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),p.prototype.has=function(u){return this._find(u,!1)>=0},p.prototype.get=function(u){var c=this._find(u,!1);return c>=0?this._values[c]:void 0},p.prototype.set=function(u,c){var f=this._find(u,!0);return this._values[f]=c,this},p.prototype.delete=function(u){var c=this._find(u,!1);if(c>=0){for(var f=this._keys.length,l=c+1;l<f;l++)this._keys[l-1]=this._keys[l],this._values[l-1]=this._values[l];return this._keys.length--,this._values.length--,H(u,this._cacheKey)&&(this._cacheKey=e,this._cacheIndex=-2),!0}return!1},p.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=e,this._cacheIndex=-2},p.prototype.keys=function(){return new n(this._keys,this._values,h)},p.prototype.values=function(){return new n(this._keys,this._values,k)},p.prototype.entries=function(){return new n(this._keys,this._values,m)},p.prototype["@@iterator"]=function(){return this.entries()},p.prototype[S]=function(){return this.entries()},p.prototype._find=function(u,c){if(!H(this._cacheKey,u)){this._cacheIndex=-1;for(var f=0;f<this._keys.length;f++)if(H(this._keys[f],u)){this._cacheIndex=f;break}}return this._cacheIndex<0&&c&&(this._cacheIndex=this._keys.length,this._keys.push(u),this._values.push(void 0)),this._cacheIndex},p}();return a;function h(p,u){return p}function k(p,u){return u}function m(p,u){return[p,u]}}function Pe(){var e=function(){function t(){this._map=new A}return Object.defineProperty(t.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),t.prototype.has=function(n){return this._map.has(n)},t.prototype.add=function(n){return this._map.set(n,n),this},t.prototype.delete=function(n){return this._map.delete(n)},t.prototype.clear=function(){this._map.clear()},t.prototype.keys=function(){return this._map.keys()},t.prototype.values=function(){return this._map.keys()},t.prototype.entries=function(){return this._map.entries()},t.prototype["@@iterator"]=function(){return this.keys()},t.prototype[S]=function(){return this.keys()},t}();return e}function xe(){var e=16,t=j.create(),n=a();return function(){function u(){this._key=a()}return u.prototype.has=function(c){var f=h(c,!1);return f!==void 0?j.has(f,this._key):!1},u.prototype.get=function(c){var f=h(c,!1);return f!==void 0?j.get(f,this._key):void 0},u.prototype.set=function(c,f){var l=h(c,!0);return l[this._key]=f,this},u.prototype.delete=function(c){var f=h(c,!1);return f!==void 0?delete f[this._key]:!1},u.prototype.clear=function(){this._key=a()},u}();function a(){var u;do u="@@WeakMap@@"+p();while(j.has(t,u));return t[u]=!0,u}function h(u,c){if(!w.call(u,n)){if(!c)return;Object.defineProperty(u,n,{value:j.create()})}return u[n]}function k(u,c){for(var f=0;f<c;++f)u[f]=Math.random()*255|0;return u}function m(u){if(typeof Uint8Array=="function"){var c=new Uint8Array(u);return typeof crypto<"u"?crypto.getRandomValues(c):typeof msCrypto<"u"?msCrypto.getRandomValues(c):k(c,u),c}return k(new Array(u),u)}function p(){var u=m(e);u[6]=u[6]&79|64,u[8]=u[8]&191|128;for(var c="",f=0;f<e;++f){var l=u[f];(f===4||f===6||f===8)&&(c+="-"),l<16&&(c+="0"),c+=l.toString(16).toLowerCase()}return c}}function L(e){return e.__=void 0,delete e.__,e}})}(i||(i={})),Dt}Pr();var xr=Object.defineProperty,Rr=(i,r,o)=>r in i?xr(i,r,{enumerable:!0,configurable:!0,writable:!0,value:o}):i[r]=o,We=(i,r,o)=>Rr(i,typeof r!="symbol"?r+"":r,o);let Ar=class{constructor(r,o){We(this,"_target"),We(this,"_key"),We(this,"_oldValue"),We(this,"_wasDefined",!1),We(this,"_isSwapped",!1),this._target=r,this._key=o,this._oldValue=this._target[this._key]}get isSwapped(){return this._isSwapped}get originalValue(){return this._oldValue}get value(){return this._target[this._key]}get target(){return this._target}restore(){this.isSwapped&&(this._wasDefined?this._target[this._key]=this._oldValue:delete this._target[this._key],this._isSwapped=!1)}swap(r){this.isSwapped||(this._wasDefined=Object.hasOwn(this._target,this._key),this._oldValue=this._target[this._key]),this._target[this._key]=r,this._isSwapped=!0}};const $r={onlyIfNotExists:!0,isFactory:!1};class rt{constructor(r,o,s={}){if(tt(this,"_installedInstances",new Map),tt(this,"_path"),tt(this,"_targetValue"),tt(this,"_options"),this._path=r.split("."),this._path.length===0)throw new Error("Path must not be empty");this._targetValue=o,this._options={...$r,...s}}_getTargetObject(r){let o=r;for(const s of this._path.slice(0,this._path.length-1))o[s]||(o[s]={}),o=o[s];return o}_createSwapper(r){const o=this._getTargetObject(r);return new Ar(o,this._path.at(-1))}install({sdk:r,...o}){if(this._installedInstances.has(r))return;const s=this._createSwapper(r);if(!(s.value&&this._options.onlyIfNotExists)){if(this._options.isFactory&&typeof this._targetValue=="function"){const w=this._targetValue({sdk:r,...o});s.swap(w)}else s.swap(this._targetValue);this._installedInstances.set(r,s)}}uninstall({sdk:r}){const o=this._installedInstances.get(r);o&&(o.restore(),this._installedInstances.delete(r))}}function Vt(){return"unsafeWindow"in window?window.unsafeWindow:window}var Dr=Object.defineProperty,Fr=(i,r,o)=>r in i?Dr(i,r,{enumerable:!0,configurable:!0,writable:!0,value:o}):i[r]=o,$e=(i,r,o)=>Fr(i,typeof r!="symbol"?r+"":r,o);class Vr{constructor(r,o){$e(this,"_target"),$e(this,"_key"),$e(this,"_oldValue"),$e(this,"_wasDefined",!1),$e(this,"_isSwapped",!1),this._target=r,this._key=o,this._oldValue=this._target[this._key]}get isSwapped(){return this._isSwapped}get originalValue(){return this._oldValue}get value(){return this._target[this._key]}get target(){return this._target}restore(){this.isSwapped&&(this._wasDefined?this._target[this._key]=this._oldValue:delete this._target[this._key],this._isSwapped=!1)}swap(r){this.isSwapped||(this._wasDefined=Object.hasOwn(this._target,this._key),this._oldValue=this._target[this._key]),this._target[this._key]=r,this._isSwapped=!0}}let dt=class{constructor(r,o,s){$e(this,"_enabled",!1),$e(this,"_fnSwapper"),$e(this,"_interceptionFunction"),$e(this,"_middlewares",[]),this._fnSwapper=new Vr(r,o),this._interceptionFunction=s}get enabled(){return this._fnSwapper.isSwapped&&this._enabled}disable(){this._enabled=!1,this.enabled}restore(){this._fnSwapper.restore()}enable(){this._enabled=!0,this._fnSwapper.isSwapped||this.swapToInterceptor()}swapToInterceptor(){const r=this;this._fnSwapper.swap(function(...o){if(!r._enabled)return r.callOriginalInvocator(...o);const s=r.runMiddlewares(o);if(s){if("output"in s)return s.output;"input"in s&&(o=s.input)}return r._interceptionFunction.call(this,r.getOriginalInvocator(this),...o)})}getOriginalInvocator(r){return this._fnSwapper.originalValue.bind(r??this._fnSwapper.target)}callOriginalInvocator(...r){return this.getOriginalInvocator()(...r)}runMiddlewares(r){for(const o of this._middlewares){const s=o(...r);if(s){if("output"in s)return s;"input"in s&&(r=s.input)}}return{input:r}}registerMiddleware(r){this._middlewares.push(r)}};function Cr(i,r){try{return i()}catch{return r}}let zr=class extends dt{constructor(r,o,s){super(r,o,s),$e(this,"_loggedInvocationRequests",[]),this.registerMiddleware((...w)=>this.logRequest(...w))}logRequest(...r){this._loggedInvocationRequests.push(r)}flushLoggedRequests(){const r=this.getLoggedRequests();return this._loggedInvocationRequests=[],r}getLoggedRequests(){return this._loggedInvocationRequests}executeOriginalLoggedRequests(){this.flushLoggedRequests().forEach(r=>Cr(()=>this.callOriginalInvocator(...r)))}},Kr=class{constructor(){Ke(this,"_hasResult",!1),Ke(this,"result")}store(r){return this.result=r,this._hasResult=!0,r}clear(){this.result=void 0,this._hasResult=!1}getResult(){if(!this.hasResult)throw new Error("No result is stored");return this.result}get hasResult(){return this._hasResult}};function Wr(i){const r=new Kr;new dt(i,"doAction",(o,...s)=>r.hasResult?r.getResult():r.store(o(...s))).enable(),new dt(i,"undoAction",(o,...s)=>{const w=o(...s);return r.clear(),w}).enable()}let Nr=class{constructor(){Ke(this,"actions",[]),Ke(this,"undoableActions",[])}acceptAction(r,o){const s={action:r,dataModel:o};r.undoSupported()&&(Wr(r),r.doAction(o),this.undoableActions.push(s)),this.actions.push(s)}undoAll(){this.undoableActions.forEach(({action:r,dataModel:o})=>r.undoAction(o))}getActions(){return this.actions.map(({action:r})=>r)}};function Hr(){try{return Vt().require("Waze/Action/MultiAction")}catch{return null}}function Ur(i){const r=Hr();if(!r)throw new Error("Unable to retrieve MultiAction");return new r(i)}let Lr=class{constructor(r){Ke(this,"_activeTransaction",null),Ke(this,"_actionManagerAddInterceptor"),this._actionManagerAddInterceptor=new zr(r,"add",(o,s)=>{var w,g;return(g=(w=this._activeTransaction)==null?void 0:w.acceptAction)==null||g.call(w,s,r.dataModel),!0})}openTransaction(){this._activeTransaction=new Nr,this._actionManagerAddInterceptor.enable()}closeTransaction(){const r=this._activeTransaction;return this._activeTransaction=null,this._actionManagerAddInterceptor.flushLoggedRequests(),this._actionManagerAddInterceptor.disable(),r}get hasTransaction(){return this._activeTransaction!==null}beginTransaction(){this.openTransaction()}commitTransaction(r){if(!this.hasTransaction)throw new Error("No open transaction found");try{const o=this._activeTransaction.getActions(),s=Ur(o);r&&(s._description=r),this._actionManagerAddInterceptor.callOriginalInvocator(s)}catch{this._actionManagerAddInterceptor.executeOriginalLoggedRequests()}finally{this.closeTransaction()}}cancelTransaction(){var r;(r=this._activeTransaction)==null||r.undoAll(),this.closeTransaction()}},pt;function nt(){if(!pt){const i=Vt();pt=new Lr(i.W.model.actionManager)}return pt}const qr=[new rt("Editing.beginTransaction",()=>nt().beginTransaction()),new rt("Editing.commitTransaction",i=>nt().commitTransaction(i)),new rt("Editing.cancelTransaction",()=>nt().cancelTransaction()),new rt("Editing.doActions",(i,r)=>{const o=nt();o.beginTransaction();try{i(),o.commitTransaction(r)}catch(s){throw o.cancelTransaction(),s}})];var Gr=Object.defineProperty,Br=(i,r,o)=>r in i?Gr(i,r,{enumerable:!0,configurable:!0,writable:!0,value:o}):i[r]=o,it=(i,r,o)=>Br(i,typeof r!="symbol"?r+"":r,o),Ct=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},zt={};/*! *****************************************************************************
  Copyright (C) Microsoft. All rights reserved.
  Licensed under the Apache License, Version 2.0 (the "License"); you may not use
  this file except in compliance with the License. You may obtain a copy of the
  License at http://www.apache.org/licenses/LICENSE-2.0

  THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
  WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
  MERCHANTABLITY OR NON-INFRINGEMENT.

  See the Apache Version 2.0 License for specific language governing permissions
  and limitations under the License.
  ***************************************************************************** */var Kt;function Jr(){if(Kt)return zt;Kt=1;var i;return function(r){(function(o){var s=typeof globalThis=="object"?globalThis:typeof Ct=="object"?Ct:typeof self=="object"?self:typeof this=="object"?this:E(),w=g(r);typeof s.Reflect<"u"&&(w=g(s.Reflect,w)),o(w,s),typeof s.Reflect>"u"&&(s.Reflect=r);function g($,T){return function(j,R){Object.defineProperty($,j,{configurable:!0,writable:!0,value:R}),T&&T(j,R)}}function I(){try{return Function("return this;")()}catch{}}function S(){try{return(0,eval)("(function() { return this; })()")}catch{}}function E(){return I()||S()}})(function(o,s){var w=Object.prototype.hasOwnProperty,g=typeof Symbol=="function",I=g&&typeof Symbol.toPrimitive<"u"?Symbol.toPrimitive:"@@toPrimitive",S=g&&typeof Symbol.iterator<"u"?Symbol.iterator:"@@iterator",E=typeof Object.create=="function",$={__proto__:[]}instanceof Array,T=!E&&!$,j={create:E?function(){return L(Object.create(null))}:$?function(){return L({__proto__:null})}:function(){return L({})},has:T?function(e,t){return w.call(e,t)}:function(e,t){return t in e},get:T?function(e,t){return w.call(e,t)?e[t]:void 0}:function(e,t){return e[t]}},R=Object.getPrototypeOf(Function),A=typeof Map=="function"&&typeof Map.prototype.entries=="function"?Map:Ie(),W=typeof Set=="function"&&typeof Set.prototype.entries=="function"?Set:Pe(),K=typeof WeakMap=="function"?WeakMap:xe(),P=g?Symbol.for("@reflect-metadata:registry"):void 0,V=Ee(),J=je(V);function we(e,t,n,a){if(d(n)){if(!ae(e))throw new TypeError;if(!se(t))throw new TypeError;return ve(e,t)}else{if(!ae(e))throw new TypeError;if(!b(t))throw new TypeError;if(!b(a)&&!d(a)&&!x(a))throw new TypeError;return x(a)&&(a=void 0),n=M(n),ge(e,t,n,a)}}o("decorate",we);function F(e,t){function n(a,h){if(!b(a))throw new TypeError;if(!d(h)&&!Se(h))throw new TypeError;te(e,t,a,h)}return n}o("metadata",F);function C(e,t,n,a){if(!b(n))throw new TypeError;return d(a)||(a=M(a)),te(e,t,n,a)}o("defineMetadata",C);function q(e,t,n){if(!b(t))throw new TypeError;return d(n)||(n=M(n)),Q(e,t,n)}o("hasMetadata",q);function G(e,t,n){if(!b(t))throw new TypeError;return d(n)||(n=M(n)),N(e,t,n)}o("hasOwnMetadata",G);function ye(e,t,n){if(!b(t))throw new TypeError;return d(n)||(n=M(n)),X(e,t,n)}o("getMetadata",ye);function Z(e,t,n){if(!b(t))throw new TypeError;return d(n)||(n=M(n)),ee(e,t,n)}o("getOwnMetadata",Z);function Y(e,t){if(!b(e))throw new TypeError;return d(t)||(t=M(t)),re(e,t)}o("getMetadataKeys",Y);function pe(e,t){if(!b(e))throw new TypeError;return d(t)||(t=M(t)),ne(e,t)}o("getOwnMetadataKeys",pe);function _e(e,t,n){if(!b(t))throw new TypeError;if(d(n)||(n=M(n)),!b(t))throw new TypeError;d(n)||(n=M(n));var a=D(t,n,!1);return d(a)?!1:a.OrdinaryDeleteMetadata(e,t,n)}o("deleteMetadata",_e);function ve(e,t){for(var n=e.length-1;n>=0;--n){var a=e[n],h=a(t);if(!d(h)&&!x(h)){if(!se(h))throw new TypeError;t=h}}return t}function ge(e,t,n,a){for(var h=e.length-1;h>=0;--h){var k=e[h],m=k(t,n,a);if(!d(m)&&!x(m)){if(!b(m))throw new TypeError;a=m}}return a}function Q(e,t,n){var a=N(e,t,n);if(a)return!0;var h=U(t);return x(h)?!1:Q(e,h,n)}function N(e,t,n){var a=D(t,n,!1);return d(a)?!1:oe(a.OrdinaryHasOwnMetadata(e,t,n))}function X(e,t,n){var a=N(e,t,n);if(a)return ee(e,t,n);var h=U(t);if(!x(h))return X(e,h,n)}function ee(e,t,n){var a=D(t,n,!1);if(!d(a))return a.OrdinaryGetOwnMetadata(e,t,n)}function te(e,t,n,a){var h=D(n,a,!0);h.OrdinaryDefineOwnMetadata(e,t,n,a)}function re(e,t){var n=ne(e,t),a=U(e);if(a===null)return n;var h=re(a,t);if(h.length<=0)return n;if(n.length<=0)return h;for(var k=new W,m=[],p=0,u=n;p<u.length;p++){var c=u[p],f=k.has(c);f||(k.add(c),m.push(c))}for(var l=0,y=h;l<y.length;l++){var c=y[l],f=k.has(c);f||(k.add(c),m.push(c))}return m}function ne(e,t){var n=D(e,t,!1);return n?n.OrdinaryOwnMetadataKeys(e,t):[]}function ie(e){if(e===null)return 1;switch(typeof e){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return e===null?1:6;default:return 6}}function d(e){return e===void 0}function x(e){return e===null}function be(e){return typeof e=="symbol"}function b(e){return typeof e=="object"?e!==null:typeof e=="function"}function me(e,t){switch(ie(e)){case 0:return e;case 1:return e;case 2:return e;case 3:return e;case 4:return e;case 5:return e}var n="string",a=ue(e,I);if(a!==void 0){var h=a.call(e,n);if(b(h))throw new TypeError;return h}return ke(e)}function ke(e,t){var n,a;{var h=e.toString;if(z(h)){var a=h.call(e);if(!b(a))return a}var n=e.valueOf;if(z(n)){var a=n.call(e);if(!b(a))return a}}throw new TypeError}function oe(e){return!!e}function Oe(e){return""+e}function M(e){var t=me(e);return be(t)?t:Oe(t)}function ae(e){return Array.isArray?Array.isArray(e):e instanceof Object?e instanceof Array:Object.prototype.toString.call(e)==="[object Array]"}function z(e){return typeof e=="function"}function se(e){return typeof e=="function"}function Se(e){switch(ie(e)){case 3:return!0;case 4:return!0;default:return!1}}function H(e,t){return e===t||e!==e&&t!==t}function ue(e,t){var n=e[t];if(n!=null){if(!z(n))throw new TypeError;return n}}function ce(e){var t=ue(e,S);if(!z(t))throw new TypeError;var n=t.call(e);if(!b(n))throw new TypeError;return n}function fe(e){return e.value}function le(e){var t=e.next();return t.done?!1:t}function he(e){var t=e.return;t&&t.call(e)}function U(e){var t=Object.getPrototypeOf(e);if(typeof e!="function"||e===R||t!==R)return t;var n=e.prototype,a=n&&Object.getPrototypeOf(n);if(a==null||a===Object.prototype)return t;var h=a.constructor;return typeof h!="function"||h===e?t:h}function Me(){var e;!d(P)&&typeof s.Reflect<"u"&&!(P in s.Reflect)&&typeof s.Reflect.defineMetadata=="function"&&(e=Te(s.Reflect));var t,n,a,h=new K,k={registerProvider:m,getProvider:u,setProvider:f};return k;function m(l){if(!Object.isExtensible(k))throw new Error("Cannot add provider to a frozen registry.");switch(!0){case e===l:break;case d(t):t=l;break;case t===l:break;case d(n):n=l;break;case n===l:break;default:a===void 0&&(a=new W),a.add(l);break}}function p(l,y){if(!d(t)){if(t.isProviderFor(l,y))return t;if(!d(n)){if(n.isProviderFor(l,y))return t;if(!d(a))for(var _=ce(a);;){var v=le(_);if(!v)return;var O=fe(v);if(O.isProviderFor(l,y))return he(_),O}}}if(!d(e)&&e.isProviderFor(l,y))return e}function u(l,y){var _=h.get(l),v;return d(_)||(v=_.get(y)),d(v)&&(v=p(l,y),d(v)||(d(_)&&(_=new A,h.set(l,_)),_.set(y,v))),v}function c(l){if(d(l))throw new TypeError;return t===l||n===l||!d(a)&&a.has(l)}function f(l,y,_){if(!c(_))throw new Error("Metadata provider not registered.");var v=u(l,y);if(v!==_){if(!d(v))return!1;var O=h.get(l);d(O)&&(O=new A,h.set(l,O)),O.set(y,_)}return!0}}function Ee(){var e;return!d(P)&&b(s.Reflect)&&Object.isExtensible(s.Reflect)&&(e=s.Reflect[P]),d(e)&&(e=Me()),!d(P)&&b(s.Reflect)&&Object.isExtensible(s.Reflect)&&Object.defineProperty(s.Reflect,P,{enumerable:!1,configurable:!1,writable:!1,value:e}),e}function je(e){var t=new K,n={isProviderFor:function(c,f){var l=t.get(c);return d(l)?!1:l.has(f)},OrdinaryDefineOwnMetadata:m,OrdinaryHasOwnMetadata:h,OrdinaryGetOwnMetadata:k,OrdinaryOwnMetadataKeys:p,OrdinaryDeleteMetadata:u};return V.registerProvider(n),n;function a(c,f,l){var y=t.get(c),_=!1;if(d(y)){if(!l)return;y=new A,t.set(c,y),_=!0}var v=y.get(f);if(d(v)){if(!l)return;if(v=new A,y.set(f,v),!e.setProvider(c,f,n))throw y.delete(f),_&&t.delete(c),new Error("Wrong provider for target.")}return v}function h(c,f,l){var y=a(f,l,!1);return d(y)?!1:oe(y.has(c))}function k(c,f,l){var y=a(f,l,!1);if(!d(y))return y.get(c)}function m(c,f,l,y){var _=a(l,y,!0);_.set(c,f)}function p(c,f){var l=[],y=a(c,f,!1);if(d(y))return l;for(var _=y.keys(),v=ce(_),O=0;;){var de=le(v);if(!de)return l.length=O,l;var Re=fe(de);try{l[O]=Re}catch(Ae){try{he(v)}finally{throw Ae}}O++}}function u(c,f,l){var y=a(f,l,!1);if(d(y)||!y.delete(c))return!1;if(y.size===0){var _=t.get(f);d(_)||(_.delete(l),_.size===0&&t.delete(_))}return!0}}function Te(e){var t=e.defineMetadata,n=e.hasOwnMetadata,a=e.getOwnMetadata,h=e.getOwnMetadataKeys,k=e.deleteMetadata,m=new K,p={isProviderFor:function(u,c){var f=m.get(u);return!d(f)&&f.has(c)?!0:h(u,c).length?(d(f)&&(f=new W,m.set(u,f)),f.add(c),!0):!1},OrdinaryDefineOwnMetadata:t,OrdinaryHasOwnMetadata:n,OrdinaryGetOwnMetadata:a,OrdinaryOwnMetadataKeys:h,OrdinaryDeleteMetadata:k};return p}function D(e,t,n){var a=V.getProvider(e,t);if(!d(a))return a;if(n){if(V.setProvider(e,t,J))return J;throw new Error("Illegal state.")}}function Ie(){var e={},t=[],n=function(){function p(u,c,f){this._index=0,this._keys=u,this._values=c,this._selector=f}return p.prototype["@@iterator"]=function(){return this},p.prototype[S]=function(){return this},p.prototype.next=function(){var u=this._index;if(u>=0&&u<this._keys.length){var c=this._selector(this._keys[u],this._values[u]);return u+1>=this._keys.length?(this._index=-1,this._keys=t,this._values=t):this._index++,{value:c,done:!1}}return{value:void 0,done:!0}},p.prototype.throw=function(u){throw this._index>=0&&(this._index=-1,this._keys=t,this._values=t),u},p.prototype.return=function(u){return this._index>=0&&(this._index=-1,this._keys=t,this._values=t),{value:u,done:!0}},p}(),a=function(){function p(){this._keys=[],this._values=[],this._cacheKey=e,this._cacheIndex=-2}return Object.defineProperty(p.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),p.prototype.has=function(u){return this._find(u,!1)>=0},p.prototype.get=function(u){var c=this._find(u,!1);return c>=0?this._values[c]:void 0},p.prototype.set=function(u,c){var f=this._find(u,!0);return this._values[f]=c,this},p.prototype.delete=function(u){var c=this._find(u,!1);if(c>=0){for(var f=this._keys.length,l=c+1;l<f;l++)this._keys[l-1]=this._keys[l],this._values[l-1]=this._values[l];return this._keys.length--,this._values.length--,H(u,this._cacheKey)&&(this._cacheKey=e,this._cacheIndex=-2),!0}return!1},p.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=e,this._cacheIndex=-2},p.prototype.keys=function(){return new n(this._keys,this._values,h)},p.prototype.values=function(){return new n(this._keys,this._values,k)},p.prototype.entries=function(){return new n(this._keys,this._values,m)},p.prototype["@@iterator"]=function(){return this.entries()},p.prototype[S]=function(){return this.entries()},p.prototype._find=function(u,c){if(!H(this._cacheKey,u)){this._cacheIndex=-1;for(var f=0;f<this._keys.length;f++)if(H(this._keys[f],u)){this._cacheIndex=f;break}}return this._cacheIndex<0&&c&&(this._cacheIndex=this._keys.length,this._keys.push(u),this._values.push(void 0)),this._cacheIndex},p}();return a;function h(p,u){return p}function k(p,u){return u}function m(p,u){return[p,u]}}function Pe(){var e=function(){function t(){this._map=new A}return Object.defineProperty(t.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),t.prototype.has=function(n){return this._map.has(n)},t.prototype.add=function(n){return this._map.set(n,n),this},t.prototype.delete=function(n){return this._map.delete(n)},t.prototype.clear=function(){this._map.clear()},t.prototype.keys=function(){return this._map.keys()},t.prototype.values=function(){return this._map.keys()},t.prototype.entries=function(){return this._map.entries()},t.prototype["@@iterator"]=function(){return this.keys()},t.prototype[S]=function(){return this.keys()},t}();return e}function xe(){var e=16,t=j.create(),n=a();return function(){function u(){this._key=a()}return u.prototype.has=function(c){var f=h(c,!1);return f!==void 0?j.has(f,this._key):!1},u.prototype.get=function(c){var f=h(c,!1);return f!==void 0?j.get(f,this._key):void 0},u.prototype.set=function(c,f){var l=h(c,!0);return l[this._key]=f,this},u.prototype.delete=function(c){var f=h(c,!1);return f!==void 0?delete f[this._key]:!1},u.prototype.clear=function(){this._key=a()},u}();function a(){var u;do u="@@WeakMap@@"+p();while(j.has(t,u));return t[u]=!0,u}function h(u,c){if(!w.call(u,n)){if(!c)return;Object.defineProperty(u,n,{value:j.create()})}return u[n]}function k(u,c){for(var f=0;f<c;++f)u[f]=Math.random()*255|0;return u}function m(u){if(typeof Uint8Array=="function"){var c=new Uint8Array(u);return typeof crypto<"u"?crypto.getRandomValues(c):typeof msCrypto<"u"?msCrypto.getRandomValues(c):k(c,u),c}return k(new Array(u),u)}function p(){var u=m(e);u[6]=u[6]&79|64,u[8]=u[8]&191|128;for(var c="",f=0;f<e;++f){var l=u[f];(f===4||f===6||f===8)&&(c+="-"),l<16&&(c+="0"),c+=l.toString(16).toLowerCase()}return c}}function L(e){return e.__=void 0,delete e.__,e}})}(i||(i={})),zt}Jr();var Zr=Object.defineProperty,Yr=(i,r,o)=>r in i?Zr(i,r,{enumerable:!0,configurable:!0,writable:!0,value:o}):i[r]=o,Ne=(i,r,o)=>Yr(i,typeof r!="symbol"?r+"":r,o);let Qr=class{constructor(r,o){Ne(this,"_target"),Ne(this,"_key"),Ne(this,"_oldValue"),Ne(this,"_wasDefined",!1),Ne(this,"_isSwapped",!1),this._target=r,this._key=o,this._oldValue=this._target[this._key]}get isSwapped(){return this._isSwapped}get originalValue(){return this._oldValue}get value(){return this._target[this._key]}get target(){return this._target}restore(){this.isSwapped&&(this._wasDefined?this._target[this._key]=this._oldValue:delete this._target[this._key],this._isSwapped=!1)}swap(r){this.isSwapped||(this._wasDefined=Object.hasOwn(this._target,this._key),this._oldValue=this._target[this._key]),this._target[this._key]=r,this._isSwapped=!0}};const Xr={onlyIfNotExists:!0,isFactory:!1};let Wt=class{constructor(r,o,s={}){if(it(this,"_installedInstances",new Map),it(this,"_path"),it(this,"_targetValue"),it(this,"_options"),this._path=r.split("."),this._path.length===0)throw new Error("Path must not be empty");this._targetValue=o,this._options={...Xr,...s}}_getTargetObject(r){let o=r;for(const s of this._path.slice(0,this._path.length-1))o[s]||(o[s]={}),o=o[s];return o}_createSwapper(r){const o=this._getTargetObject(r);return new Qr(o,this._path.at(-1))}install({sdk:r,...o}){if(this._installedInstances.has(r))return;const s=this._createSwapper(r);if(!(s.value&&this._options.onlyIfNotExists)){if(this._options.isFactory&&typeof this._targetValue=="function"){const w=this._targetValue({sdk:r,...o});s.swap(w)}else s.swap(this._targetValue);this._installedInstances.set(r,s)}}uninstall({sdk:r}){const o=this._installedInstances.get(r);o&&(o.restore(),this._installedInstances.delete(r))}};var en=Object.defineProperty,tn=(i,r,o)=>r in i?en(i,r,{enumerable:!0,configurable:!0,writable:!0,value:o}):i[r]=o,He=(i,r,o)=>tn(i,typeof r!="symbol"?r+"":r,o);let rn=class{constructor(r,o){He(this,"_target"),He(this,"_key"),He(this,"_oldValue"),He(this,"_wasDefined",!1),He(this,"_isSwapped",!1),this._target=r,this._key=o,this._oldValue=this._target[this._key]}get isSwapped(){return this._isSwapped}get originalValue(){return this._oldValue}get value(){return this._target[this._key]}get target(){return this._target}restore(){this.isSwapped&&(this._wasDefined?this._target[this._key]=this._oldValue:delete this._target[this._key],this._isSwapped=!1)}swap(r){this.isSwapped||(this._wasDefined=Object.hasOwn(this._target,this._key),this._oldValue=this._target[this._key]),this._target[this._key]=r,this._isSwapped=!0}};function yt(){return"unsafeWindow"in window?window.unsafeWindow:window}var nn=Object.defineProperty,on=(i,r,o)=>r in i?nn(i,r,{enumerable:!0,configurable:!0,writable:!0,value:o}):i[r]=o,Nt=(i,r,o)=>on(i,typeof r!="symbol"?r+"":r,o);function Ue(){return"unsafeWindow"in window?window.unsafeWindow:window}var an=Object.defineProperty,sn=(i,r,o)=>r in i?an(i,r,{enumerable:!0,configurable:!0,writable:!0,value:o}):i[r]=o,De=(i,r,o)=>sn(i,typeof r!="symbol"?r+"":r,o);let un=class{constructor(r,o){De(this,"_target"),De(this,"_key"),De(this,"_oldValue"),De(this,"_wasDefined",!1),De(this,"_isSwapped",!1),this._target=r,this._key=o,this._oldValue=this._target[this._key]}get isSwapped(){return this._isSwapped}get originalValue(){return this._oldValue}get value(){return this._target[this._key]}get target(){return this._target}restore(){this.isSwapped&&(this._wasDefined?this._target[this._key]=this._oldValue:delete this._target[this._key],this._isSwapped=!1)}swap(r){this.isSwapped||(this._wasDefined=Object.hasOwn(this._target,this._key),this._oldValue=this._target[this._key]),this._target[this._key]=r,this._isSwapped=!0}},cn=class{constructor(r,o,s){De(this,"_enabled",!1),De(this,"_fnSwapper"),De(this,"_interceptionFunction"),De(this,"_middlewares",[]),this._fnSwapper=new un(r,o),this._interceptionFunction=s}get enabled(){return this._fnSwapper.isSwapped&&this._enabled}disable(){this._enabled=!1,this.enabled}restore(){this._fnSwapper.restore()}enable(){this._enabled=!0,this._fnSwapper.isSwapped||this.swapToInterceptor()}swapToInterceptor(){const r=this;this._fnSwapper.swap(function(...o){if(!r._enabled)return r.callOriginalInvocator(...o);const s=r.runMiddlewares(o);if(s){if("output"in s)return s.output;"input"in s&&(o=s.input)}return r._interceptionFunction.call(this,r.getOriginalInvocator(this),...o)})}getOriginalInvocator(r){return this._fnSwapper.originalValue.bind(r??this._fnSwapper.target)}callOriginalInvocator(...r){return this.getOriginalInvocator()(...r)}runMiddlewares(r){for(const o of this._middlewares){const s=o(...r);if(s){if("output"in s)return s;"input"in s&&(r=s.input)}}return{input:r}}registerMiddleware(r){this._middlewares.push(r)}},fn=class{constructor(r){Nt(this,"_fetchInterceptor"),Nt(this,"_interceptionFilters",new Set),this._fetchInterceptor=new cn(r,"fetch",(o,s,w)=>{for(const g of this._interceptionFilters)if(g.shouldIntercept(s,w))return this.shouldKeepFilter(g,s,w)||this.removeInterceptionFilter(g),g.intercept(s,w);return o(s,w)})}enable(){this._fetchInterceptor.enable()}disable(){this._fetchInterceptor.disable()}addInterceptionFilter(r){this.enable(),this._interceptionFilters.add(r)}removeInterceptionFilter(r){this._interceptionFilters.delete(r)}shouldKeepFilter(r,o,s){return typeof r.shouldKeep=="function"?r.shouldKeep(o,s):typeof r.shouldKeep=="boolean"?r.shouldKeep:!1}};function ln(i){return i=i instanceof URL?i:new URL(i,Ue().location.href),r=>typeof r=="string"?new URL(r,Ue().location.href).pathname===i.pathname:r instanceof URL?r.pathname===i.pathname:new URL(r.url,Ue().location.href).pathname===new URL(i,Ue().location.href).pathname}function hn(i,r,o){const s=new Response(r,o),w=new URL(i,location.toString());return Object.defineProperty(s,"url",{value:w}),s}function dn(i,r){const o=JSON.stringify(r),s=new Headers({"Content-Type":"application/json"});return hn(i,o,{headers:s})}const pn=new fn(Ue());function yn(){const i=yt(),r=new rn(i.W.controller.descartesClient,"createAbortController");r.swap(()=>(r.restore(),new AbortController))}function wn(i){const r=yt();return yn(),r.W.controller.descartesClient.getFeatures([0,0,0,0],{[i]:!0},{})}async function _n(i,r){const o=yt().W.Config.paths.features;pn.addInterceptionFilter({shouldIntercept:ln(o),intercept(){return Promise.resolve(dn(o,{[i]:{objects:[r]}}))}});const{[i]:s}=await wn(i),[w]=s.objects;return w.constructor}function vn(i,r,o={}){const s={type:"Feature"};return(o.id===0||o.id)&&(s.id=o.id),o.bbox&&(s.bbox=o.bbox),s.properties={},s.geometry=i,s}function gn(i,r,o={}){if(!i)throw new Error("coordinates is required");if(!Array.isArray(i))throw new Error("coordinates must be an Array");if(i.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!Ht(i[0])||!Ht(i[1]))throw new Error("coordinates must contain numbers");return vn({type:"Point",coordinates:i},r,o)}function Ht(i){return!isNaN(i)&&i!==null&&!Array.isArray(i)}function Le(){return"unsafeWindow"in window?window.unsafeWindow:window}function bn(i){const r=Le().require("Waze/Action/CreateObject");return new r(i)}function mn(i){Le().W.model.actionManager.add(bn(i))}function kn(i){return i.toISOString().slice(0,16).replace("T"," ")}function On(i){return Le().W.model.mapComments.getObjectById(i)}function Sn(i,r){const o=Le().require("Waze/Action/UpdateObject");return new o(i,r)}function Mn(i,r){Le().W.model.actionManager.add(Sn(i,r))}let wt;function En(){if(!wt)throw new Error("MapComment not initialized. Make sure to await the enhancedSDK function before using it.")}const jn=[{async install(){wt=await _n("mapComments",{geometry:gn([0,0]).geometry})}},new Wt("DataModel.MapComments.addMapComment",i=>{En();const r=new wt({geoJSONGeometry:i.geometry,subject:i.subject,body:i.body,lockRank:i.lockRank,endDate:i.endDate?kn(i.endDate):null});return mn(r),r.getID()}),new Wt("DataModel.MapComments.updateMapComment",({sdkInstance:i})=>r=>{const o=On(r.mapCommentId);if(!o)throw new i.Errors.DataModelNotFoundError("mapComment",r.mapCommentId);const s={};r.geometry&&(s.geoJSONGeometry=r.geometry),r.subject&&(s.subject=r.subject),r.body&&(s.body=r.body),r.lockRank&&(s.lockRank=r.lockRank),Mn(o,s)},{isFactory:!0})];var Tn=Object.defineProperty,In=(i,r,o)=>r in i?Tn(i,r,{enumerable:!0,configurable:!0,writable:!0,value:o}):i[r]=o,ot=(i,r,o)=>In(i,typeof r!="symbol"?r+"":r,o),Ut=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Lt={};/*! *****************************************************************************
  Copyright (C) Microsoft. All rights reserved.
  Licensed under the Apache License, Version 2.0 (the "License"); you may not use
  this file except in compliance with the License. You may obtain a copy of the
  License at http://www.apache.org/licenses/LICENSE-2.0

  THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
  WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
  MERCHANTABLITY OR NON-INFRINGEMENT.

  See the Apache Version 2.0 License for specific language governing permissions
  and limitations under the License.
  ***************************************************************************** */var qt;function Pn(){if(qt)return Lt;qt=1;var i;return function(r){(function(o){var s=typeof globalThis=="object"?globalThis:typeof Ut=="object"?Ut:typeof self=="object"?self:typeof this=="object"?this:E(),w=g(r);typeof s.Reflect<"u"&&(w=g(s.Reflect,w)),o(w,s),typeof s.Reflect>"u"&&(s.Reflect=r);function g($,T){return function(j,R){Object.defineProperty($,j,{configurable:!0,writable:!0,value:R}),T&&T(j,R)}}function I(){try{return Function("return this;")()}catch{}}function S(){try{return(0,eval)("(function() { return this; })()")}catch{}}function E(){return I()||S()}})(function(o,s){var w=Object.prototype.hasOwnProperty,g=typeof Symbol=="function",I=g&&typeof Symbol.toPrimitive<"u"?Symbol.toPrimitive:"@@toPrimitive",S=g&&typeof Symbol.iterator<"u"?Symbol.iterator:"@@iterator",E=typeof Object.create=="function",$={__proto__:[]}instanceof Array,T=!E&&!$,j={create:E?function(){return L(Object.create(null))}:$?function(){return L({__proto__:null})}:function(){return L({})},has:T?function(e,t){return w.call(e,t)}:function(e,t){return t in e},get:T?function(e,t){return w.call(e,t)?e[t]:void 0}:function(e,t){return e[t]}},R=Object.getPrototypeOf(Function),A=typeof Map=="function"&&typeof Map.prototype.entries=="function"?Map:Ie(),W=typeof Set=="function"&&typeof Set.prototype.entries=="function"?Set:Pe(),K=typeof WeakMap=="function"?WeakMap:xe(),P=g?Symbol.for("@reflect-metadata:registry"):void 0,V=Ee(),J=je(V);function we(e,t,n,a){if(d(n)){if(!ae(e))throw new TypeError;if(!se(t))throw new TypeError;return ve(e,t)}else{if(!ae(e))throw new TypeError;if(!b(t))throw new TypeError;if(!b(a)&&!d(a)&&!x(a))throw new TypeError;return x(a)&&(a=void 0),n=M(n),ge(e,t,n,a)}}o("decorate",we);function F(e,t){function n(a,h){if(!b(a))throw new TypeError;if(!d(h)&&!Se(h))throw new TypeError;te(e,t,a,h)}return n}o("metadata",F);function C(e,t,n,a){if(!b(n))throw new TypeError;return d(a)||(a=M(a)),te(e,t,n,a)}o("defineMetadata",C);function q(e,t,n){if(!b(t))throw new TypeError;return d(n)||(n=M(n)),Q(e,t,n)}o("hasMetadata",q);function G(e,t,n){if(!b(t))throw new TypeError;return d(n)||(n=M(n)),N(e,t,n)}o("hasOwnMetadata",G);function ye(e,t,n){if(!b(t))throw new TypeError;return d(n)||(n=M(n)),X(e,t,n)}o("getMetadata",ye);function Z(e,t,n){if(!b(t))throw new TypeError;return d(n)||(n=M(n)),ee(e,t,n)}o("getOwnMetadata",Z);function Y(e,t){if(!b(e))throw new TypeError;return d(t)||(t=M(t)),re(e,t)}o("getMetadataKeys",Y);function pe(e,t){if(!b(e))throw new TypeError;return d(t)||(t=M(t)),ne(e,t)}o("getOwnMetadataKeys",pe);function _e(e,t,n){if(!b(t))throw new TypeError;if(d(n)||(n=M(n)),!b(t))throw new TypeError;d(n)||(n=M(n));var a=D(t,n,!1);return d(a)?!1:a.OrdinaryDeleteMetadata(e,t,n)}o("deleteMetadata",_e);function ve(e,t){for(var n=e.length-1;n>=0;--n){var a=e[n],h=a(t);if(!d(h)&&!x(h)){if(!se(h))throw new TypeError;t=h}}return t}function ge(e,t,n,a){for(var h=e.length-1;h>=0;--h){var k=e[h],m=k(t,n,a);if(!d(m)&&!x(m)){if(!b(m))throw new TypeError;a=m}}return a}function Q(e,t,n){var a=N(e,t,n);if(a)return!0;var h=U(t);return x(h)?!1:Q(e,h,n)}function N(e,t,n){var a=D(t,n,!1);return d(a)?!1:oe(a.OrdinaryHasOwnMetadata(e,t,n))}function X(e,t,n){var a=N(e,t,n);if(a)return ee(e,t,n);var h=U(t);if(!x(h))return X(e,h,n)}function ee(e,t,n){var a=D(t,n,!1);if(!d(a))return a.OrdinaryGetOwnMetadata(e,t,n)}function te(e,t,n,a){var h=D(n,a,!0);h.OrdinaryDefineOwnMetadata(e,t,n,a)}function re(e,t){var n=ne(e,t),a=U(e);if(a===null)return n;var h=re(a,t);if(h.length<=0)return n;if(n.length<=0)return h;for(var k=new W,m=[],p=0,u=n;p<u.length;p++){var c=u[p],f=k.has(c);f||(k.add(c),m.push(c))}for(var l=0,y=h;l<y.length;l++){var c=y[l],f=k.has(c);f||(k.add(c),m.push(c))}return m}function ne(e,t){var n=D(e,t,!1);return n?n.OrdinaryOwnMetadataKeys(e,t):[]}function ie(e){if(e===null)return 1;switch(typeof e){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return e===null?1:6;default:return 6}}function d(e){return e===void 0}function x(e){return e===null}function be(e){return typeof e=="symbol"}function b(e){return typeof e=="object"?e!==null:typeof e=="function"}function me(e,t){switch(ie(e)){case 0:return e;case 1:return e;case 2:return e;case 3:return e;case 4:return e;case 5:return e}var n="string",a=ue(e,I);if(a!==void 0){var h=a.call(e,n);if(b(h))throw new TypeError;return h}return ke(e)}function ke(e,t){var n,a;{var h=e.toString;if(z(h)){var a=h.call(e);if(!b(a))return a}var n=e.valueOf;if(z(n)){var a=n.call(e);if(!b(a))return a}}throw new TypeError}function oe(e){return!!e}function Oe(e){return""+e}function M(e){var t=me(e);return be(t)?t:Oe(t)}function ae(e){return Array.isArray?Array.isArray(e):e instanceof Object?e instanceof Array:Object.prototype.toString.call(e)==="[object Array]"}function z(e){return typeof e=="function"}function se(e){return typeof e=="function"}function Se(e){switch(ie(e)){case 3:return!0;case 4:return!0;default:return!1}}function H(e,t){return e===t||e!==e&&t!==t}function ue(e,t){var n=e[t];if(n!=null){if(!z(n))throw new TypeError;return n}}function ce(e){var t=ue(e,S);if(!z(t))throw new TypeError;var n=t.call(e);if(!b(n))throw new TypeError;return n}function fe(e){return e.value}function le(e){var t=e.next();return t.done?!1:t}function he(e){var t=e.return;t&&t.call(e)}function U(e){var t=Object.getPrototypeOf(e);if(typeof e!="function"||e===R||t!==R)return t;var n=e.prototype,a=n&&Object.getPrototypeOf(n);if(a==null||a===Object.prototype)return t;var h=a.constructor;return typeof h!="function"||h===e?t:h}function Me(){var e;!d(P)&&typeof s.Reflect<"u"&&!(P in s.Reflect)&&typeof s.Reflect.defineMetadata=="function"&&(e=Te(s.Reflect));var t,n,a,h=new K,k={registerProvider:m,getProvider:u,setProvider:f};return k;function m(l){if(!Object.isExtensible(k))throw new Error("Cannot add provider to a frozen registry.");switch(!0){case e===l:break;case d(t):t=l;break;case t===l:break;case d(n):n=l;break;case n===l:break;default:a===void 0&&(a=new W),a.add(l);break}}function p(l,y){if(!d(t)){if(t.isProviderFor(l,y))return t;if(!d(n)){if(n.isProviderFor(l,y))return t;if(!d(a))for(var _=ce(a);;){var v=le(_);if(!v)return;var O=fe(v);if(O.isProviderFor(l,y))return he(_),O}}}if(!d(e)&&e.isProviderFor(l,y))return e}function u(l,y){var _=h.get(l),v;return d(_)||(v=_.get(y)),d(v)&&(v=p(l,y),d(v)||(d(_)&&(_=new A,h.set(l,_)),_.set(y,v))),v}function c(l){if(d(l))throw new TypeError;return t===l||n===l||!d(a)&&a.has(l)}function f(l,y,_){if(!c(_))throw new Error("Metadata provider not registered.");var v=u(l,y);if(v!==_){if(!d(v))return!1;var O=h.get(l);d(O)&&(O=new A,h.set(l,O)),O.set(y,_)}return!0}}function Ee(){var e;return!d(P)&&b(s.Reflect)&&Object.isExtensible(s.Reflect)&&(e=s.Reflect[P]),d(e)&&(e=Me()),!d(P)&&b(s.Reflect)&&Object.isExtensible(s.Reflect)&&Object.defineProperty(s.Reflect,P,{enumerable:!1,configurable:!1,writable:!1,value:e}),e}function je(e){var t=new K,n={isProviderFor:function(c,f){var l=t.get(c);return d(l)?!1:l.has(f)},OrdinaryDefineOwnMetadata:m,OrdinaryHasOwnMetadata:h,OrdinaryGetOwnMetadata:k,OrdinaryOwnMetadataKeys:p,OrdinaryDeleteMetadata:u};return V.registerProvider(n),n;function a(c,f,l){var y=t.get(c),_=!1;if(d(y)){if(!l)return;y=new A,t.set(c,y),_=!0}var v=y.get(f);if(d(v)){if(!l)return;if(v=new A,y.set(f,v),!e.setProvider(c,f,n))throw y.delete(f),_&&t.delete(c),new Error("Wrong provider for target.")}return v}function h(c,f,l){var y=a(f,l,!1);return d(y)?!1:oe(y.has(c))}function k(c,f,l){var y=a(f,l,!1);if(!d(y))return y.get(c)}function m(c,f,l,y){var _=a(l,y,!0);_.set(c,f)}function p(c,f){var l=[],y=a(c,f,!1);if(d(y))return l;for(var _=y.keys(),v=ce(_),O=0;;){var de=le(v);if(!de)return l.length=O,l;var Re=fe(de);try{l[O]=Re}catch(Ae){try{he(v)}finally{throw Ae}}O++}}function u(c,f,l){var y=a(f,l,!1);if(d(y)||!y.delete(c))return!1;if(y.size===0){var _=t.get(f);d(_)||(_.delete(l),_.size===0&&t.delete(_))}return!0}}function Te(e){var t=e.defineMetadata,n=e.hasOwnMetadata,a=e.getOwnMetadata,h=e.getOwnMetadataKeys,k=e.deleteMetadata,m=new K,p={isProviderFor:function(u,c){var f=m.get(u);return!d(f)&&f.has(c)?!0:h(u,c).length?(d(f)&&(f=new W,m.set(u,f)),f.add(c),!0):!1},OrdinaryDefineOwnMetadata:t,OrdinaryHasOwnMetadata:n,OrdinaryGetOwnMetadata:a,OrdinaryOwnMetadataKeys:h,OrdinaryDeleteMetadata:k};return p}function D(e,t,n){var a=V.getProvider(e,t);if(!d(a))return a;if(n){if(V.setProvider(e,t,J))return J;throw new Error("Illegal state.")}}function Ie(){var e={},t=[],n=function(){function p(u,c,f){this._index=0,this._keys=u,this._values=c,this._selector=f}return p.prototype["@@iterator"]=function(){return this},p.prototype[S]=function(){return this},p.prototype.next=function(){var u=this._index;if(u>=0&&u<this._keys.length){var c=this._selector(this._keys[u],this._values[u]);return u+1>=this._keys.length?(this._index=-1,this._keys=t,this._values=t):this._index++,{value:c,done:!1}}return{value:void 0,done:!0}},p.prototype.throw=function(u){throw this._index>=0&&(this._index=-1,this._keys=t,this._values=t),u},p.prototype.return=function(u){return this._index>=0&&(this._index=-1,this._keys=t,this._values=t),{value:u,done:!0}},p}(),a=function(){function p(){this._keys=[],this._values=[],this._cacheKey=e,this._cacheIndex=-2}return Object.defineProperty(p.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),p.prototype.has=function(u){return this._find(u,!1)>=0},p.prototype.get=function(u){var c=this._find(u,!1);return c>=0?this._values[c]:void 0},p.prototype.set=function(u,c){var f=this._find(u,!0);return this._values[f]=c,this},p.prototype.delete=function(u){var c=this._find(u,!1);if(c>=0){for(var f=this._keys.length,l=c+1;l<f;l++)this._keys[l-1]=this._keys[l],this._values[l-1]=this._values[l];return this._keys.length--,this._values.length--,H(u,this._cacheKey)&&(this._cacheKey=e,this._cacheIndex=-2),!0}return!1},p.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=e,this._cacheIndex=-2},p.prototype.keys=function(){return new n(this._keys,this._values,h)},p.prototype.values=function(){return new n(this._keys,this._values,k)},p.prototype.entries=function(){return new n(this._keys,this._values,m)},p.prototype["@@iterator"]=function(){return this.entries()},p.prototype[S]=function(){return this.entries()},p.prototype._find=function(u,c){if(!H(this._cacheKey,u)){this._cacheIndex=-1;for(var f=0;f<this._keys.length;f++)if(H(this._keys[f],u)){this._cacheIndex=f;break}}return this._cacheIndex<0&&c&&(this._cacheIndex=this._keys.length,this._keys.push(u),this._values.push(void 0)),this._cacheIndex},p}();return a;function h(p,u){return p}function k(p,u){return u}function m(p,u){return[p,u]}}function Pe(){var e=function(){function t(){this._map=new A}return Object.defineProperty(t.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),t.prototype.has=function(n){return this._map.has(n)},t.prototype.add=function(n){return this._map.set(n,n),this},t.prototype.delete=function(n){return this._map.delete(n)},t.prototype.clear=function(){this._map.clear()},t.prototype.keys=function(){return this._map.keys()},t.prototype.values=function(){return this._map.keys()},t.prototype.entries=function(){return this._map.entries()},t.prototype["@@iterator"]=function(){return this.keys()},t.prototype[S]=function(){return this.keys()},t}();return e}function xe(){var e=16,t=j.create(),n=a();return function(){function u(){this._key=a()}return u.prototype.has=function(c){var f=h(c,!1);return f!==void 0?j.has(f,this._key):!1},u.prototype.get=function(c){var f=h(c,!1);return f!==void 0?j.get(f,this._key):void 0},u.prototype.set=function(c,f){var l=h(c,!0);return l[this._key]=f,this},u.prototype.delete=function(c){var f=h(c,!1);return f!==void 0?delete f[this._key]:!1},u.prototype.clear=function(){this._key=a()},u}();function a(){var u;do u="@@WeakMap@@"+p();while(j.has(t,u));return t[u]=!0,u}function h(u,c){if(!w.call(u,n)){if(!c)return;Object.defineProperty(u,n,{value:j.create()})}return u[n]}function k(u,c){for(var f=0;f<c;++f)u[f]=Math.random()*255|0;return u}function m(u){if(typeof Uint8Array=="function"){var c=new Uint8Array(u);return typeof crypto<"u"?crypto.getRandomValues(c):typeof msCrypto<"u"?msCrypto.getRandomValues(c):k(c,u),c}return k(new Array(u),u)}function p(){var u=m(e);u[6]=u[6]&79|64,u[8]=u[8]&191|128;for(var c="",f=0;f<e;++f){var l=u[f];(f===4||f===6||f===8)&&(c+="-"),l<16&&(c+="0"),c+=l.toString(16).toLowerCase()}return c}}function L(e){return e.__=void 0,delete e.__,e}})}(i||(i={})),Lt}Pn();var xn=Object.defineProperty,Rn=(i,r,o)=>r in i?xn(i,r,{enumerable:!0,configurable:!0,writable:!0,value:o}):i[r]=o,qe=(i,r,o)=>Rn(i,typeof r!="symbol"?r+"":r,o);let An=class{constructor(r,o){qe(this,"_target"),qe(this,"_key"),qe(this,"_oldValue"),qe(this,"_wasDefined",!1),qe(this,"_isSwapped",!1),this._target=r,this._key=o,this._oldValue=this._target[this._key]}get isSwapped(){return this._isSwapped}get originalValue(){return this._oldValue}get value(){return this._target[this._key]}get target(){return this._target}restore(){this.isSwapped&&(this._wasDefined?this._target[this._key]=this._oldValue:delete this._target[this._key],this._isSwapped=!1)}swap(r){this.isSwapped||(this._wasDefined=Object.hasOwn(this._target,this._key),this._oldValue=this._target[this._key]),this._target[this._key]=r,this._isSwapped=!0}};const $n={onlyIfNotExists:!0,isFactory:!1};class _t{constructor(r,o,s={}){if(ot(this,"_installedInstances",new Map),ot(this,"_path"),ot(this,"_targetValue"),ot(this,"_options"),this._path=r.split("."),this._path.length===0)throw new Error("Path must not be empty");this._targetValue=o,this._options={...$n,...s}}_getTargetObject(r){let o=r;for(const s of this._path.slice(0,this._path.length-1))o[s]||(o[s]={}),o=o[s];return o}_createSwapper(r){const o=this._getTargetObject(r);return new An(o,this._path.at(-1))}install({sdk:r,...o}){if(this._installedInstances.has(r))return;const s=this._createSwapper(r);if(!(s.value&&this._options.onlyIfNotExists)){if(this._options.isFactory&&typeof this._targetValue=="function"){const w=this._targetValue({sdk:r,...o});s.swap(w)}else s.swap(this._targetValue);this._installedInstances.set(r,s)}}uninstall({sdk:r}){const o=this._installedInstances.get(r);o&&(o.restore(),this._installedInstances.delete(r))}}var Dn=Object.defineProperty,Fn=(i,r,o)=>r in i?Dn(i,r,{enumerable:!0,configurable:!0,writable:!0,value:o}):i[r]=o,Ge=(i,r,o)=>Fn(i,typeof r!="symbol"?r+"":r,o);let Gt=class{constructor(i,r){Ge(this,"_target"),Ge(this,"_key"),Ge(this,"_oldValue"),Ge(this,"_wasDefined",!1),Ge(this,"_isSwapped",!1),this._target=i,this._key=r,this._oldValue=this._target[this._key]}get isSwapped(){return this._isSwapped}get originalValue(){return this._oldValue}get value(){return this._target[this._key]}get target(){return this._target}restore(){this.isSwapped&&(this._wasDefined?this._target[this._key]=this._oldValue:delete this._target[this._key],this._isSwapped=!1)}swap(i){this.isSwapped||(this._wasDefined=Object.hasOwn(this._target,this._key),this._oldValue=this._target[this._key]),this._target[this._key]=i,this._isSwapped=!0}};function vt(){return"unsafeWindow"in window?window.unsafeWindow:window}async function Vn(i){const r=[],o=new Gt(vt().W.model.actionManager,"add");o.swap(s=>{r.push(s)});try{await i()}finally{o.restore()}return r}function Cn(i){return i.memoizedProps||{}}function zn(i){return typeof i=="object"&&i!==null&&"memoizedState"in i&&Array.isArray(i.memoizedState)&&i.memoizedState.length===2&&"queue"in i&&i.queue===null&&Array.isArray(i.memoizedState[1])}function Kn(i){return typeof i=="object"&&i!==null&&"memoizedState"in i&&typeof i.memoizedState=="object"&&i.memoizedState!==null&&"current"in i.memoizedState&&"queue"in i&&i.queue===null}function Wn(i){return typeof i=="object"&&i!==null&&"memoizedState"in i&&"queue"in i&&typeof i.queue=="object"&&i.queue!==null&&"dispatch"in i.queue&&typeof i.queue.dispatch=="function"}function Nn(i){return Wn(i)?{type:"useState",value:i.memoizedState,dispatch:i.queue.dispatch}:zn(i)?{type:"useMemo",value:i.memoizedState[0],dependencies:i.memoizedState[1]}:Kn(i)?{type:"useRef",current:i.memoizedState}:null}function Hn(i,r){const o=[];let s=i.memoizedState;for(;s;){const w=Nn(s);w&&o.push(w),s=s.next}return o}function Un(i,r,o=1/0){let s=i,w=0;for(;s&&w<o;){const g=s.memoizedState?Hn(s):[],I=Cn(s),S={fiber:s,hooks:{all:g,useState:g.filter(E=>E.type==="useState"),useMemo:g.filter(E=>E.type==="useMemo"),useRef:g.filter(E=>E.type==="useRef")},props:I};if(r(S))return S;s=s.return,w++}return null}const Ln="__reactFiber$";function qn(i){const r=Object.keys(i).find(s=>s.startsWith(Ln));if(!r)throw new Error(`No fiber key found for element: ${i}`);const o=i[r];if(!o)throw new Error(`No fiber found for element: ${i}`);return o}const Gn=i=>new Promise(r=>{const o=vt(),s=new Gt(o.W.map.olMap,"addControl");s.swap(w=>{i==null||i(w),r(w),s.restore()})});function Bn(i){const r=vt(),o=r.W.userscripts.toOLGeometry(i);return new r.OpenLayers.Feature.Vector(o)}async function Jn(i,r){const o=Un(qn(i),g=>"onClick"in g.props&&typeof g.props.onClick=="function");if(!o)throw new Error("No fiber found with draw initiator");const{onClick:s}=o.props;//! OpenLayers dependent code below - implementation might change over time
const w=Gn(g=>{g.activate=()=>{}});s(new Event("click")),(await w).events.triggerEvent("featureadded",{feature:Bn(r)})}var Zn=Object.defineProperty,Yn=(i,r,o)=>r in i?Zn(i,r,{enumerable:!0,configurable:!0,writable:!0,value:o}):i[r]=o,Bt=(i,r,o)=>Yn(i,typeof r!="symbol"?r+"":r,o);function Qn(){return"unsafeWindow"in window?window.unsafeWindow:window}var Xn=Object.defineProperty,ei=(i,r,o)=>r in i?Xn(i,r,{enumerable:!0,configurable:!0,writable:!0,value:o}):i[r]=o,Fe=(i,r,o)=>ei(i,typeof r!="symbol"?r+"":r,o);let ti=class{constructor(r,o){Fe(this,"_target"),Fe(this,"_key"),Fe(this,"_oldValue"),Fe(this,"_wasDefined",!1),Fe(this,"_isSwapped",!1),this._target=r,this._key=o,this._oldValue=this._target[this._key]}get isSwapped(){return this._isSwapped}get originalValue(){return this._oldValue}get value(){return this._target[this._key]}get target(){return this._target}restore(){this.isSwapped&&(this._wasDefined?this._target[this._key]=this._oldValue:delete this._target[this._key],this._isSwapped=!1)}swap(r){this.isSwapped||(this._wasDefined=Object.hasOwn(this._target,this._key),this._oldValue=this._target[this._key]),this._target[this._key]=r,this._isSwapped=!0}},ri=class{constructor(r,o,s){Fe(this,"_enabled",!1),Fe(this,"_fnSwapper"),Fe(this,"_interceptionFunction"),Fe(this,"_middlewares",[]),this._fnSwapper=new ti(r,o),this._interceptionFunction=s}get enabled(){return this._fnSwapper.isSwapped&&this._enabled}disable(){this._enabled=!1,this.enabled}restore(){this._fnSwapper.restore()}enable(){this._enabled=!0,this._fnSwapper.isSwapped||this.swapToInterceptor()}swapToInterceptor(){const r=this;this._fnSwapper.swap(function(...o){if(!r._enabled)return r.callOriginalInvocator(...o);const s=r.runMiddlewares(o);if(s){if("output"in s)return s.output;"input"in s&&(o=s.input)}return r._interceptionFunction.call(this,r.getOriginalInvocator(this),...o)})}getOriginalInvocator(r){return this._fnSwapper.originalValue.bind(r??this._fnSwapper.target)}callOriginalInvocator(...r){return this.getOriginalInvocator()(...r)}runMiddlewares(r){for(const o of this._middlewares){const s=o(...r);if(s){if("output"in s)return s;"input"in s&&(r=s.input)}}return{input:r}}registerMiddleware(r){this._middlewares.push(r)}},ni=class{constructor(r){Bt(this,"_fetchInterceptor"),Bt(this,"_interceptionFilters",new Set),this._fetchInterceptor=new ri(r,"fetch",(o,s,w)=>{for(const g of this._interceptionFilters)if(g.shouldIntercept(s,w))return this.shouldKeepFilter(g,s,w)||this.removeInterceptionFilter(g),g.intercept(s,w);return o(s,w)})}enable(){this._fetchInterceptor.enable()}disable(){this._fetchInterceptor.disable()}addInterceptionFilter(r){this.enable(),this._interceptionFilters.add(r)}removeInterceptionFilter(r){this._interceptionFilters.delete(r)}shouldKeepFilter(r,o,s){return typeof r.shouldKeep=="function"?r.shouldKeep(o,s):typeof r.shouldKeep=="boolean"?r.shouldKeep:!1}};new ni(Qn());function ii(i,r,o={}){const s={type:"Feature"};return(o.id===0||o.id)&&(s.id=o.id),o.bbox&&(s.bbox=o.bbox),s.properties={},s.geometry=i,s}function oi(i,r,o={}){for(const s of i){if(s.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");if(s[s.length-1].length!==s[0].length)throw new Error("First and last Position are not equivalent.");for(let w=0;w<s[s.length-1].length;w++)if(s[s.length-1][w]!==s[0][w])throw new Error("First and last Position are not equivalent.")}return ii({type:"Polygon",coordinates:i},r,o)}function at(){return"unsafeWindow"in window?window.unsafeWindow:window}function ai(i,r,o){const s=new i(o),w=new r(s);return at().W.model.actionManager.add(w),s}function Jt(i){return at().W.model.permanentHazards.getObjectById(i)}function si(i,r){const o=at().require("Waze/Action/UpdateObject");return new o(i,r)}function ui(i,r){at().W.model.actionManager.add(si(i,r))}function ci(i){return Object.fromEntries(Object.entries(i).filter(([,r])=>r!==void 0))}let gt,bt;const fi=[{async install(){const i=document.querySelector("#drawer wz-menu > wz-menu-sub-menu:nth-child(3) > wz-menu-item:nth-of-type(2)");if(!i||!(i instanceof HTMLElement))throw new Error("Unable to find school zone drawing menu item");const[r]=await Vn(async()=>{await Jn(i,oi([[[0,0],[0,1],[1,1],[0,0]]]).geometry)});if(r.actionName!=="ADD_PERMANENT_HAZARD")throw new Error("Unexpected action discovered when tried to resolve AddPermanentHazard action: "+r.actionName);const o=r.object;if(!o)throw new Error("Unexpected state: Added object does not exist");if(o.type!=="permanentHazard")throw new Error("Unexpected state: Expected the added object to be a PermanentHazard instead of "+r.type);gt=r.constructor,bt=o.constructor}},new _t("DataModel.PermanentHazards.addSchoolZone",i=>{if(!bt||!gt)throw new Error("PermanentHazard or AddPermanentHazard are not initialized. Make sure to await the enhancedSDK function before using it.");return ai(bt,gt,{type:9,geoJSONGeometry:i.geometry,name:i.name,speedLimit:i.speedLimit,excludedRoadTypes:i.excludedRoadTypes}).getID()}),new _t("DataModel.PermanentHazards.updateSchoolZone",({sdkInstance:i})=>r=>{const o=Jt(r.schoolZoneId);if(!o||o.getAttribute("type")!==9)throw new i.Errors.DataModelNotFoundError("permanentHazard.SchoolZone",r.schoolZoneId);ui(o,ci({geoJSONGeometry:r.geometry,name:r.name,speedLimit:r.speedLimit,excludedRoadTypes:r.excludedRoadTypes}))},{isFactory:!0}),new _t("DataModel.PermanentHazards.getSchoolZoneById",()=>i=>{const r=Jt(i.schoolZoneId);return!r||r.getAttribute("type")!==9?null:r},{isFactory:!0})];var li=Object.defineProperty,hi=(i,r,o)=>r in i?li(i,r,{enumerable:!0,configurable:!0,writable:!0,value:o}):i[r]=o,st=(i,r,o)=>hi(i,typeof r!="symbol"?r+"":r,o),Zt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Yt={};/*! *****************************************************************************
  Copyright (C) Microsoft. All rights reserved.
  Licensed under the Apache License, Version 2.0 (the "License"); you may not use
  this file except in compliance with the License. You may obtain a copy of the
  License at http://www.apache.org/licenses/LICENSE-2.0

  THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
  WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
  MERCHANTABLITY OR NON-INFRINGEMENT.

  See the Apache Version 2.0 License for specific language governing permissions
  and limitations under the License.
  ***************************************************************************** */var Qt;function di(){if(Qt)return Yt;Qt=1;var i;return function(r){(function(o){var s=typeof globalThis=="object"?globalThis:typeof Zt=="object"?Zt:typeof self=="object"?self:typeof this=="object"?this:E(),w=g(r);typeof s.Reflect<"u"&&(w=g(s.Reflect,w)),o(w,s),typeof s.Reflect>"u"&&(s.Reflect=r);function g($,T){return function(j,R){Object.defineProperty($,j,{configurable:!0,writable:!0,value:R}),T&&T(j,R)}}function I(){try{return Function("return this;")()}catch{}}function S(){try{return(0,eval)("(function() { return this; })()")}catch{}}function E(){return I()||S()}})(function(o,s){var w=Object.prototype.hasOwnProperty,g=typeof Symbol=="function",I=g&&typeof Symbol.toPrimitive<"u"?Symbol.toPrimitive:"@@toPrimitive",S=g&&typeof Symbol.iterator<"u"?Symbol.iterator:"@@iterator",E=typeof Object.create=="function",$={__proto__:[]}instanceof Array,T=!E&&!$,j={create:E?function(){return L(Object.create(null))}:$?function(){return L({__proto__:null})}:function(){return L({})},has:T?function(e,t){return w.call(e,t)}:function(e,t){return t in e},get:T?function(e,t){return w.call(e,t)?e[t]:void 0}:function(e,t){return e[t]}},R=Object.getPrototypeOf(Function),A=typeof Map=="function"&&typeof Map.prototype.entries=="function"?Map:Ie(),W=typeof Set=="function"&&typeof Set.prototype.entries=="function"?Set:Pe(),K=typeof WeakMap=="function"?WeakMap:xe(),P=g?Symbol.for("@reflect-metadata:registry"):void 0,V=Ee(),J=je(V);function we(e,t,n,a){if(d(n)){if(!ae(e))throw new TypeError;if(!se(t))throw new TypeError;return ve(e,t)}else{if(!ae(e))throw new TypeError;if(!b(t))throw new TypeError;if(!b(a)&&!d(a)&&!x(a))throw new TypeError;return x(a)&&(a=void 0),n=M(n),ge(e,t,n,a)}}o("decorate",we);function F(e,t){function n(a,h){if(!b(a))throw new TypeError;if(!d(h)&&!Se(h))throw new TypeError;te(e,t,a,h)}return n}o("metadata",F);function C(e,t,n,a){if(!b(n))throw new TypeError;return d(a)||(a=M(a)),te(e,t,n,a)}o("defineMetadata",C);function q(e,t,n){if(!b(t))throw new TypeError;return d(n)||(n=M(n)),Q(e,t,n)}o("hasMetadata",q);function G(e,t,n){if(!b(t))throw new TypeError;return d(n)||(n=M(n)),N(e,t,n)}o("hasOwnMetadata",G);function ye(e,t,n){if(!b(t))throw new TypeError;return d(n)||(n=M(n)),X(e,t,n)}o("getMetadata",ye);function Z(e,t,n){if(!b(t))throw new TypeError;return d(n)||(n=M(n)),ee(e,t,n)}o("getOwnMetadata",Z);function Y(e,t){if(!b(e))throw new TypeError;return d(t)||(t=M(t)),re(e,t)}o("getMetadataKeys",Y);function pe(e,t){if(!b(e))throw new TypeError;return d(t)||(t=M(t)),ne(e,t)}o("getOwnMetadataKeys",pe);function _e(e,t,n){if(!b(t))throw new TypeError;if(d(n)||(n=M(n)),!b(t))throw new TypeError;d(n)||(n=M(n));var a=D(t,n,!1);return d(a)?!1:a.OrdinaryDeleteMetadata(e,t,n)}o("deleteMetadata",_e);function ve(e,t){for(var n=e.length-1;n>=0;--n){var a=e[n],h=a(t);if(!d(h)&&!x(h)){if(!se(h))throw new TypeError;t=h}}return t}function ge(e,t,n,a){for(var h=e.length-1;h>=0;--h){var k=e[h],m=k(t,n,a);if(!d(m)&&!x(m)){if(!b(m))throw new TypeError;a=m}}return a}function Q(e,t,n){var a=N(e,t,n);if(a)return!0;var h=U(t);return x(h)?!1:Q(e,h,n)}function N(e,t,n){var a=D(t,n,!1);return d(a)?!1:oe(a.OrdinaryHasOwnMetadata(e,t,n))}function X(e,t,n){var a=N(e,t,n);if(a)return ee(e,t,n);var h=U(t);if(!x(h))return X(e,h,n)}function ee(e,t,n){var a=D(t,n,!1);if(!d(a))return a.OrdinaryGetOwnMetadata(e,t,n)}function te(e,t,n,a){var h=D(n,a,!0);h.OrdinaryDefineOwnMetadata(e,t,n,a)}function re(e,t){var n=ne(e,t),a=U(e);if(a===null)return n;var h=re(a,t);if(h.length<=0)return n;if(n.length<=0)return h;for(var k=new W,m=[],p=0,u=n;p<u.length;p++){var c=u[p],f=k.has(c);f||(k.add(c),m.push(c))}for(var l=0,y=h;l<y.length;l++){var c=y[l],f=k.has(c);f||(k.add(c),m.push(c))}return m}function ne(e,t){var n=D(e,t,!1);return n?n.OrdinaryOwnMetadataKeys(e,t):[]}function ie(e){if(e===null)return 1;switch(typeof e){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return e===null?1:6;default:return 6}}function d(e){return e===void 0}function x(e){return e===null}function be(e){return typeof e=="symbol"}function b(e){return typeof e=="object"?e!==null:typeof e=="function"}function me(e,t){switch(ie(e)){case 0:return e;case 1:return e;case 2:return e;case 3:return e;case 4:return e;case 5:return e}var n="string",a=ue(e,I);if(a!==void 0){var h=a.call(e,n);if(b(h))throw new TypeError;return h}return ke(e)}function ke(e,t){var n,a;{var h=e.toString;if(z(h)){var a=h.call(e);if(!b(a))return a}var n=e.valueOf;if(z(n)){var a=n.call(e);if(!b(a))return a}}throw new TypeError}function oe(e){return!!e}function Oe(e){return""+e}function M(e){var t=me(e);return be(t)?t:Oe(t)}function ae(e){return Array.isArray?Array.isArray(e):e instanceof Object?e instanceof Array:Object.prototype.toString.call(e)==="[object Array]"}function z(e){return typeof e=="function"}function se(e){return typeof e=="function"}function Se(e){switch(ie(e)){case 3:return!0;case 4:return!0;default:return!1}}function H(e,t){return e===t||e!==e&&t!==t}function ue(e,t){var n=e[t];if(n!=null){if(!z(n))throw new TypeError;return n}}function ce(e){var t=ue(e,S);if(!z(t))throw new TypeError;var n=t.call(e);if(!b(n))throw new TypeError;return n}function fe(e){return e.value}function le(e){var t=e.next();return t.done?!1:t}function he(e){var t=e.return;t&&t.call(e)}function U(e){var t=Object.getPrototypeOf(e);if(typeof e!="function"||e===R||t!==R)return t;var n=e.prototype,a=n&&Object.getPrototypeOf(n);if(a==null||a===Object.prototype)return t;var h=a.constructor;return typeof h!="function"||h===e?t:h}function Me(){var e;!d(P)&&typeof s.Reflect<"u"&&!(P in s.Reflect)&&typeof s.Reflect.defineMetadata=="function"&&(e=Te(s.Reflect));var t,n,a,h=new K,k={registerProvider:m,getProvider:u,setProvider:f};return k;function m(l){if(!Object.isExtensible(k))throw new Error("Cannot add provider to a frozen registry.");switch(!0){case e===l:break;case d(t):t=l;break;case t===l:break;case d(n):n=l;break;case n===l:break;default:a===void 0&&(a=new W),a.add(l);break}}function p(l,y){if(!d(t)){if(t.isProviderFor(l,y))return t;if(!d(n)){if(n.isProviderFor(l,y))return t;if(!d(a))for(var _=ce(a);;){var v=le(_);if(!v)return;var O=fe(v);if(O.isProviderFor(l,y))return he(_),O}}}if(!d(e)&&e.isProviderFor(l,y))return e}function u(l,y){var _=h.get(l),v;return d(_)||(v=_.get(y)),d(v)&&(v=p(l,y),d(v)||(d(_)&&(_=new A,h.set(l,_)),_.set(y,v))),v}function c(l){if(d(l))throw new TypeError;return t===l||n===l||!d(a)&&a.has(l)}function f(l,y,_){if(!c(_))throw new Error("Metadata provider not registered.");var v=u(l,y);if(v!==_){if(!d(v))return!1;var O=h.get(l);d(O)&&(O=new A,h.set(l,O)),O.set(y,_)}return!0}}function Ee(){var e;return!d(P)&&b(s.Reflect)&&Object.isExtensible(s.Reflect)&&(e=s.Reflect[P]),d(e)&&(e=Me()),!d(P)&&b(s.Reflect)&&Object.isExtensible(s.Reflect)&&Object.defineProperty(s.Reflect,P,{enumerable:!1,configurable:!1,writable:!1,value:e}),e}function je(e){var t=new K,n={isProviderFor:function(c,f){var l=t.get(c);return d(l)?!1:l.has(f)},OrdinaryDefineOwnMetadata:m,OrdinaryHasOwnMetadata:h,OrdinaryGetOwnMetadata:k,OrdinaryOwnMetadataKeys:p,OrdinaryDeleteMetadata:u};return V.registerProvider(n),n;function a(c,f,l){var y=t.get(c),_=!1;if(d(y)){if(!l)return;y=new A,t.set(c,y),_=!0}var v=y.get(f);if(d(v)){if(!l)return;if(v=new A,y.set(f,v),!e.setProvider(c,f,n))throw y.delete(f),_&&t.delete(c),new Error("Wrong provider for target.")}return v}function h(c,f,l){var y=a(f,l,!1);return d(y)?!1:oe(y.has(c))}function k(c,f,l){var y=a(f,l,!1);if(!d(y))return y.get(c)}function m(c,f,l,y){var _=a(l,y,!0);_.set(c,f)}function p(c,f){var l=[],y=a(c,f,!1);if(d(y))return l;for(var _=y.keys(),v=ce(_),O=0;;){var de=le(v);if(!de)return l.length=O,l;var Re=fe(de);try{l[O]=Re}catch(Ae){try{he(v)}finally{throw Ae}}O++}}function u(c,f,l){var y=a(f,l,!1);if(d(y)||!y.delete(c))return!1;if(y.size===0){var _=t.get(f);d(_)||(_.delete(l),_.size===0&&t.delete(_))}return!0}}function Te(e){var t=e.defineMetadata,n=e.hasOwnMetadata,a=e.getOwnMetadata,h=e.getOwnMetadataKeys,k=e.deleteMetadata,m=new K,p={isProviderFor:function(u,c){var f=m.get(u);return!d(f)&&f.has(c)?!0:h(u,c).length?(d(f)&&(f=new W,m.set(u,f)),f.add(c),!0):!1},OrdinaryDefineOwnMetadata:t,OrdinaryHasOwnMetadata:n,OrdinaryGetOwnMetadata:a,OrdinaryOwnMetadataKeys:h,OrdinaryDeleteMetadata:k};return p}function D(e,t,n){var a=V.getProvider(e,t);if(!d(a))return a;if(n){if(V.setProvider(e,t,J))return J;throw new Error("Illegal state.")}}function Ie(){var e={},t=[],n=function(){function p(u,c,f){this._index=0,this._keys=u,this._values=c,this._selector=f}return p.prototype["@@iterator"]=function(){return this},p.prototype[S]=function(){return this},p.prototype.next=function(){var u=this._index;if(u>=0&&u<this._keys.length){var c=this._selector(this._keys[u],this._values[u]);return u+1>=this._keys.length?(this._index=-1,this._keys=t,this._values=t):this._index++,{value:c,done:!1}}return{value:void 0,done:!0}},p.prototype.throw=function(u){throw this._index>=0&&(this._index=-1,this._keys=t,this._values=t),u},p.prototype.return=function(u){return this._index>=0&&(this._index=-1,this._keys=t,this._values=t),{value:u,done:!0}},p}(),a=function(){function p(){this._keys=[],this._values=[],this._cacheKey=e,this._cacheIndex=-2}return Object.defineProperty(p.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),p.prototype.has=function(u){return this._find(u,!1)>=0},p.prototype.get=function(u){var c=this._find(u,!1);return c>=0?this._values[c]:void 0},p.prototype.set=function(u,c){var f=this._find(u,!0);return this._values[f]=c,this},p.prototype.delete=function(u){var c=this._find(u,!1);if(c>=0){for(var f=this._keys.length,l=c+1;l<f;l++)this._keys[l-1]=this._keys[l],this._values[l-1]=this._values[l];return this._keys.length--,this._values.length--,H(u,this._cacheKey)&&(this._cacheKey=e,this._cacheIndex=-2),!0}return!1},p.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=e,this._cacheIndex=-2},p.prototype.keys=function(){return new n(this._keys,this._values,h)},p.prototype.values=function(){return new n(this._keys,this._values,k)},p.prototype.entries=function(){return new n(this._keys,this._values,m)},p.prototype["@@iterator"]=function(){return this.entries()},p.prototype[S]=function(){return this.entries()},p.prototype._find=function(u,c){if(!H(this._cacheKey,u)){this._cacheIndex=-1;for(var f=0;f<this._keys.length;f++)if(H(this._keys[f],u)){this._cacheIndex=f;break}}return this._cacheIndex<0&&c&&(this._cacheIndex=this._keys.length,this._keys.push(u),this._values.push(void 0)),this._cacheIndex},p}();return a;function h(p,u){return p}function k(p,u){return u}function m(p,u){return[p,u]}}function Pe(){var e=function(){function t(){this._map=new A}return Object.defineProperty(t.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),t.prototype.has=function(n){return this._map.has(n)},t.prototype.add=function(n){return this._map.set(n,n),this},t.prototype.delete=function(n){return this._map.delete(n)},t.prototype.clear=function(){this._map.clear()},t.prototype.keys=function(){return this._map.keys()},t.prototype.values=function(){return this._map.keys()},t.prototype.entries=function(){return this._map.entries()},t.prototype["@@iterator"]=function(){return this.keys()},t.prototype[S]=function(){return this.keys()},t}();return e}function xe(){var e=16,t=j.create(),n=a();return function(){function u(){this._key=a()}return u.prototype.has=function(c){var f=h(c,!1);return f!==void 0?j.has(f,this._key):!1},u.prototype.get=function(c){var f=h(c,!1);return f!==void 0?j.get(f,this._key):void 0},u.prototype.set=function(c,f){var l=h(c,!0);return l[this._key]=f,this},u.prototype.delete=function(c){var f=h(c,!1);return f!==void 0?delete f[this._key]:!1},u.prototype.clear=function(){this._key=a()},u}();function a(){var u;do u="@@WeakMap@@"+p();while(j.has(t,u));return t[u]=!0,u}function h(u,c){if(!w.call(u,n)){if(!c)return;Object.defineProperty(u,n,{value:j.create()})}return u[n]}function k(u,c){for(var f=0;f<c;++f)u[f]=Math.random()*255|0;return u}function m(u){if(typeof Uint8Array=="function"){var c=new Uint8Array(u);return typeof crypto<"u"?crypto.getRandomValues(c):typeof msCrypto<"u"?msCrypto.getRandomValues(c):k(c,u),c}return k(new Array(u),u)}function p(){var u=m(e);u[6]=u[6]&79|64,u[8]=u[8]&191|128;for(var c="",f=0;f<e;++f){var l=u[f];(f===4||f===6||f===8)&&(c+="-"),l<16&&(c+="0"),c+=l.toString(16).toLowerCase()}return c}}function L(e){return e.__=void 0,delete e.__,e}})}(i||(i={})),Yt}di();var pi=Object.defineProperty,yi=(i,r,o)=>r in i?pi(i,r,{enumerable:!0,configurable:!0,writable:!0,value:o}):i[r]=o,Be=(i,r,o)=>yi(i,typeof r!="symbol"?r+"":r,o);let wi=class{constructor(r,o){Be(this,"_target"),Be(this,"_key"),Be(this,"_oldValue"),Be(this,"_wasDefined",!1),Be(this,"_isSwapped",!1),this._target=r,this._key=o,this._oldValue=this._target[this._key]}get isSwapped(){return this._isSwapped}get originalValue(){return this._oldValue}get value(){return this._target[this._key]}get target(){return this._target}restore(){this.isSwapped&&(this._wasDefined?this._target[this._key]=this._oldValue:delete this._target[this._key],this._isSwapped=!1)}swap(r){this.isSwapped||(this._wasDefined=Object.hasOwn(this._target,this._key),this._oldValue=this._target[this._key]),this._target[this._key]=r,this._isSwapped=!0}};const _i={onlyIfNotExists:!0,isFactory:!1};let vi=class{constructor(r,o,s={}){if(st(this,"_installedInstances",new Map),st(this,"_path"),st(this,"_targetValue"),st(this,"_options"),this._path=r.split("."),this._path.length===0)throw new Error("Path must not be empty");this._targetValue=o,this._options={..._i,...s}}_getTargetObject(r){let o=r;for(const s of this._path.slice(0,this._path.length-1))o[s]||(o[s]={}),o=o[s];return o}_createSwapper(r){const o=this._getTargetObject(r);return new wi(o,this._path.at(-1))}install({sdk:r,...o}){if(this._installedInstances.has(r))return;const s=this._createSwapper(r);if(!(s.value&&this._options.onlyIfNotExists)){if(this._options.isFactory&&typeof this._targetValue=="function"){const w=this._targetValue({sdk:r,...o});s.swap(w)}else s.swap(this._targetValue);this._installedInstances.set(r,s)}}uninstall({sdk:r}){const o=this._installedInstances.get(r);o&&(o.restore(),this._installedInstances.delete(r))}};const Xt=Symbol("BigJunction"),er=Symbol("AddBigJunction");function gi(){return"unsafeWindow"in window?window.unsafeWindow:window}function bi(i,r,o){const s=new i(o),w=new r(s);return gi().W.model.actionManager.add(w),s}const mi=[new vi("DataModel.BigJunctions.addBigJunction",({artifacts:i})=>r=>bi(i[Xt],i[er],{geoJSONGeometry:r.geometry}).getID(),{isFactory:!0})];function ki(i,r,o={}){const s={type:"Feature"};return(o.id===0||o.id)&&(s.id=o.id),o.bbox&&(s.bbox=o.bbox),s.properties={},s.geometry=i,s}function Oi(i,r,o={}){for(const s of i){if(s.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");if(s[s.length-1].length!==s[0].length)throw new Error("First and last Position are not equivalent.");for(let w=0;w<s[s.length-1].length;w++)if(s[s.length-1][w]!==s[0][w])throw new Error("First and last Position are not equivalent.")}return ki({type:"Polygon",coordinates:i},r,o)}var Si=Object.defineProperty,Mi=(i,r,o)=>r in i?Si(i,r,{enumerable:!0,configurable:!0,writable:!0,value:o}):i[r]=o,Je=(i,r,o)=>Mi(i,typeof r!="symbol"?r+"":r,o);let tr=class{constructor(r,o){Je(this,"_target"),Je(this,"_key"),Je(this,"_oldValue"),Je(this,"_wasDefined",!1),Je(this,"_isSwapped",!1),this._target=r,this._key=o,this._oldValue=this._target[this._key]}get isSwapped(){return this._isSwapped}get originalValue(){return this._oldValue}get value(){return this._target[this._key]}get target(){return this._target}restore(){this.isSwapped&&(this._wasDefined?this._target[this._key]=this._oldValue:delete this._target[this._key],this._isSwapped=!1)}swap(r){this.isSwapped||(this._wasDefined=Object.hasOwn(this._target,this._key),this._oldValue=this._target[this._key]),this._target[this._key]=r,this._isSwapped=!0}};function mt(){return"unsafeWindow"in window?window.unsafeWindow:window}async function Ei(i){const r=[],o=new tr(mt().W.model.actionManager,"add");o.swap(s=>{r.push(s)});try{await i()}finally{o.restore()}return r}function ji(i){return i.memoizedProps||{}}function Ti(i){return typeof i=="object"&&i!==null&&"memoizedState"in i&&Array.isArray(i.memoizedState)&&i.memoizedState.length===2&&"queue"in i&&i.queue===null&&Array.isArray(i.memoizedState[1])}function Ii(i){return typeof i=="object"&&i!==null&&"memoizedState"in i&&typeof i.memoizedState=="object"&&i.memoizedState!==null&&"current"in i.memoizedState&&"queue"in i&&i.queue===null}function Pi(i){return typeof i=="object"&&i!==null&&"memoizedState"in i&&"queue"in i&&typeof i.queue=="object"&&i.queue!==null&&"dispatch"in i.queue&&typeof i.queue.dispatch=="function"}function xi(i){return Pi(i)?{type:"useState",value:i.memoizedState,dispatch:i.queue.dispatch}:Ti(i)?{type:"useMemo",value:i.memoizedState[0],dependencies:i.memoizedState[1]}:Ii(i)?{type:"useRef",current:i.memoizedState}:null}function Ri(i,r){const o=[];let s=i.memoizedState;for(;s;){const w=xi(s);w&&o.push(w),s=s.next}return o}function Ai(i,r,o=1/0){let s=i,w=0;for(;s&&w<o;){const g=s.memoizedState?Ri(s):[],I=ji(s),S={fiber:s,hooks:{all:g,useState:g.filter(E=>E.type==="useState"),useMemo:g.filter(E=>E.type==="useMemo"),useRef:g.filter(E=>E.type==="useRef")},props:I};if(r(S))return S;s=s.return,w++}return null}const $i="__reactFiber$";function Di(i){const r=Object.keys(i).find(s=>s.startsWith($i));if(!r)throw new Error(`No fiber key found for element: ${i}`);const o=i[r];if(!o)throw new Error(`No fiber found for element: ${i}`);return o}const Fi=i=>new Promise(r=>{const o=mt(),s=new tr(o.W.map.olMap,"addControl");s.swap(w=>{i==null||i(w),r(w),s.restore()})});function Vi(i){const r=mt(),o=r.W.userscripts.toOLGeometry(i);return new r.OpenLayers.Feature.Vector(o)}async function Ci(i,r){const o=Ai(Di(i),g=>"onClick"in g.props&&typeof g.props.onClick=="function");if(!o)throw new Error("No fiber found with draw initiator");const{onClick:s}=o.props;//! OpenLayers dependent code below - implementation might change over time
const w=Fi(g=>{g.activate=()=>{}});s(new Event("click")),(await w).events.triggerEvent("featureadded",{feature:Vi(r)})}var zi=Object.defineProperty,Ki=(i,r,o)=>r in i?zi(i,r,{enumerable:!0,configurable:!0,writable:!0,value:o}):i[r]=o,rr=(i,r,o)=>Ki(i,typeof r!="symbol"?r+"":r,o);function Wi(){return"unsafeWindow"in window?window.unsafeWindow:window}var Ni=Object.defineProperty,Hi=(i,r,o)=>r in i?Ni(i,r,{enumerable:!0,configurable:!0,writable:!0,value:o}):i[r]=o,Ve=(i,r,o)=>Hi(i,typeof r!="symbol"?r+"":r,o);let Ui=class{constructor(r,o){Ve(this,"_target"),Ve(this,"_key"),Ve(this,"_oldValue"),Ve(this,"_wasDefined",!1),Ve(this,"_isSwapped",!1),this._target=r,this._key=o,this._oldValue=this._target[this._key]}get isSwapped(){return this._isSwapped}get originalValue(){return this._oldValue}get value(){return this._target[this._key]}get target(){return this._target}restore(){this.isSwapped&&(this._wasDefined?this._target[this._key]=this._oldValue:delete this._target[this._key],this._isSwapped=!1)}swap(r){this.isSwapped||(this._wasDefined=Object.hasOwn(this._target,this._key),this._oldValue=this._target[this._key]),this._target[this._key]=r,this._isSwapped=!0}},Li=class{constructor(r,o,s){Ve(this,"_enabled",!1),Ve(this,"_fnSwapper"),Ve(this,"_interceptionFunction"),Ve(this,"_middlewares",[]),this._fnSwapper=new Ui(r,o),this._interceptionFunction=s}get enabled(){return this._fnSwapper.isSwapped&&this._enabled}disable(){this._enabled=!1,this.enabled}restore(){this._fnSwapper.restore()}enable(){this._enabled=!0,this._fnSwapper.isSwapped||this.swapToInterceptor()}swapToInterceptor(){const r=this;this._fnSwapper.swap(function(...o){if(!r._enabled)return r.callOriginalInvocator(...o);const s=r.runMiddlewares(o);if(s){if("output"in s)return s.output;"input"in s&&(o=s.input)}return r._interceptionFunction.call(this,r.getOriginalInvocator(this),...o)})}getOriginalInvocator(r){return this._fnSwapper.originalValue.bind(r??this._fnSwapper.target)}callOriginalInvocator(...r){return this.getOriginalInvocator()(...r)}runMiddlewares(r){for(const o of this._middlewares){const s=o(...r);if(s){if("output"in s)return s;"input"in s&&(r=s.input)}}return{input:r}}registerMiddleware(r){this._middlewares.push(r)}},qi=class{constructor(r){rr(this,"_fetchInterceptor"),rr(this,"_interceptionFilters",new Set),this._fetchInterceptor=new Li(r,"fetch",(o,s,w)=>{for(const g of this._interceptionFilters)if(g.shouldIntercept(s,w))return this.shouldKeepFilter(g,s,w)||this.removeInterceptionFilter(g),g.intercept(s,w);return o(s,w)})}enable(){this._fetchInterceptor.enable()}disable(){this._fetchInterceptor.disable()}addInterceptionFilter(r){this.enable(),this._interceptionFilters.add(r)}removeInterceptionFilter(r){this._interceptionFilters.delete(r)}shouldKeepFilter(r,o,s){return typeof r.shouldKeep=="function"?r.shouldKeep(o,s):typeof r.shouldKeep=="boolean"?r.shouldKeep:!1}};new qi(Wi());const Gi=[{async install(){const i=document.querySelector("#drawer wz-menu > wz-menu-sub-menu:nth-child(1) > wz-menu-item:nth-of-type(4)");if(!i||!(i instanceof HTMLElement))throw new Error("Unable to find school zone drawing menu item");const[r]=await Ei(async()=>{await Ci(i,Oi([[[0,0],[0,1],[1,1],[0,0]]]).geometry)});if(r.actionName!=="ADD_BIG_JUNCTION")throw new Error("Unexpected action discovered when tried to resolve AddBigJunction action: "+r.actionName);const o=r.bigJunction;if(!o)throw new Error("Unexpected state: Added object does not exist");if(o.type!=="bigJunction")throw new Error("Unexpected state: Expected the added object to be a BigJunction instead of "+r.type);return{[Xt]:o.constructor,[er]:r.constructor}}}],Bi=[...Gi,...mi];var Ji=Object.defineProperty,Zi=(i,r,o)=>r in i?Ji(i,r,{enumerable:!0,configurable:!0,writable:!0,value:o}):i[r]=o,B=(i,r,o)=>Zi(i,typeof r!="symbol"?r+"":r,o),Yi=Object.defineProperty,Qi=(i,r,o)=>r in i?Yi(i,r,{enumerable:!0,configurable:!0,writable:!0,value:o}):i[r]=o,ut=(i,r,o)=>Qi(i,typeof r!="symbol"?r+"":r,o),nr=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},ir={};/*! *****************************************************************************
  Copyright (C) Microsoft. All rights reserved.
  Licensed under the Apache License, Version 2.0 (the "License"); you may not use
  this file except in compliance with the License. You may obtain a copy of the
  License at http://www.apache.org/licenses/LICENSE-2.0

  THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
  WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
  MERCHANTABLITY OR NON-INFRINGEMENT.

  See the Apache Version 2.0 License for specific language governing permissions
  and limitations under the License.
  ***************************************************************************** */var or;function Xi(){if(or)return ir;or=1;var i;return function(r){(function(o){var s=typeof globalThis=="object"?globalThis:typeof nr=="object"?nr:typeof self=="object"?self:typeof this=="object"?this:E(),w=g(r);typeof s.Reflect<"u"&&(w=g(s.Reflect,w)),o(w,s),typeof s.Reflect>"u"&&(s.Reflect=r);function g($,T){return function(j,R){Object.defineProperty($,j,{configurable:!0,writable:!0,value:R}),T&&T(j,R)}}function I(){try{return Function("return this;")()}catch{}}function S(){try{return(0,eval)("(function() { return this; })()")}catch{}}function E(){return I()||S()}})(function(o,s){var w=Object.prototype.hasOwnProperty,g=typeof Symbol=="function",I=g&&typeof Symbol.toPrimitive<"u"?Symbol.toPrimitive:"@@toPrimitive",S=g&&typeof Symbol.iterator<"u"?Symbol.iterator:"@@iterator",E=typeof Object.create=="function",$={__proto__:[]}instanceof Array,T=!E&&!$,j={create:E?function(){return L(Object.create(null))}:$?function(){return L({__proto__:null})}:function(){return L({})},has:T?function(e,t){return w.call(e,t)}:function(e,t){return t in e},get:T?function(e,t){return w.call(e,t)?e[t]:void 0}:function(e,t){return e[t]}},R=Object.getPrototypeOf(Function),A=typeof Map=="function"&&typeof Map.prototype.entries=="function"?Map:Ie(),W=typeof Set=="function"&&typeof Set.prototype.entries=="function"?Set:Pe(),K=typeof WeakMap=="function"?WeakMap:xe(),P=g?Symbol.for("@reflect-metadata:registry"):void 0,V=Ee(),J=je(V);function we(e,t,n,a){if(d(n)){if(!ae(e))throw new TypeError;if(!se(t))throw new TypeError;return ve(e,t)}else{if(!ae(e))throw new TypeError;if(!b(t))throw new TypeError;if(!b(a)&&!d(a)&&!x(a))throw new TypeError;return x(a)&&(a=void 0),n=M(n),ge(e,t,n,a)}}o("decorate",we);function F(e,t){function n(a,h){if(!b(a))throw new TypeError;if(!d(h)&&!Se(h))throw new TypeError;te(e,t,a,h)}return n}o("metadata",F);function C(e,t,n,a){if(!b(n))throw new TypeError;return d(a)||(a=M(a)),te(e,t,n,a)}o("defineMetadata",C);function q(e,t,n){if(!b(t))throw new TypeError;return d(n)||(n=M(n)),Q(e,t,n)}o("hasMetadata",q);function G(e,t,n){if(!b(t))throw new TypeError;return d(n)||(n=M(n)),N(e,t,n)}o("hasOwnMetadata",G);function ye(e,t,n){if(!b(t))throw new TypeError;return d(n)||(n=M(n)),X(e,t,n)}o("getMetadata",ye);function Z(e,t,n){if(!b(t))throw new TypeError;return d(n)||(n=M(n)),ee(e,t,n)}o("getOwnMetadata",Z);function Y(e,t){if(!b(e))throw new TypeError;return d(t)||(t=M(t)),re(e,t)}o("getMetadataKeys",Y);function pe(e,t){if(!b(e))throw new TypeError;return d(t)||(t=M(t)),ne(e,t)}o("getOwnMetadataKeys",pe);function _e(e,t,n){if(!b(t))throw new TypeError;if(d(n)||(n=M(n)),!b(t))throw new TypeError;d(n)||(n=M(n));var a=D(t,n,!1);return d(a)?!1:a.OrdinaryDeleteMetadata(e,t,n)}o("deleteMetadata",_e);function ve(e,t){for(var n=e.length-1;n>=0;--n){var a=e[n],h=a(t);if(!d(h)&&!x(h)){if(!se(h))throw new TypeError;t=h}}return t}function ge(e,t,n,a){for(var h=e.length-1;h>=0;--h){var k=e[h],m=k(t,n,a);if(!d(m)&&!x(m)){if(!b(m))throw new TypeError;a=m}}return a}function Q(e,t,n){var a=N(e,t,n);if(a)return!0;var h=U(t);return x(h)?!1:Q(e,h,n)}function N(e,t,n){var a=D(t,n,!1);return d(a)?!1:oe(a.OrdinaryHasOwnMetadata(e,t,n))}function X(e,t,n){var a=N(e,t,n);if(a)return ee(e,t,n);var h=U(t);if(!x(h))return X(e,h,n)}function ee(e,t,n){var a=D(t,n,!1);if(!d(a))return a.OrdinaryGetOwnMetadata(e,t,n)}function te(e,t,n,a){var h=D(n,a,!0);h.OrdinaryDefineOwnMetadata(e,t,n,a)}function re(e,t){var n=ne(e,t),a=U(e);if(a===null)return n;var h=re(a,t);if(h.length<=0)return n;if(n.length<=0)return h;for(var k=new W,m=[],p=0,u=n;p<u.length;p++){var c=u[p],f=k.has(c);f||(k.add(c),m.push(c))}for(var l=0,y=h;l<y.length;l++){var c=y[l],f=k.has(c);f||(k.add(c),m.push(c))}return m}function ne(e,t){var n=D(e,t,!1);return n?n.OrdinaryOwnMetadataKeys(e,t):[]}function ie(e){if(e===null)return 1;switch(typeof e){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return e===null?1:6;default:return 6}}function d(e){return e===void 0}function x(e){return e===null}function be(e){return typeof e=="symbol"}function b(e){return typeof e=="object"?e!==null:typeof e=="function"}function me(e,t){switch(ie(e)){case 0:return e;case 1:return e;case 2:return e;case 3:return e;case 4:return e;case 5:return e}var n="string",a=ue(e,I);if(a!==void 0){var h=a.call(e,n);if(b(h))throw new TypeError;return h}return ke(e)}function ke(e,t){var n,a;{var h=e.toString;if(z(h)){var a=h.call(e);if(!b(a))return a}var n=e.valueOf;if(z(n)){var a=n.call(e);if(!b(a))return a}}throw new TypeError}function oe(e){return!!e}function Oe(e){return""+e}function M(e){var t=me(e);return be(t)?t:Oe(t)}function ae(e){return Array.isArray?Array.isArray(e):e instanceof Object?e instanceof Array:Object.prototype.toString.call(e)==="[object Array]"}function z(e){return typeof e=="function"}function se(e){return typeof e=="function"}function Se(e){switch(ie(e)){case 3:return!0;case 4:return!0;default:return!1}}function H(e,t){return e===t||e!==e&&t!==t}function ue(e,t){var n=e[t];if(n!=null){if(!z(n))throw new TypeError;return n}}function ce(e){var t=ue(e,S);if(!z(t))throw new TypeError;var n=t.call(e);if(!b(n))throw new TypeError;return n}function fe(e){return e.value}function le(e){var t=e.next();return t.done?!1:t}function he(e){var t=e.return;t&&t.call(e)}function U(e){var t=Object.getPrototypeOf(e);if(typeof e!="function"||e===R||t!==R)return t;var n=e.prototype,a=n&&Object.getPrototypeOf(n);if(a==null||a===Object.prototype)return t;var h=a.constructor;return typeof h!="function"||h===e?t:h}function Me(){var e;!d(P)&&typeof s.Reflect<"u"&&!(P in s.Reflect)&&typeof s.Reflect.defineMetadata=="function"&&(e=Te(s.Reflect));var t,n,a,h=new K,k={registerProvider:m,getProvider:u,setProvider:f};return k;function m(l){if(!Object.isExtensible(k))throw new Error("Cannot add provider to a frozen registry.");switch(!0){case e===l:break;case d(t):t=l;break;case t===l:break;case d(n):n=l;break;case n===l:break;default:a===void 0&&(a=new W),a.add(l);break}}function p(l,y){if(!d(t)){if(t.isProviderFor(l,y))return t;if(!d(n)){if(n.isProviderFor(l,y))return t;if(!d(a))for(var _=ce(a);;){var v=le(_);if(!v)return;var O=fe(v);if(O.isProviderFor(l,y))return he(_),O}}}if(!d(e)&&e.isProviderFor(l,y))return e}function u(l,y){var _=h.get(l),v;return d(_)||(v=_.get(y)),d(v)&&(v=p(l,y),d(v)||(d(_)&&(_=new A,h.set(l,_)),_.set(y,v))),v}function c(l){if(d(l))throw new TypeError;return t===l||n===l||!d(a)&&a.has(l)}function f(l,y,_){if(!c(_))throw new Error("Metadata provider not registered.");var v=u(l,y);if(v!==_){if(!d(v))return!1;var O=h.get(l);d(O)&&(O=new A,h.set(l,O)),O.set(y,_)}return!0}}function Ee(){var e;return!d(P)&&b(s.Reflect)&&Object.isExtensible(s.Reflect)&&(e=s.Reflect[P]),d(e)&&(e=Me()),!d(P)&&b(s.Reflect)&&Object.isExtensible(s.Reflect)&&Object.defineProperty(s.Reflect,P,{enumerable:!1,configurable:!1,writable:!1,value:e}),e}function je(e){var t=new K,n={isProviderFor:function(c,f){var l=t.get(c);return d(l)?!1:l.has(f)},OrdinaryDefineOwnMetadata:m,OrdinaryHasOwnMetadata:h,OrdinaryGetOwnMetadata:k,OrdinaryOwnMetadataKeys:p,OrdinaryDeleteMetadata:u};return V.registerProvider(n),n;function a(c,f,l){var y=t.get(c),_=!1;if(d(y)){if(!l)return;y=new A,t.set(c,y),_=!0}var v=y.get(f);if(d(v)){if(!l)return;if(v=new A,y.set(f,v),!e.setProvider(c,f,n))throw y.delete(f),_&&t.delete(c),new Error("Wrong provider for target.")}return v}function h(c,f,l){var y=a(f,l,!1);return d(y)?!1:oe(y.has(c))}function k(c,f,l){var y=a(f,l,!1);if(!d(y))return y.get(c)}function m(c,f,l,y){var _=a(l,y,!0);_.set(c,f)}function p(c,f){var l=[],y=a(c,f,!1);if(d(y))return l;for(var _=y.keys(),v=ce(_),O=0;;){var de=le(v);if(!de)return l.length=O,l;var Re=fe(de);try{l[O]=Re}catch(Ae){try{he(v)}finally{throw Ae}}O++}}function u(c,f,l){var y=a(f,l,!1);if(d(y)||!y.delete(c))return!1;if(y.size===0){var _=t.get(f);d(_)||(_.delete(l),_.size===0&&t.delete(_))}return!0}}function Te(e){var t=e.defineMetadata,n=e.hasOwnMetadata,a=e.getOwnMetadata,h=e.getOwnMetadataKeys,k=e.deleteMetadata,m=new K,p={isProviderFor:function(u,c){var f=m.get(u);return!d(f)&&f.has(c)?!0:h(u,c).length?(d(f)&&(f=new W,m.set(u,f)),f.add(c),!0):!1},OrdinaryDefineOwnMetadata:t,OrdinaryHasOwnMetadata:n,OrdinaryGetOwnMetadata:a,OrdinaryOwnMetadataKeys:h,OrdinaryDeleteMetadata:k};return p}function D(e,t,n){var a=V.getProvider(e,t);if(!d(a))return a;if(n){if(V.setProvider(e,t,J))return J;throw new Error("Illegal state.")}}function Ie(){var e={},t=[],n=function(){function p(u,c,f){this._index=0,this._keys=u,this._values=c,this._selector=f}return p.prototype["@@iterator"]=function(){return this},p.prototype[S]=function(){return this},p.prototype.next=function(){var u=this._index;if(u>=0&&u<this._keys.length){var c=this._selector(this._keys[u],this._values[u]);return u+1>=this._keys.length?(this._index=-1,this._keys=t,this._values=t):this._index++,{value:c,done:!1}}return{value:void 0,done:!0}},p.prototype.throw=function(u){throw this._index>=0&&(this._index=-1,this._keys=t,this._values=t),u},p.prototype.return=function(u){return this._index>=0&&(this._index=-1,this._keys=t,this._values=t),{value:u,done:!0}},p}(),a=function(){function p(){this._keys=[],this._values=[],this._cacheKey=e,this._cacheIndex=-2}return Object.defineProperty(p.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),p.prototype.has=function(u){return this._find(u,!1)>=0},p.prototype.get=function(u){var c=this._find(u,!1);return c>=0?this._values[c]:void 0},p.prototype.set=function(u,c){var f=this._find(u,!0);return this._values[f]=c,this},p.prototype.delete=function(u){var c=this._find(u,!1);if(c>=0){for(var f=this._keys.length,l=c+1;l<f;l++)this._keys[l-1]=this._keys[l],this._values[l-1]=this._values[l];return this._keys.length--,this._values.length--,H(u,this._cacheKey)&&(this._cacheKey=e,this._cacheIndex=-2),!0}return!1},p.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=e,this._cacheIndex=-2},p.prototype.keys=function(){return new n(this._keys,this._values,h)},p.prototype.values=function(){return new n(this._keys,this._values,k)},p.prototype.entries=function(){return new n(this._keys,this._values,m)},p.prototype["@@iterator"]=function(){return this.entries()},p.prototype[S]=function(){return this.entries()},p.prototype._find=function(u,c){if(!H(this._cacheKey,u)){this._cacheIndex=-1;for(var f=0;f<this._keys.length;f++)if(H(this._keys[f],u)){this._cacheIndex=f;break}}return this._cacheIndex<0&&c&&(this._cacheIndex=this._keys.length,this._keys.push(u),this._values.push(void 0)),this._cacheIndex},p}();return a;function h(p,u){return p}function k(p,u){return u}function m(p,u){return[p,u]}}function Pe(){var e=function(){function t(){this._map=new A}return Object.defineProperty(t.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),t.prototype.has=function(n){return this._map.has(n)},t.prototype.add=function(n){return this._map.set(n,n),this},t.prototype.delete=function(n){return this._map.delete(n)},t.prototype.clear=function(){this._map.clear()},t.prototype.keys=function(){return this._map.keys()},t.prototype.values=function(){return this._map.keys()},t.prototype.entries=function(){return this._map.entries()},t.prototype["@@iterator"]=function(){return this.keys()},t.prototype[S]=function(){return this.keys()},t}();return e}function xe(){var e=16,t=j.create(),n=a();return function(){function u(){this._key=a()}return u.prototype.has=function(c){var f=h(c,!1);return f!==void 0?j.has(f,this._key):!1},u.prototype.get=function(c){var f=h(c,!1);return f!==void 0?j.get(f,this._key):void 0},u.prototype.set=function(c,f){var l=h(c,!0);return l[this._key]=f,this},u.prototype.delete=function(c){var f=h(c,!1);return f!==void 0?delete f[this._key]:!1},u.prototype.clear=function(){this._key=a()},u}();function a(){var u;do u="@@WeakMap@@"+p();while(j.has(t,u));return t[u]=!0,u}function h(u,c){if(!w.call(u,n)){if(!c)return;Object.defineProperty(u,n,{value:j.create()})}return u[n]}function k(u,c){for(var f=0;f<c;++f)u[f]=Math.random()*255|0;return u}function m(u){if(typeof Uint8Array=="function"){var c=new Uint8Array(u);return typeof crypto<"u"?crypto.getRandomValues(c):typeof msCrypto<"u"?msCrypto.getRandomValues(c):k(c,u),c}return k(new Array(u),u)}function p(){var u=m(e);u[6]=u[6]&79|64,u[8]=u[8]&191|128;for(var c="",f=0;f<e;++f){var l=u[f];(f===4||f===6||f===8)&&(c+="-"),l<16&&(c+="0"),c+=l.toString(16).toLowerCase()}return c}}function L(e){return e.__=void 0,delete e.__,e}})}(i||(i={})),ir}Xi();var eo=Object.defineProperty,to=(i,r,o)=>r in i?eo(i,r,{enumerable:!0,configurable:!0,writable:!0,value:o}):i[r]=o,Ze=(i,r,o)=>to(i,typeof r!="symbol"?r+"":r,o);class ro{constructor(r,o){Ze(this,"_target"),Ze(this,"_key"),Ze(this,"_oldValue"),Ze(this,"_wasDefined",!1),Ze(this,"_isSwapped",!1),this._target=r,this._key=o,this._oldValue=this._target[this._key]}get isSwapped(){return this._isSwapped}get originalValue(){return this._oldValue}get value(){return this._target[this._key]}get target(){return this._target}restore(){this.isSwapped&&(this._wasDefined?this._target[this._key]=this._oldValue:delete this._target[this._key],this._isSwapped=!1)}swap(r){this.isSwapped||(this._wasDefined=Object.hasOwn(this._target,this._key),this._oldValue=this._target[this._key]),this._target[this._key]=r,this._isSwapped=!0}}const no={onlyIfNotExists:!0,isFactory:!1};class io{constructor(r,o,s={}){if(ut(this,"_installedInstances",new Map),ut(this,"_path"),ut(this,"_targetValue"),ut(this,"_options"),this._path=r.split("."),this._path.length===0)throw new Error("Path must not be empty");this._targetValue=o,this._options={...no,...s}}_getTargetObject(r){let o=r;for(const s of this._path.slice(0,this._path.length-1))o[s]||(o[s]={}),o=o[s];return o}_createSwapper(r){const o=this._getTargetObject(r);return new ro(o,this._path.at(-1))}install({sdk:r,...o}){if(this._installedInstances.has(r))return;const s=this._createSwapper(r);if(!(s.value&&this._options.onlyIfNotExists)){if(this._options.isFactory&&typeof this._targetValue=="function"){const w=this._targetValue({sdk:r,...o});s.swap(w)}else s.swap(this._targetValue);this._installedInstances.set(r,s)}}uninstall({sdk:r}){const o=this._installedInstances.get(r);o&&(o.restore(),this._installedInstances.delete(r))}}class kt extends Error{constructor(r){super(r),this.name="MiddlewareError"}}class oo extends kt{constructor(r){super(r),this.name="MiddlewareFlowError"}}class ao extends kt{constructor(r="Action prevented by middleware."){super(r),this.name="MiddlewarePreventedError"}}function ct(i){if(i===null||typeof i!="object")return i;if(Array.isArray(i))return i.map(o=>ct(o));if(i instanceof Date)return new Date(i);const r={};for(const o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=ct(i[o]));return r}function ar(i){Object.freeze(i);for(const r in i)if(Object.prototype.hasOwnProperty.call(i,r)){const o=i[r];o&&typeof o=="object"&&ar(o)}return i}function so(i){let r=!1,o=null;const s=()=>r,w=()=>r=!0;return[function(...g){return w(),o=i.apply(this,g)},s,()=>{if(!r)throw new Error("Function has not been called yet");return o}]}class uo{constructor(r,o,s,w){B(this,"actionPoint"),B(this,"data"),B(this,"originalData"),B(this,"wmeSdk"),this.data=o,Object.defineProperty(this,"actionPoint",{value:r,writable:!1,configurable:!1,enumerable:!0}),Object.defineProperty(this,"originalData",{value:s,writable:!1,configurable:!1,enumerable:!0}),Object.defineProperty(this,"wmeSdk",{value:w,writable:!1,configurable:!1,enumerable:!0})}}class co{constructor(r,o,s,w){B(this,"actionPoint"),B(this,"data"),B(this,"mutatedData"),B(this,"wmeSdk"),B(this,"handlers"),this.actionPoint=r,this.data=this.mutatedData=o,this.wmeSdk=s,this.handlers=w}getSafeImmutableData(){return ar(ct(this.data))}getSafeMutableData(){return ct(this.mutatedData)}createContext(){return new uo(this.actionPoint,this.getSafeMutableData(),this.getSafeImmutableData(),this.wmeSdk)}async run(r){let o=-1;const s=async w=>{if(w<=o)throw await new Promise(T=>setTimeout(T,1e3)),new oo("next() called multiple times within the same middleware or improperly nested.");if(o=w,w>=this.handlers.length)return r(this.mutatedData);const g=this.handlers[o],I=this.createContext(),[S,E,$]=so(()=>(this.mutatedData=I.data,s(w+1)));try{return await Promise.resolve(g(I,S)),E()?await $():(console.warn(`Middleware handler "${g.name||"anonymous"}" did not call next() and did not throw an error. This is not recommended and may cause unexpected behavior.
Ensure to always call next() or throw an error to stop the middleware chain.`),await S())}catch(T){if(T instanceof ao)return null;throw T}};return await s(0)}}class fo extends EventTarget{constructor(r){super(),B(this,"middleware",new Map),B(this,"wmeSdk"),this.wmeSdk=r}register(r,o){if(typeof o!="function")throw new kt("Middleware handler must be a function.");const s=this.middleware.get(r)||[],w={handler:o};s.push(w),this.middleware.set(r,s),this.dispatchEvent(new CustomEvent("middlewareRegistered",{detail:{actionPoint:r}}));let g=!1;return()=>{if(g)return;const I=this.middleware.get(r);if(!I)return;const S=I.indexOf(w);S!==-1&&(I.splice(S,1),I.length===0&&this.middleware.delete(r),g=!0,this.dispatchEvent(new CustomEvent("middlewareUnregistered",{detail:{actionPoint:r}})))}}async execute(r,o,s){const w=this.middleware.get(r)||[];await new co(r,o,this.wmeSdk,w.map(g=>g.handler)).run(s)}hasListeners(r){return this.middleware.has(r)&&(this.middleware.get(r)||[]).length>0}}const Ot=Symbol("REGISTRY");var lo=Object.defineProperty,ho=(i,r,o)=>r in i?lo(i,r,{enumerable:!0,configurable:!0,writable:!0,value:o}):i[r]=o,Ce=(i,r,o)=>ho(i,typeof r!="symbol"?r+"":r,o);class po{constructor(r,o){Ce(this,"_target"),Ce(this,"_key"),Ce(this,"_oldValue"),Ce(this,"_wasDefined",!1),Ce(this,"_isSwapped",!1),this._target=r,this._key=o,this._oldValue=this._target[this._key]}get isSwapped(){return this._isSwapped}get originalValue(){return this._oldValue}get value(){return this._target[this._key]}get target(){return this._target}restore(){this.isSwapped&&(this._wasDefined?this._target[this._key]=this._oldValue:delete this._target[this._key],this._isSwapped=!1)}swap(r){this.isSwapped||(this._wasDefined=Object.hasOwn(this._target,this._key),this._oldValue=this._target[this._key]),this._target[this._key]=r,this._isSwapped=!0}}let sr=class{constructor(i,r,o){Ce(this,"_enabled",!1),Ce(this,"_fnSwapper"),Ce(this,"_interceptionFunction"),Ce(this,"_middlewares",[]),this._fnSwapper=new po(i,r),this._interceptionFunction=o}get enabled(){return this._fnSwapper.isSwapped&&this._enabled}disable(){this._enabled=!1,this.enabled}restore(){this._fnSwapper.restore()}enable(){this._enabled=!0,this._fnSwapper.isSwapped||this.swapToInterceptor()}swapToInterceptor(){const i=this;this._fnSwapper.swap(function(...r){if(!i._enabled)return i.callOriginalInvocator(...r);const o=i.runMiddlewares(r);if(o){if("output"in o)return o.output;"input"in o&&(r=o.input)}return i._interceptionFunction.call(this,i.getOriginalInvocator(this),...r)})}getOriginalInvocator(i){return this._fnSwapper.originalValue.bind(i??this._fnSwapper.target)}callOriginalInvocator(...i){return this.getOriginalInvocator()(...i)}runMiddlewares(i){for(const r of this._middlewares){const o=r(...i);if(o){if("output"in o)return o;"input"in o&&(i=o.input)}}return{input:i}}registerMiddleware(i){this._middlewares.push(i)}};function Ye(){return"unsafeWindow"in window?window.unsafeWindow:window}class ur{constructor(r){B(this,"isMiddlewareDefined",!1),B(this,"uninstaller",null),B(this,"registry"),B(this,"artifacts"),B(this,"handleMiddlewareRegistered",o=>{o.detail.actionPoint===this.options.actionPoint&&this.defineMiddleware(this.artifacts)}),B(this,"handleMiddlewareUnregistered",o=>{var s;o.detail.actionPoint===this.options.actionPoint&&((s=this.registry)!=null&&s.hasListeners(this.options.actionPoint)||this.undefineMiddleware())}),this.options=r}addRegistryEvents(){var r,o;(r=this.registry)==null||r.addEventListener("middlewareRegistered",this.handleMiddlewareRegistered),(o=this.registry)==null||o.addEventListener("middlewareUnregistered",this.handleMiddlewareUnregistered)}removeRegistryEvents(){var r,o;(r=this.registry)==null||r.removeEventListener("middlewareRegistered",this.handleMiddlewareRegistered),(o=this.registry)==null||o.removeEventListener("middlewareUnregistered",this.handleMiddlewareUnregistered)}defineMiddleware(r){this.isMiddlewareDefined||(this.uninstaller=this.options.install(o=>new Promise(s=>{if(!this.registry)return s(o);this.registry.execute(this.options.actionPoint,o,s)}),r)||null,this.isMiddlewareDefined=!0)}undefineMiddleware(){var r;this.isMiddlewareDefined&&((r=this.uninstaller)==null||r.call(this),this.isMiddlewareDefined=!1)}install({artifacts:r}){var o;this.artifacts=r,this.registry=r[this.options.registryArtifactName??Ot],(o=this.registry)!=null&&o.hasListeners(this.options.actionPoint)&&this.defineMiddleware(r),this.addRegistryEvents()}uninstall(){this.removeRegistryEvents(),this.undefineMiddleware(),this.registry=void 0}}function yo(){return new Promise(i=>{const r="problems:shown",o=Ye(),s=async w=>{if(w.type!=="mapUpdateRequest")return;o.W.app.off(r,s);const g=await o.W.problemsController.editController.adapter.getCommentable();i(g.constructor)};o.W.app.on(r,s)})}const wo=new ur({actionPoint:"updateRequests.addComment",install:i=>{let r=null;return yo().then(o=>{r=new sr(o.prototype,"addComment",async function(s,w,...g){const I=await i({updateRequestId:this.conversation.getID(),message:w});return s(I.message,...g)}),r.enable()}),()=>{r==null||r.disable()}}});function _o(i){return"subActions"in i&&Array.isArray(i.subActions)}function cr(i,r){const o=[];if(typeof r!="function"){const s=r;r=w=>s===w}for(const s in i){const w=i[s];if(r(w))return o.concat(parseInt(s));if(w.subActions){const g=cr(w.subActions,r);if(g)return o.concat(parseInt(s),...g)}}return null}class ft{constructor(r){B(this,"actions"),this.actions=r}getActionsFlat(){return this.actions.flatMap(r=>_o(r)?r.getSubActions():[r])}getActionPath(r){return cr(this.actions,r)}hasAction(r){return this.getActionPath(r)!==null}removeAction(r){var o;const s=r.pop();let w={subActions:this.actions};for(;r.length;)w=(o=w.subActions)==null?void 0:o[r.shift()];s!==void 0&&w.subActions.splice(s,1)}replaceAction(r,...o){var s;const w=r.pop();let g={subActions:this.actions};for(;r.length;)g=(s=g.subActions)==null?void 0:s[r.shift()];w!==void 0&&g.subActions.splice(w,1,...o)}addAction(r){this.actions.push(r)}}class vo{constructor(r,o){B(this,"saveInterceptor"),this.saveInterceptor=new sr(r.controller,"save",async function(s,w,...g){const I=new ft((w==null?void 0:w.actions)||this.model.actionManager.getActions()),S=await Promise.resolve(o(I));if(S){const E={pendingEdits:null,saveCount:{bigJunctions:0,nodes:0,segments:0,venues:0},unsavedFeatures:[]};for(const $ of S){const T=await s({...w||{},actions:$.actions},...g);E.saveCount&&(E.saveCount.bigJunctions+=T.saveCount.bigJunctions,E.saveCount.nodes+=T.saveCount.nodes,E.saveCount.segments+=T.saveCount.segments,E.saveCount.venues+=T.saveCount.venues),T.unsavedFeatures&&(Array.isArray(E.unsavedFeatures)?E.unsavedFeatures.push(...T.unsavedFeatures):console.warn("result.unsavedFeatures has unexpected response type: expected array, returned ",T.unsavedFeatures))}return E}return s({...w||{},actions:I.actions},...g)})}enable(){return this.saveInterceptor.enable()}disable(){return this.saveInterceptor.disable()}}const go="ADD_ROAD_CLOSURE";function St(i){return i.actionName===go}const bo="ADD_TURN_CLOSURE";function Mt(i){var r;return i.actionName===bo&&((r=i.getObject())==null?void 0:r.type)==="turnClosure"}function fr(i){return i.actionName==="UPDATE_OBJECT"}function lr(i){return fr(i)&&i.object.type==="roadClosure"}function hr(i){return fr(i)&&i.object.type==="turnClosure"}const mo="DELETE_ROAD_CLOSURE";function Et(i){return i.actionName===mo}function ko(i){return i.actionName==="DELETE_OBJECT"}function jt(i){return ko(i)&&i.object.type==="turnClosure"}function Oo(i){return i.filter(r=>St(r)||Mt(r)||lr(r)||hr(r)||Et(r)||jt(r))}const So={roadClosure:"SEGMENT",turnClosure:"TURN"};function Qe(i){const r={id:i.state==="INSERT"?null:i.attributes.id,closureType:So[i.type],startDate:new Date(i.attributes.startDate),endDate:new Date(i.attributes.endDate),description:i.attributes.reason,eventId:i.attributes.eventId};switch(i.type){case"roadClosure":return{...r,closureType:"SEGMENT",permanent:i.getAttribute("permanent"),segmentId:i.getAttribute("segID"),forward:i.getAttribute("forward"),nodeClousre:i.getAttribute("fromNodeClosed"),provider:i.getAttribute("provider")};case"turnClosure":return{...r,closureType:"TURN",permanent:!0,fromSegmentId:i.getAttribute("fromSegID"),fromSegmentForward:i.getAttribute("fromSegForward"),toSegmentId:i.getAttribute("toSegID"),toSegmentForward:i.getAttribute("toSegForward"),nodeId:i.getAttribute("nodeConnID")}}}function dr(i,r){return typeof i!=typeof r||typeof i!="object"||!i||!r?!1:Object.keys(i).every(o=>{if(!Object.prototype.hasOwnProperty.call(r,o))return!1;const s=i[o],w=r[o];return dr(s,w)})}function Mo(i,r){return r.some(o=>dr(o,i))}function pr(i,r){return i.length!==r.length?!1:i.every(o=>Mo(o,r))}var Eo=Object.defineProperty,jo=(i,r,o)=>r in i?Eo(i,r,{enumerable:!0,configurable:!0,writable:!0,value:o}):i[r]=o,Xe=(i,r,o)=>jo(i,typeof r!="symbol"?r+"":r,o);let To=class{constructor(i,r){Xe(this,"_target"),Xe(this,"_key"),Xe(this,"_oldValue"),Xe(this,"_wasDefined",!1),Xe(this,"_isSwapped",!1),this._target=i,this._key=r,this._oldValue=this._target[this._key]}get isSwapped(){return this._isSwapped}get originalValue(){return this._oldValue}get value(){return this._target[this._key]}get target(){return this._target}restore(){this.isSwapped&&(this._wasDefined?this._target[this._key]=this._oldValue:delete this._target[this._key],this._isSwapped=!1)}swap(i){this.isSwapped||(this._wasDefined=Object.hasOwn(this._target,this._key),this._oldValue=this._target[this._key]),this._target[this._key]=i,this._isSwapped=!0}};function Tt(){return"unsafeWindow"in window?window.unsafeWindow:window}var Io=Object.defineProperty,Po=(i,r,o)=>r in i?Io(i,r,{enumerable:!0,configurable:!0,writable:!0,value:o}):i[r]=o,yr=(i,r,o)=>Po(i,typeof r!="symbol"?r+"":r,o);function et(){return"unsafeWindow"in window?window.unsafeWindow:window}var xo=Object.defineProperty,Ro=(i,r,o)=>r in i?xo(i,r,{enumerable:!0,configurable:!0,writable:!0,value:o}):i[r]=o,ze=(i,r,o)=>Ro(i,typeof r!="symbol"?r+"":r,o);class Ao{constructor(r,o){ze(this,"_target"),ze(this,"_key"),ze(this,"_oldValue"),ze(this,"_wasDefined",!1),ze(this,"_isSwapped",!1),this._target=r,this._key=o,this._oldValue=this._target[this._key]}get isSwapped(){return this._isSwapped}get originalValue(){return this._oldValue}get value(){return this._target[this._key]}get target(){return this._target}restore(){this.isSwapped&&(this._wasDefined?this._target[this._key]=this._oldValue:delete this._target[this._key],this._isSwapped=!1)}swap(r){this.isSwapped||(this._wasDefined=Object.hasOwn(this._target,this._key),this._oldValue=this._target[this._key]),this._target[this._key]=r,this._isSwapped=!0}}class $o{constructor(r,o,s){ze(this,"_enabled",!1),ze(this,"_fnSwapper"),ze(this,"_interceptionFunction"),ze(this,"_middlewares",[]),this._fnSwapper=new Ao(r,o),this._interceptionFunction=s}get enabled(){return this._fnSwapper.isSwapped&&this._enabled}disable(){this._enabled=!1,this.enabled}restore(){this._fnSwapper.restore()}enable(){this._enabled=!0,this._fnSwapper.isSwapped||this.swapToInterceptor()}swapToInterceptor(){const r=this;this._fnSwapper.swap(function(...o){if(!r._enabled)return r.callOriginalInvocator(...o);const s=r.runMiddlewares(o);if(s){if("output"in s)return s.output;"input"in s&&(o=s.input)}return r._interceptionFunction.call(this,r.getOriginalInvocator(this),...o)})}getOriginalInvocator(r){return this._fnSwapper.originalValue.bind(r??this._fnSwapper.target)}callOriginalInvocator(...r){return this.getOriginalInvocator()(...r)}runMiddlewares(r){for(const o of this._middlewares){const s=o(...r);if(s){if("output"in s)return s;"input"in s&&(r=s.input)}}return{input:r}}registerMiddleware(r){this._middlewares.push(r)}}class Do{constructor(r){yr(this,"_fetchInterceptor"),yr(this,"_interceptionFilters",new Set),this._fetchInterceptor=new $o(r,"fetch",(o,s,w)=>{for(const g of this._interceptionFilters)if(g.shouldIntercept(s,w))return this.shouldKeepFilter(g,s,w)||this.removeInterceptionFilter(g),g.intercept(s,w);return o(s,w)})}enable(){this._fetchInterceptor.enable()}disable(){this._fetchInterceptor.disable()}addInterceptionFilter(r){this.enable(),this._interceptionFilters.add(r)}removeInterceptionFilter(r){this._interceptionFilters.delete(r)}shouldKeepFilter(r,o,s){return typeof r.shouldKeep=="function"?r.shouldKeep(o,s):typeof r.shouldKeep=="boolean"?r.shouldKeep:!1}}function Fo(i){return i=i instanceof URL?i:new URL(i,et().location.href),r=>typeof r=="string"?new URL(r,et().location.href).pathname===i.pathname:r instanceof URL?r.pathname===i.pathname:new URL(r.url,et().location.href).pathname===new URL(i,et().location.href).pathname}function Vo(i,r,o){const s=new Response(r,o),w=new URL(i,location.toString());return Object.defineProperty(s,"url",{value:w}),s}function Co(i,r){const o=JSON.stringify(r),s=new Headers({"Content-Type":"application/json"});return Vo(i,o,{headers:s})}const zo=new Do(et());function Ko(){const i=Tt(),r=new To(i.W.controller.descartesClient,"createAbortController");r.swap(()=>(r.restore(),new AbortController))}function Wo(i){const r=Tt();return Ko(),r.W.controller.descartesClient.getFeatures([0,0,0,0],{[i]:!0},{})}async function wr(i,r){const o=Tt().W.Config.paths.features;zo.addInterceptionFilter({shouldIntercept:Fo(o),intercept(){return Promise.resolve(Co(o,{[i]:{objects:[r]}}))}});const{[i]:s}=await Wo(i),[w]=s.objects;return w.constructor}const _r=Symbol("TurnClosure"),vr=Symbol("RoadClosure");function gr(i){const r=i.getFullYear().toString().padStart(2,"4"),o=(i.getMonth()+1).toString().padStart(2,"0"),s=i.getDate().toString().padStart(2,"0"),w=i.getHours().toString().padStart(2,"0"),g=i.getMinutes().toString().padStart(2,"0");return`${r}-${o}-${s} ${w}:${g}`}function No(i){const r=Ye(),o={SEGMENT:"roadClosure",TURN:"turnClosure"};return r.W.model.getRepository(o[i])}function Ho(i,r){const o={id:i.id||No(i.closureType).idGenerator.next(),attributions:null,reason:i.description,startDate:gr(i.startDate),endDate:gr(i.endDate),eventId:i.eventId,externalProvider:null,externalProviderId:null,provider:null,createdBy:null,createdOn:null,updatedBy:null,updatedOn:null,permissions:-1,geometry:null};switch(i.closureType){case"SEGMENT":return new r[vr]({...o,closureType:"SEGMENT",permanent:i.permanent,segID:i.segmentId,forward:i.forward,fromNodeClosed:i.nodeClousre});case"TURN":return new r[_r]({...o,closureType:"TURN",permanent:!0,fromSegID:i.fromSegmentId,fromSegForward:i.fromSegmentForward,toSegID:i.toSegmentId,toSegForward:i.toSegmentForward,nodeConnID:i.nodeId})}}function br(i){return St(i)?{...Qe(i.closure),id:null}:Mt(i)?{...Qe(i.getObject()),id:null}:lr(i)?Qe(i.getObject()):Et(i)?Qe(i.closure):hr(i)||jt(i)?Qe(i.getObject()):null}const Uo=[{async install(){const i=await wr("roadClosures",{});return{[vr]:i}}},{async install(){const i=await wr("turnClosures",{});return{[_r]:i}}},new ur({actionPoint:"closures.save",install:(i,r)=>{const o=Ye(),s=new vo(o.W,async w=>{var g,I;const S=w.getActionsFlat(),E=Oo(S);if(!E.length)return;const{delete:$,set:T}=E.reduce((F,C)=>((Et(C)||jt(C)?F.delete:F.set).push(C),F),{delete:[],set:[]}),j={source:void 0,closures:T.map(br).filter(Boolean),deleteClosures:$.map(br).filter(Boolean)},R=await i(j),A=pr(j.closures,R.closures),W=pr(j.deleteClosures,R.deleteClosures);if(!A&&!W)return;const K=(g=E.find(F=>St(F)))==null?void 0:g.constructor,P=(I=E.find(F=>Mt(F)))==null?void 0:I.constructor;E.forEach(F=>{const C=w.getActionPath(F);C&&(w.removeAction(C),F.undoAction(o.W.model))});const{addClosureActions:V,updateClosureActions:J}=R.closures.reduce((F,C)=>{const q=Ye(),G=Ho(C,r);if(!G)return F;if(!C.id){const Z=(()=>{switch(C.closureType){case"SEGMENT":{if(!K){const pe=q.require("Waze/Action/CreateObject");return new pe(G)}const Y=q.W.model.segments.getObjectById(C.segmentId);return new K(G,Y)}case"TURN":{if(!P){const _e=q.require("Waze/Action/CreateObject");return new _e(G)}const Y=q.W.model.segments.getObjectById(C.fromSegmentId),pe=q.W.model.segments.getObjectById(C.toSegmentId);return new P(G,Y,pe)}default:throw new Error("Unregistered closure factory for closure type "+C.closureType)}})();Z&&F.addClosureActions.push(Z)}const ye=(()=>{const Z=q.W.model.getRepository(C.closureType==="SEGMENT"?"roadClosure":"turnClosure").getObjectById(C.id);if(!Z)return null;const Y=q.require("Waze/Action/UpdateObject");return new Y(Z,G.attributes)})();return ye&&F.updateClosureActions.push(ye),F},{addClosureActions:[],updateClosureActions:[]}),we=R.deleteClosures.map(F=>{const C=Ye(),q=C.W.model.getRepository(F.closureType==="SEGMENT"?"roadClosure":"turnClosure").getObjectById(F.id);if(!q)return null;const G=C.require("Waze/Action/DeleteObject");return new G(q)});return[new ft(J.filter(Boolean)),new ft(we.filter(Boolean)),new ft(V.filter(Boolean))].filter(F=>F.actions.length>0)});return s.enable(),()=>{s.disable()}}})],Lo=[{install:({sdk:i})=>({[Ot]:new fo(i)})},new io("Events.registerMiddleware",({artifacts:i})=>(r,o)=>{const s=i[Ot];return s==null?void 0:s.register(r,o)},{isFactory:!0}),wo,...Uo],qo={"Editing.Transactions":{hook:qr},"DataModel.MapComments":{hook:jn},"DataModel.PermanentHazards":{hook:fi},"DataModel.BigJunctions":{hook:Bi},Middlewares:{hook:Lo}};function It(i){const[r,o,s]=i.split(".").map(Number);return{major:r,minor:o,patch:s}}function Pt(i,r){return i?r?i.major&&r.major&&i.major!==r.major?i.major-r.major:i.minor&&r.minor&&i.minor!==r.minor?i.minor-r.minor:i.patch&&r.patch&&i.patch!==r.patch?i.patch-r.patch:0:1:-1}function Go(i,r,o="highest"){let s=null;typeof i.highest=="string"&&(i.highest=It(i.highest)),typeof i.lowest=="string"&&(i.lowest=It(i.lowest));for(const w of r){if(!w.version)continue;if(!s){s=w;continue}if(i.highest&&Pt(w.version,i.highest)>0||i.lowest&&Pt(w.version,i.lowest)<0)continue;const g=w.version,I=s.version,S=Pt(g,I);(o==="highest"&&S>0||o==="lowest"&&S<0)&&(s=w)}if(!s)throw new Error("No matching version found");return s}const Bo={"0.1":i=>{const r=i.constructor;return new r(i.getScriptId(),i.getScriptName())}};function Jo(i){const r=Object.entries(Bo).map(([s,w])=>({version:It(s),cloner:w})),{cloner:o}=Go({highest:i.getSDKVersion()},r);return o(i)}const mr=new Mr(qo);async function Zo(i,r={}){if(r.immutable&&(i=Jo(i)),i.State.isInitialized()||await i.Events.once({eventName:"wme-initialized"}),r.hooks)for(const o of r.hooks)await mr.installHook(o,i);else await mr.installAllHooks(i);return i}return Zo}();
