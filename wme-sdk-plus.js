var initWmeSdkPlus=function(){"use strict";var Sr=Object.defineProperty,Mr=(i,t,o)=>t in i?Sr(i,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):i[t]=o,lt=(i,t,o)=>Mr(i,typeof t!="symbol"?t+"":t,o),xt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},$t={};/*! *****************************************************************************
  Copyright (C) Microsoft. All rights reserved.
  Licensed under the Apache License, Version 2.0 (the "License"); you may not use
  this file except in compliance with the License. You may obtain a copy of the
  License at http://www.apache.org/licenses/LICENSE-2.0

  THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
  WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
  MERCHANTABLITY OR NON-INFRINGEMENT.

  See the Apache Version 2.0 License for specific language governing permissions
  and limitations under the License.
  ***************************************************************************** */var Dt;function Er(){if(Dt)return $t;Dt=1;var i;return function(t){(function(o){var s=typeof globalThis=="object"?globalThis:typeof xt=="object"?xt:typeof self=="object"?self:typeof this=="object"?this:j(),w=g(t);typeof s.Reflect<"u"&&(w=g(s.Reflect,w)),o(w,s),typeof s.Reflect>"u"&&(s.Reflect=t);function g($,I){return function(E,A){Object.defineProperty($,E,{configurable:!0,writable:!0,value:A}),I&&I(E,A)}}function T(){try{return Function("return this;")()}catch{}}function S(){try{return(0,eval)("(function() { return this; })()")}catch{}}function j(){return T()||S()}})(function(o,s){var w=Object.prototype.hasOwnProperty,g=typeof Symbol=="function",T=g&&typeof Symbol.toPrimitive<"u"?Symbol.toPrimitive:"@@toPrimitive",S=g&&typeof Symbol.iterator<"u"?Symbol.iterator:"@@iterator",j=typeof Object.create=="function",$={__proto__:[]}instanceof Array,I=!j&&!$,E={create:j?function(){return q(Object.create(null))}:$?function(){return q({__proto__:null})}:function(){return q({})},has:I?function(e,r){return w.call(e,r)}:function(e,r){return r in e},get:I?function(e,r){return w.call(e,r)?e[r]:void 0}:function(e,r){return e[r]}},A=Object.getPrototypeOf(Function),x=typeof Map=="function"&&typeof Map.prototype.entries=="function"?Map:Ie(),W=typeof Set=="function"&&typeof Set.prototype.entries=="function"?Set:Pe(),K=typeof WeakMap=="function"?WeakMap:Re(),P=g?Symbol.for("@reflect-metadata:registry"):void 0,V=Ee(),J=je(V);function we(e,r,n,a){if(d(n)){if(!ae(e))throw new TypeError;if(!se(r))throw new TypeError;return ge(e,r)}else{if(!ae(e))throw new TypeError;if(!b(r))throw new TypeError;if(!b(a)&&!d(a)&&!R(a))throw new TypeError;return R(a)&&(a=void 0),n=M(n),ve(e,r,n,a)}}o("decorate",we);function F(e,r){function n(a,h){if(!b(a))throw new TypeError;if(!d(h)&&!Se(h))throw new TypeError;te(e,r,a,h)}return n}o("metadata",F);function C(e,r,n,a){if(!b(n))throw new TypeError;return d(a)||(a=M(a)),te(e,r,n,a)}o("defineMetadata",C);function L(e,r,n){if(!b(r))throw new TypeError;return d(n)||(n=M(n)),Q(e,r,n)}o("hasMetadata",L);function G(e,r,n){if(!b(r))throw new TypeError;return d(n)||(n=M(n)),N(e,r,n)}o("hasOwnMetadata",G);function ye(e,r,n){if(!b(r))throw new TypeError;return d(n)||(n=M(n)),X(e,r,n)}o("getMetadata",ye);function Z(e,r,n){if(!b(r))throw new TypeError;return d(n)||(n=M(n)),ee(e,r,n)}o("getOwnMetadata",Z);function Y(e,r){if(!b(e))throw new TypeError;return d(r)||(r=M(r)),re(e,r)}o("getMetadataKeys",Y);function pe(e,r){if(!b(e))throw new TypeError;return d(r)||(r=M(r)),ne(e,r)}o("getOwnMetadataKeys",pe);function _e(e,r,n){if(!b(r))throw new TypeError;if(d(n)||(n=M(n)),!b(r))throw new TypeError;d(n)||(n=M(n));var a=D(r,n,!1);return d(a)?!1:a.OrdinaryDeleteMetadata(e,r,n)}o("deleteMetadata",_e);function ge(e,r){for(var n=e.length-1;n>=0;--n){var a=e[n],h=a(r);if(!d(h)&&!R(h)){if(!se(h))throw new TypeError;r=h}}return r}function ve(e,r,n,a){for(var h=e.length-1;h>=0;--h){var k=e[h],m=k(r,n,a);if(!d(m)&&!R(m)){if(!b(m))throw new TypeError;a=m}}return a}function Q(e,r,n){var a=N(e,r,n);if(a)return!0;var h=U(r);return R(h)?!1:Q(e,h,n)}function N(e,r,n){var a=D(r,n,!1);return d(a)?!1:oe(a.OrdinaryHasOwnMetadata(e,r,n))}function X(e,r,n){var a=N(e,r,n);if(a)return ee(e,r,n);var h=U(r);if(!R(h))return X(e,h,n)}function ee(e,r,n){var a=D(r,n,!1);if(!d(a))return a.OrdinaryGetOwnMetadata(e,r,n)}function te(e,r,n,a){var h=D(n,a,!0);h.OrdinaryDefineOwnMetadata(e,r,n,a)}function re(e,r){var n=ne(e,r),a=U(e);if(a===null)return n;var h=re(a,r);if(h.length<=0)return n;if(n.length<=0)return h;for(var k=new W,m=[],p=0,u=n;p<u.length;p++){var c=u[p],f=k.has(c);f||(k.add(c),m.push(c))}for(var l=0,y=h;l<y.length;l++){var c=y[l],f=k.has(c);f||(k.add(c),m.push(c))}return m}function ne(e,r){var n=D(e,r,!1);return n?n.OrdinaryOwnMetadataKeys(e,r):[]}function ie(e){if(e===null)return 1;switch(typeof e){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return e===null?1:6;default:return 6}}function d(e){return e===void 0}function R(e){return e===null}function be(e){return typeof e=="symbol"}function b(e){return typeof e=="object"?e!==null:typeof e=="function"}function me(e,r){switch(ie(e)){case 0:return e;case 1:return e;case 2:return e;case 3:return e;case 4:return e;case 5:return e}var n="string",a=ue(e,T);if(a!==void 0){var h=a.call(e,n);if(b(h))throw new TypeError;return h}return ke(e)}function ke(e,r){var n,a;{var h=e.toString;if(z(h)){var a=h.call(e);if(!b(a))return a}var n=e.valueOf;if(z(n)){var a=n.call(e);if(!b(a))return a}}throw new TypeError}function oe(e){return!!e}function Oe(e){return""+e}function M(e){var r=me(e);return be(r)?r:Oe(r)}function ae(e){return Array.isArray?Array.isArray(e):e instanceof Object?e instanceof Array:Object.prototype.toString.call(e)==="[object Array]"}function z(e){return typeof e=="function"}function se(e){return typeof e=="function"}function Se(e){switch(ie(e)){case 3:return!0;case 4:return!0;default:return!1}}function H(e,r){return e===r||e!==e&&r!==r}function ue(e,r){var n=e[r];if(n!=null){if(!z(n))throw new TypeError;return n}}function ce(e){var r=ue(e,S);if(!z(r))throw new TypeError;var n=r.call(e);if(!b(n))throw new TypeError;return n}function fe(e){return e.value}function le(e){var r=e.next();return r.done?!1:r}function he(e){var r=e.return;r&&r.call(e)}function U(e){var r=Object.getPrototypeOf(e);if(typeof e!="function"||e===A||r!==A)return r;var n=e.prototype,a=n&&Object.getPrototypeOf(n);if(a==null||a===Object.prototype)return r;var h=a.constructor;return typeof h!="function"||h===e?r:h}function Me(){var e;!d(P)&&typeof s.Reflect<"u"&&!(P in s.Reflect)&&typeof s.Reflect.defineMetadata=="function"&&(e=Te(s.Reflect));var r,n,a,h=new K,k={registerProvider:m,getProvider:u,setProvider:f};return k;function m(l){if(!Object.isExtensible(k))throw new Error("Cannot add provider to a frozen registry.");switch(!0){case e===l:break;case d(r):r=l;break;case r===l:break;case d(n):n=l;break;case n===l:break;default:a===void 0&&(a=new W),a.add(l);break}}function p(l,y){if(!d(r)){if(r.isProviderFor(l,y))return r;if(!d(n)){if(n.isProviderFor(l,y))return r;if(!d(a))for(var _=ce(a);;){var v=le(_);if(!v)return;var O=fe(v);if(O.isProviderFor(l,y))return he(_),O}}}if(!d(e)&&e.isProviderFor(l,y))return e}function u(l,y){var _=h.get(l),v;return d(_)||(v=_.get(y)),d(v)&&(v=p(l,y),d(v)||(d(_)&&(_=new x,h.set(l,_)),_.set(y,v))),v}function c(l){if(d(l))throw new TypeError;return r===l||n===l||!d(a)&&a.has(l)}function f(l,y,_){if(!c(_))throw new Error("Metadata provider not registered.");var v=u(l,y);if(v!==_){if(!d(v))return!1;var O=h.get(l);d(O)&&(O=new x,h.set(l,O)),O.set(y,_)}return!0}}function Ee(){var e;return!d(P)&&b(s.Reflect)&&Object.isExtensible(s.Reflect)&&(e=s.Reflect[P]),d(e)&&(e=Me()),!d(P)&&b(s.Reflect)&&Object.isExtensible(s.Reflect)&&Object.defineProperty(s.Reflect,P,{enumerable:!1,configurable:!1,writable:!1,value:e}),e}function je(e){var r=new K,n={isProviderFor:function(c,f){var l=r.get(c);return d(l)?!1:l.has(f)},OrdinaryDefineOwnMetadata:m,OrdinaryHasOwnMetadata:h,OrdinaryGetOwnMetadata:k,OrdinaryOwnMetadataKeys:p,OrdinaryDeleteMetadata:u};return V.registerProvider(n),n;function a(c,f,l){var y=r.get(c),_=!1;if(d(y)){if(!l)return;y=new x,r.set(c,y),_=!0}var v=y.get(f);if(d(v)){if(!l)return;if(v=new x,y.set(f,v),!e.setProvider(c,f,n))throw y.delete(f),_&&r.delete(c),new Error("Wrong provider for target.")}return v}function h(c,f,l){var y=a(f,l,!1);return d(y)?!1:oe(y.has(c))}function k(c,f,l){var y=a(f,l,!1);if(!d(y))return y.get(c)}function m(c,f,l,y){var _=a(l,y,!0);_.set(c,f)}function p(c,f){var l=[],y=a(c,f,!1);if(d(y))return l;for(var _=y.keys(),v=ce(_),O=0;;){var de=le(v);if(!de)return l.length=O,l;var Ae=fe(de);try{l[O]=Ae}catch(xe){try{he(v)}finally{throw xe}}O++}}function u(c,f,l){var y=a(f,l,!1);if(d(y)||!y.delete(c))return!1;if(y.size===0){var _=r.get(f);d(_)||(_.delete(l),_.size===0&&r.delete(_))}return!0}}function Te(e){var r=e.defineMetadata,n=e.hasOwnMetadata,a=e.getOwnMetadata,h=e.getOwnMetadataKeys,k=e.deleteMetadata,m=new K,p={isProviderFor:function(u,c){var f=m.get(u);return!d(f)&&f.has(c)?!0:h(u,c).length?(d(f)&&(f=new W,m.set(u,f)),f.add(c),!0):!1},OrdinaryDefineOwnMetadata:r,OrdinaryHasOwnMetadata:n,OrdinaryGetOwnMetadata:a,OrdinaryOwnMetadataKeys:h,OrdinaryDeleteMetadata:k};return p}function D(e,r,n){var a=V.getProvider(e,r);if(!d(a))return a;if(n){if(V.setProvider(e,r,J))return J;throw new Error("Illegal state.")}}function Ie(){var e={},r=[],n=function(){function p(u,c,f){this._index=0,this._keys=u,this._values=c,this._selector=f}return p.prototype["@@iterator"]=function(){return this},p.prototype[S]=function(){return this},p.prototype.next=function(){var u=this._index;if(u>=0&&u<this._keys.length){var c=this._selector(this._keys[u],this._values[u]);return u+1>=this._keys.length?(this._index=-1,this._keys=r,this._values=r):this._index++,{value:c,done:!1}}return{value:void 0,done:!0}},p.prototype.throw=function(u){throw this._index>=0&&(this._index=-1,this._keys=r,this._values=r),u},p.prototype.return=function(u){return this._index>=0&&(this._index=-1,this._keys=r,this._values=r),{value:u,done:!0}},p}(),a=function(){function p(){this._keys=[],this._values=[],this._cacheKey=e,this._cacheIndex=-2}return Object.defineProperty(p.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),p.prototype.has=function(u){return this._find(u,!1)>=0},p.prototype.get=function(u){var c=this._find(u,!1);return c>=0?this._values[c]:void 0},p.prototype.set=function(u,c){var f=this._find(u,!0);return this._values[f]=c,this},p.prototype.delete=function(u){var c=this._find(u,!1);if(c>=0){for(var f=this._keys.length,l=c+1;l<f;l++)this._keys[l-1]=this._keys[l],this._values[l-1]=this._values[l];return this._keys.length--,this._values.length--,H(u,this._cacheKey)&&(this._cacheKey=e,this._cacheIndex=-2),!0}return!1},p.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=e,this._cacheIndex=-2},p.prototype.keys=function(){return new n(this._keys,this._values,h)},p.prototype.values=function(){return new n(this._keys,this._values,k)},p.prototype.entries=function(){return new n(this._keys,this._values,m)},p.prototype["@@iterator"]=function(){return this.entries()},p.prototype[S]=function(){return this.entries()},p.prototype._find=function(u,c){if(!H(this._cacheKey,u)){this._cacheIndex=-1;for(var f=0;f<this._keys.length;f++)if(H(this._keys[f],u)){this._cacheIndex=f;break}}return this._cacheIndex<0&&c&&(this._cacheIndex=this._keys.length,this._keys.push(u),this._values.push(void 0)),this._cacheIndex},p}();return a;function h(p,u){return p}function k(p,u){return u}function m(p,u){return[p,u]}}function Pe(){var e=function(){function r(){this._map=new x}return Object.defineProperty(r.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),r.prototype.has=function(n){return this._map.has(n)},r.prototype.add=function(n){return this._map.set(n,n),this},r.prototype.delete=function(n){return this._map.delete(n)},r.prototype.clear=function(){this._map.clear()},r.prototype.keys=function(){return this._map.keys()},r.prototype.values=function(){return this._map.keys()},r.prototype.entries=function(){return this._map.entries()},r.prototype["@@iterator"]=function(){return this.keys()},r.prototype[S]=function(){return this.keys()},r}();return e}function Re(){var e=16,r=E.create(),n=a();return function(){function u(){this._key=a()}return u.prototype.has=function(c){var f=h(c,!1);return f!==void 0?E.has(f,this._key):!1},u.prototype.get=function(c){var f=h(c,!1);return f!==void 0?E.get(f,this._key):void 0},u.prototype.set=function(c,f){var l=h(c,!0);return l[this._key]=f,this},u.prototype.delete=function(c){var f=h(c,!1);return f!==void 0?delete f[this._key]:!1},u.prototype.clear=function(){this._key=a()},u}();function a(){var u;do u="@@WeakMap@@"+p();while(E.has(r,u));return r[u]=!0,u}function h(u,c){if(!w.call(u,n)){if(!c)return;Object.defineProperty(u,n,{value:E.create()})}return u[n]}function k(u,c){for(var f=0;f<c;++f)u[f]=Math.random()*255|0;return u}function m(u){if(typeof Uint8Array=="function"){var c=new Uint8Array(u);return typeof crypto<"u"?crypto.getRandomValues(c):typeof msCrypto<"u"?msCrypto.getRandomValues(c):k(c,u),c}return k(new Array(u),u)}function p(){var u=m(e);u[6]=u[6]&79|64,u[8]=u[8]&191|128;for(var c="",f=0;f<e;++f){var l=u[f];(f===4||f===6||f===8)&&(c+="-"),l<16&&(c+="0"),c+=l.toString(16).toLowerCase()}return c}}function q(e){return e.__=void 0,delete e.__,e}})}(i||(i={})),$t}Er();const ht=Symbol("ARTIFACTS");let jr=class{constructor(t){lt(this,"_recognizableHooks",new Map),lt(this,"_hookDependencies",new Map),lt(this,"_installedHooks",new Map);for(const[o,{hook:s,deps:w}]of Object.entries(t))this._recognizableHooks.set(o,s),w&&this._hookDependencies.set(o,w||[])}isHookInstalled(t,o){const s=this._recognizableHooks.get(o);if(!s||!this._installedHooks.has(t))return!1;const w=this._installedHooks.get(t);return w?w.some(g=>g===s):!1}markHookAsInstalled(t,o){var s;const w=this._recognizableHooks.get(o);if(!w)throw new Error(`Hook ${o} not found`);this._installedHooks.has(t)||this._installedHooks.set(t,[]),(s=this._installedHooks.get(t))==null||s.push(w)}async installHook(t,o){const s=this._recognizableHooks.get(t);if(!s)throw new Error(`Hook ${t} not found`);if(this.isHookInstalled(o,t))return;const w=this._hookDependencies.get(t)||[];for(const T of w)await this.installHook(T,o);const g=Reflect.getMetadata(ht,o)||{};Reflect.hasMetadata(ht,o)||Reflect.defineMetadata(ht,g,o);for(const T of s){const S=await T.install({sdk:o,artifacts:g});!S||typeof S!="object"||Object.assign(g,S)}this.markHookAsInstalled(o,t)}async installAllHooks(t){for(const o of this._recognizableHooks.keys())await this.installHook(o,t)}};var Tr=Object.defineProperty,Ir=(i,t,o)=>t in i?Tr(i,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):i[t]=o,Ke=(i,t,o)=>Ir(i,typeof t!="symbol"?t+"":t,o),Pr=Object.defineProperty,Rr=(i,t,o)=>t in i?Pr(i,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):i[t]=o,tt=(i,t,o)=>Rr(i,typeof t!="symbol"?t+"":t,o),Ft=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Vt={};/*! *****************************************************************************
  Copyright (C) Microsoft. All rights reserved.
  Licensed under the Apache License, Version 2.0 (the "License"); you may not use
  this file except in compliance with the License. You may obtain a copy of the
  License at http://www.apache.org/licenses/LICENSE-2.0

  THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
  WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
  MERCHANTABLITY OR NON-INFRINGEMENT.

  See the Apache Version 2.0 License for specific language governing permissions
  and limitations under the License.
  ***************************************************************************** */var Ct;function Ar(){if(Ct)return Vt;Ct=1;var i;return function(t){(function(o){var s=typeof globalThis=="object"?globalThis:typeof Ft=="object"?Ft:typeof self=="object"?self:typeof this=="object"?this:j(),w=g(t);typeof s.Reflect<"u"&&(w=g(s.Reflect,w)),o(w,s),typeof s.Reflect>"u"&&(s.Reflect=t);function g($,I){return function(E,A){Object.defineProperty($,E,{configurable:!0,writable:!0,value:A}),I&&I(E,A)}}function T(){try{return Function("return this;")()}catch{}}function S(){try{return(0,eval)("(function() { return this; })()")}catch{}}function j(){return T()||S()}})(function(o,s){var w=Object.prototype.hasOwnProperty,g=typeof Symbol=="function",T=g&&typeof Symbol.toPrimitive<"u"?Symbol.toPrimitive:"@@toPrimitive",S=g&&typeof Symbol.iterator<"u"?Symbol.iterator:"@@iterator",j=typeof Object.create=="function",$={__proto__:[]}instanceof Array,I=!j&&!$,E={create:j?function(){return q(Object.create(null))}:$?function(){return q({__proto__:null})}:function(){return q({})},has:I?function(e,r){return w.call(e,r)}:function(e,r){return r in e},get:I?function(e,r){return w.call(e,r)?e[r]:void 0}:function(e,r){return e[r]}},A=Object.getPrototypeOf(Function),x=typeof Map=="function"&&typeof Map.prototype.entries=="function"?Map:Ie(),W=typeof Set=="function"&&typeof Set.prototype.entries=="function"?Set:Pe(),K=typeof WeakMap=="function"?WeakMap:Re(),P=g?Symbol.for("@reflect-metadata:registry"):void 0,V=Ee(),J=je(V);function we(e,r,n,a){if(d(n)){if(!ae(e))throw new TypeError;if(!se(r))throw new TypeError;return ge(e,r)}else{if(!ae(e))throw new TypeError;if(!b(r))throw new TypeError;if(!b(a)&&!d(a)&&!R(a))throw new TypeError;return R(a)&&(a=void 0),n=M(n),ve(e,r,n,a)}}o("decorate",we);function F(e,r){function n(a,h){if(!b(a))throw new TypeError;if(!d(h)&&!Se(h))throw new TypeError;te(e,r,a,h)}return n}o("metadata",F);function C(e,r,n,a){if(!b(n))throw new TypeError;return d(a)||(a=M(a)),te(e,r,n,a)}o("defineMetadata",C);function L(e,r,n){if(!b(r))throw new TypeError;return d(n)||(n=M(n)),Q(e,r,n)}o("hasMetadata",L);function G(e,r,n){if(!b(r))throw new TypeError;return d(n)||(n=M(n)),N(e,r,n)}o("hasOwnMetadata",G);function ye(e,r,n){if(!b(r))throw new TypeError;return d(n)||(n=M(n)),X(e,r,n)}o("getMetadata",ye);function Z(e,r,n){if(!b(r))throw new TypeError;return d(n)||(n=M(n)),ee(e,r,n)}o("getOwnMetadata",Z);function Y(e,r){if(!b(e))throw new TypeError;return d(r)||(r=M(r)),re(e,r)}o("getMetadataKeys",Y);function pe(e,r){if(!b(e))throw new TypeError;return d(r)||(r=M(r)),ne(e,r)}o("getOwnMetadataKeys",pe);function _e(e,r,n){if(!b(r))throw new TypeError;if(d(n)||(n=M(n)),!b(r))throw new TypeError;d(n)||(n=M(n));var a=D(r,n,!1);return d(a)?!1:a.OrdinaryDeleteMetadata(e,r,n)}o("deleteMetadata",_e);function ge(e,r){for(var n=e.length-1;n>=0;--n){var a=e[n],h=a(r);if(!d(h)&&!R(h)){if(!se(h))throw new TypeError;r=h}}return r}function ve(e,r,n,a){for(var h=e.length-1;h>=0;--h){var k=e[h],m=k(r,n,a);if(!d(m)&&!R(m)){if(!b(m))throw new TypeError;a=m}}return a}function Q(e,r,n){var a=N(e,r,n);if(a)return!0;var h=U(r);return R(h)?!1:Q(e,h,n)}function N(e,r,n){var a=D(r,n,!1);return d(a)?!1:oe(a.OrdinaryHasOwnMetadata(e,r,n))}function X(e,r,n){var a=N(e,r,n);if(a)return ee(e,r,n);var h=U(r);if(!R(h))return X(e,h,n)}function ee(e,r,n){var a=D(r,n,!1);if(!d(a))return a.OrdinaryGetOwnMetadata(e,r,n)}function te(e,r,n,a){var h=D(n,a,!0);h.OrdinaryDefineOwnMetadata(e,r,n,a)}function re(e,r){var n=ne(e,r),a=U(e);if(a===null)return n;var h=re(a,r);if(h.length<=0)return n;if(n.length<=0)return h;for(var k=new W,m=[],p=0,u=n;p<u.length;p++){var c=u[p],f=k.has(c);f||(k.add(c),m.push(c))}for(var l=0,y=h;l<y.length;l++){var c=y[l],f=k.has(c);f||(k.add(c),m.push(c))}return m}function ne(e,r){var n=D(e,r,!1);return n?n.OrdinaryOwnMetadataKeys(e,r):[]}function ie(e){if(e===null)return 1;switch(typeof e){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return e===null?1:6;default:return 6}}function d(e){return e===void 0}function R(e){return e===null}function be(e){return typeof e=="symbol"}function b(e){return typeof e=="object"?e!==null:typeof e=="function"}function me(e,r){switch(ie(e)){case 0:return e;case 1:return e;case 2:return e;case 3:return e;case 4:return e;case 5:return e}var n="string",a=ue(e,T);if(a!==void 0){var h=a.call(e,n);if(b(h))throw new TypeError;return h}return ke(e)}function ke(e,r){var n,a;{var h=e.toString;if(z(h)){var a=h.call(e);if(!b(a))return a}var n=e.valueOf;if(z(n)){var a=n.call(e);if(!b(a))return a}}throw new TypeError}function oe(e){return!!e}function Oe(e){return""+e}function M(e){var r=me(e);return be(r)?r:Oe(r)}function ae(e){return Array.isArray?Array.isArray(e):e instanceof Object?e instanceof Array:Object.prototype.toString.call(e)==="[object Array]"}function z(e){return typeof e=="function"}function se(e){return typeof e=="function"}function Se(e){switch(ie(e)){case 3:return!0;case 4:return!0;default:return!1}}function H(e,r){return e===r||e!==e&&r!==r}function ue(e,r){var n=e[r];if(n!=null){if(!z(n))throw new TypeError;return n}}function ce(e){var r=ue(e,S);if(!z(r))throw new TypeError;var n=r.call(e);if(!b(n))throw new TypeError;return n}function fe(e){return e.value}function le(e){var r=e.next();return r.done?!1:r}function he(e){var r=e.return;r&&r.call(e)}function U(e){var r=Object.getPrototypeOf(e);if(typeof e!="function"||e===A||r!==A)return r;var n=e.prototype,a=n&&Object.getPrototypeOf(n);if(a==null||a===Object.prototype)return r;var h=a.constructor;return typeof h!="function"||h===e?r:h}function Me(){var e;!d(P)&&typeof s.Reflect<"u"&&!(P in s.Reflect)&&typeof s.Reflect.defineMetadata=="function"&&(e=Te(s.Reflect));var r,n,a,h=new K,k={registerProvider:m,getProvider:u,setProvider:f};return k;function m(l){if(!Object.isExtensible(k))throw new Error("Cannot add provider to a frozen registry.");switch(!0){case e===l:break;case d(r):r=l;break;case r===l:break;case d(n):n=l;break;case n===l:break;default:a===void 0&&(a=new W),a.add(l);break}}function p(l,y){if(!d(r)){if(r.isProviderFor(l,y))return r;if(!d(n)){if(n.isProviderFor(l,y))return r;if(!d(a))for(var _=ce(a);;){var v=le(_);if(!v)return;var O=fe(v);if(O.isProviderFor(l,y))return he(_),O}}}if(!d(e)&&e.isProviderFor(l,y))return e}function u(l,y){var _=h.get(l),v;return d(_)||(v=_.get(y)),d(v)&&(v=p(l,y),d(v)||(d(_)&&(_=new x,h.set(l,_)),_.set(y,v))),v}function c(l){if(d(l))throw new TypeError;return r===l||n===l||!d(a)&&a.has(l)}function f(l,y,_){if(!c(_))throw new Error("Metadata provider not registered.");var v=u(l,y);if(v!==_){if(!d(v))return!1;var O=h.get(l);d(O)&&(O=new x,h.set(l,O)),O.set(y,_)}return!0}}function Ee(){var e;return!d(P)&&b(s.Reflect)&&Object.isExtensible(s.Reflect)&&(e=s.Reflect[P]),d(e)&&(e=Me()),!d(P)&&b(s.Reflect)&&Object.isExtensible(s.Reflect)&&Object.defineProperty(s.Reflect,P,{enumerable:!1,configurable:!1,writable:!1,value:e}),e}function je(e){var r=new K,n={isProviderFor:function(c,f){var l=r.get(c);return d(l)?!1:l.has(f)},OrdinaryDefineOwnMetadata:m,OrdinaryHasOwnMetadata:h,OrdinaryGetOwnMetadata:k,OrdinaryOwnMetadataKeys:p,OrdinaryDeleteMetadata:u};return V.registerProvider(n),n;function a(c,f,l){var y=r.get(c),_=!1;if(d(y)){if(!l)return;y=new x,r.set(c,y),_=!0}var v=y.get(f);if(d(v)){if(!l)return;if(v=new x,y.set(f,v),!e.setProvider(c,f,n))throw y.delete(f),_&&r.delete(c),new Error("Wrong provider for target.")}return v}function h(c,f,l){var y=a(f,l,!1);return d(y)?!1:oe(y.has(c))}function k(c,f,l){var y=a(f,l,!1);if(!d(y))return y.get(c)}function m(c,f,l,y){var _=a(l,y,!0);_.set(c,f)}function p(c,f){var l=[],y=a(c,f,!1);if(d(y))return l;for(var _=y.keys(),v=ce(_),O=0;;){var de=le(v);if(!de)return l.length=O,l;var Ae=fe(de);try{l[O]=Ae}catch(xe){try{he(v)}finally{throw xe}}O++}}function u(c,f,l){var y=a(f,l,!1);if(d(y)||!y.delete(c))return!1;if(y.size===0){var _=r.get(f);d(_)||(_.delete(l),_.size===0&&r.delete(_))}return!0}}function Te(e){var r=e.defineMetadata,n=e.hasOwnMetadata,a=e.getOwnMetadata,h=e.getOwnMetadataKeys,k=e.deleteMetadata,m=new K,p={isProviderFor:function(u,c){var f=m.get(u);return!d(f)&&f.has(c)?!0:h(u,c).length?(d(f)&&(f=new W,m.set(u,f)),f.add(c),!0):!1},OrdinaryDefineOwnMetadata:r,OrdinaryHasOwnMetadata:n,OrdinaryGetOwnMetadata:a,OrdinaryOwnMetadataKeys:h,OrdinaryDeleteMetadata:k};return p}function D(e,r,n){var a=V.getProvider(e,r);if(!d(a))return a;if(n){if(V.setProvider(e,r,J))return J;throw new Error("Illegal state.")}}function Ie(){var e={},r=[],n=function(){function p(u,c,f){this._index=0,this._keys=u,this._values=c,this._selector=f}return p.prototype["@@iterator"]=function(){return this},p.prototype[S]=function(){return this},p.prototype.next=function(){var u=this._index;if(u>=0&&u<this._keys.length){var c=this._selector(this._keys[u],this._values[u]);return u+1>=this._keys.length?(this._index=-1,this._keys=r,this._values=r):this._index++,{value:c,done:!1}}return{value:void 0,done:!0}},p.prototype.throw=function(u){throw this._index>=0&&(this._index=-1,this._keys=r,this._values=r),u},p.prototype.return=function(u){return this._index>=0&&(this._index=-1,this._keys=r,this._values=r),{value:u,done:!0}},p}(),a=function(){function p(){this._keys=[],this._values=[],this._cacheKey=e,this._cacheIndex=-2}return Object.defineProperty(p.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),p.prototype.has=function(u){return this._find(u,!1)>=0},p.prototype.get=function(u){var c=this._find(u,!1);return c>=0?this._values[c]:void 0},p.prototype.set=function(u,c){var f=this._find(u,!0);return this._values[f]=c,this},p.prototype.delete=function(u){var c=this._find(u,!1);if(c>=0){for(var f=this._keys.length,l=c+1;l<f;l++)this._keys[l-1]=this._keys[l],this._values[l-1]=this._values[l];return this._keys.length--,this._values.length--,H(u,this._cacheKey)&&(this._cacheKey=e,this._cacheIndex=-2),!0}return!1},p.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=e,this._cacheIndex=-2},p.prototype.keys=function(){return new n(this._keys,this._values,h)},p.prototype.values=function(){return new n(this._keys,this._values,k)},p.prototype.entries=function(){return new n(this._keys,this._values,m)},p.prototype["@@iterator"]=function(){return this.entries()},p.prototype[S]=function(){return this.entries()},p.prototype._find=function(u,c){if(!H(this._cacheKey,u)){this._cacheIndex=-1;for(var f=0;f<this._keys.length;f++)if(H(this._keys[f],u)){this._cacheIndex=f;break}}return this._cacheIndex<0&&c&&(this._cacheIndex=this._keys.length,this._keys.push(u),this._values.push(void 0)),this._cacheIndex},p}();return a;function h(p,u){return p}function k(p,u){return u}function m(p,u){return[p,u]}}function Pe(){var e=function(){function r(){this._map=new x}return Object.defineProperty(r.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),r.prototype.has=function(n){return this._map.has(n)},r.prototype.add=function(n){return this._map.set(n,n),this},r.prototype.delete=function(n){return this._map.delete(n)},r.prototype.clear=function(){this._map.clear()},r.prototype.keys=function(){return this._map.keys()},r.prototype.values=function(){return this._map.keys()},r.prototype.entries=function(){return this._map.entries()},r.prototype["@@iterator"]=function(){return this.keys()},r.prototype[S]=function(){return this.keys()},r}();return e}function Re(){var e=16,r=E.create(),n=a();return function(){function u(){this._key=a()}return u.prototype.has=function(c){var f=h(c,!1);return f!==void 0?E.has(f,this._key):!1},u.prototype.get=function(c){var f=h(c,!1);return f!==void 0?E.get(f,this._key):void 0},u.prototype.set=function(c,f){var l=h(c,!0);return l[this._key]=f,this},u.prototype.delete=function(c){var f=h(c,!1);return f!==void 0?delete f[this._key]:!1},u.prototype.clear=function(){this._key=a()},u}();function a(){var u;do u="@@WeakMap@@"+p();while(E.has(r,u));return r[u]=!0,u}function h(u,c){if(!w.call(u,n)){if(!c)return;Object.defineProperty(u,n,{value:E.create()})}return u[n]}function k(u,c){for(var f=0;f<c;++f)u[f]=Math.random()*255|0;return u}function m(u){if(typeof Uint8Array=="function"){var c=new Uint8Array(u);return typeof crypto<"u"?crypto.getRandomValues(c):typeof msCrypto<"u"?msCrypto.getRandomValues(c):k(c,u),c}return k(new Array(u),u)}function p(){var u=m(e);u[6]=u[6]&79|64,u[8]=u[8]&191|128;for(var c="",f=0;f<e;++f){var l=u[f];(f===4||f===6||f===8)&&(c+="-"),l<16&&(c+="0"),c+=l.toString(16).toLowerCase()}return c}}function q(e){return e.__=void 0,delete e.__,e}})}(i||(i={})),Vt}Ar();var xr=Object.defineProperty,$r=(i,t,o)=>t in i?xr(i,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):i[t]=o,We=(i,t,o)=>$r(i,typeof t!="symbol"?t+"":t,o);let Dr=class{constructor(t,o){We(this,"_target"),We(this,"_key"),We(this,"_oldValue"),We(this,"_wasDefined",!1),We(this,"_isSwapped",!1),this._target=t,this._key=o,this._oldValue=this._target[this._key]}get isSwapped(){return this._isSwapped}get originalValue(){return this._oldValue}get value(){return this._target[this._key]}get target(){return this._target}restore(){this.isSwapped&&(this._wasDefined?this._target[this._key]=this._oldValue:delete this._target[this._key],this._isSwapped=!1)}swap(t){this.isSwapped||(this._wasDefined=Object.hasOwn(this._target,this._key),this._oldValue=this._target[this._key]),this._target[this._key]=t,this._isSwapped=!0}};const Fr={onlyIfNotExists:!0,isFactory:!1};class rt{constructor(t,o,s={}){if(tt(this,"_installedInstances",new Map),tt(this,"_path"),tt(this,"_targetValue"),tt(this,"_options"),this._path=t.split("."),this._path.length===0)throw new Error("Path must not be empty");this._targetValue=o,this._options={...Fr,...s}}_getTargetObject(t){let o=t;for(const s of this._path.slice(0,this._path.length-1))o[s]||(o[s]={}),o=o[s];return o}_createSwapper(t){const o=this._getTargetObject(t);return new Dr(o,this._path.at(-1))}install({sdk:t,...o}){if(this._installedInstances.has(t))return;const s=this._createSwapper(t);if(!(s.value&&this._options.onlyIfNotExists)){if(this._options.isFactory&&typeof this._targetValue=="function"){const w=this._targetValue({sdk:t,...o});s.swap(w)}else s.swap(this._targetValue);this._installedInstances.set(t,s)}}uninstall({sdk:t}){const o=this._installedInstances.get(t);o&&(o.restore(),this._installedInstances.delete(t))}}function zt(){return"unsafeWindow"in window?window.unsafeWindow:window}var Vr=Object.defineProperty,Cr=(i,t,o)=>t in i?Vr(i,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):i[t]=o,$e=(i,t,o)=>Cr(i,typeof t!="symbol"?t+"":t,o);class zr{constructor(t,o){$e(this,"_target"),$e(this,"_key"),$e(this,"_oldValue"),$e(this,"_wasDefined",!1),$e(this,"_isSwapped",!1),this._target=t,this._key=o,this._oldValue=this._target[this._key]}get isSwapped(){return this._isSwapped}get originalValue(){return this._oldValue}get value(){return this._target[this._key]}get target(){return this._target}restore(){this.isSwapped&&(this._wasDefined?this._target[this._key]=this._oldValue:delete this._target[this._key],this._isSwapped=!1)}swap(t){this.isSwapped||(this._wasDefined=Object.hasOwn(this._target,this._key),this._oldValue=this._target[this._key]),this._target[this._key]=t,this._isSwapped=!0}}let dt=class{constructor(t,o,s){$e(this,"_enabled",!1),$e(this,"_fnSwapper"),$e(this,"_interceptionFunction"),$e(this,"_middlewares",[]),this._fnSwapper=new zr(t,o),this._interceptionFunction=s}get enabled(){return this._fnSwapper.isSwapped&&this._enabled}disable(){this._enabled=!1,this.enabled}restore(){this._fnSwapper.restore()}enable(){this._enabled=!0,this._fnSwapper.isSwapped||this.swapToInterceptor()}swapToInterceptor(){const t=this;this._fnSwapper.swap(function(...o){if(!t._enabled)return t.callOriginalInvocator(...o);const s=t.runMiddlewares(o);if(s){if("output"in s)return s.output;"input"in s&&(o=s.input)}return t._interceptionFunction.call(this,t.getOriginalInvocator(this),...o)})}getOriginalInvocator(t){return this._fnSwapper.originalValue.bind(t??this._fnSwapper.target)}callOriginalInvocator(...t){return this.getOriginalInvocator()(...t)}runMiddlewares(t){for(const o of this._middlewares){const s=o(...t);if(s){if("output"in s)return s;"input"in s&&(t=s.input)}}return{input:t}}registerMiddleware(t){this._middlewares.push(t)}};function Kr(i,t){try{return i()}catch{return t}}let Wr=class extends dt{constructor(t,o,s){super(t,o,s),$e(this,"_loggedInvocationRequests",[]),this.registerMiddleware((...w)=>this.logRequest(...w))}logRequest(...t){this._loggedInvocationRequests.push(t)}flushLoggedRequests(){const t=this.getLoggedRequests();return this._loggedInvocationRequests=[],t}getLoggedRequests(){return this._loggedInvocationRequests}executeOriginalLoggedRequests(){this.flushLoggedRequests().forEach(t=>Kr(()=>this.callOriginalInvocator(...t)))}},Nr=class{constructor(){Ke(this,"_hasResult",!1),Ke(this,"result")}store(t){return this.result=t,this._hasResult=!0,t}clear(){this.result=void 0,this._hasResult=!1}getResult(){if(!this.hasResult)throw new Error("No result is stored");return this.result}get hasResult(){return this._hasResult}};function Hr(i){const t=new Nr;new dt(i,"doAction",(o,...s)=>t.hasResult?t.getResult():t.store(o(...s))).enable(),new dt(i,"undoAction",(o,...s)=>{const w=o(...s);return t.clear(),w}).enable()}let Ur=class{constructor(){Ke(this,"actions",[]),Ke(this,"undoableActions",[])}acceptAction(t,o){const s={action:t,dataModel:o};t.undoSupported()&&(Hr(t),t.doAction(o),this.undoableActions.push(s)),this.actions.push(s)}undoAll(){this.undoableActions.forEach(({action:t,dataModel:o})=>t.undoAction(o))}getActions(){return this.actions.map(({action:t})=>t)}};function qr(){try{return zt().require("Waze/Action/MultiAction")}catch{return null}}function Lr(i){const t=qr();if(!t)throw new Error("Unable to retrieve MultiAction");return new t(i)}let Gr=class{constructor(t){Ke(this,"_activeTransaction",null),Ke(this,"_actionManagerAddInterceptor"),this._actionManagerAddInterceptor=new Wr(t,"add",(o,s)=>{var w,g;return(g=(w=this._activeTransaction)==null?void 0:w.acceptAction)==null||g.call(w,s,t.dataModel),!0})}openTransaction(){this._activeTransaction=new Ur,this._actionManagerAddInterceptor.enable()}closeTransaction(){const t=this._activeTransaction;return this._activeTransaction=null,this._actionManagerAddInterceptor.flushLoggedRequests(),this._actionManagerAddInterceptor.disable(),t}get hasTransaction(){return this._activeTransaction!==null}beginTransaction(){this.openTransaction()}commitTransaction(t){if(!this.hasTransaction)throw new Error("No open transaction found");try{const o=this._activeTransaction.getActions(),s=Lr(o);t&&(s._description=t),this._actionManagerAddInterceptor.callOriginalInvocator(s)}catch{this._actionManagerAddInterceptor.executeOriginalLoggedRequests()}finally{this.closeTransaction()}}cancelTransaction(){var t;(t=this._activeTransaction)==null||t.undoAll(),this.closeTransaction()}},pt;function nt(){if(!pt){const i=zt();pt=new Gr(i.W.model.actionManager)}return pt}const Br=[new rt("Editing.beginTransaction",()=>nt().beginTransaction()),new rt("Editing.commitTransaction",i=>nt().commitTransaction(i)),new rt("Editing.cancelTransaction",()=>nt().cancelTransaction()),new rt("Editing.doActions",(i,t)=>{const o=nt();o.beginTransaction();try{i(),o.commitTransaction(t)}catch(s){throw o.cancelTransaction(),s}})];var Jr=Object.defineProperty,Zr=(i,t,o)=>t in i?Jr(i,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):i[t]=o,it=(i,t,o)=>Zr(i,typeof t!="symbol"?t+"":t,o),Kt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Wt={};/*! *****************************************************************************
  Copyright (C) Microsoft. All rights reserved.
  Licensed under the Apache License, Version 2.0 (the "License"); you may not use
  this file except in compliance with the License. You may obtain a copy of the
  License at http://www.apache.org/licenses/LICENSE-2.0

  THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
  WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
  MERCHANTABLITY OR NON-INFRINGEMENT.

  See the Apache Version 2.0 License for specific language governing permissions
  and limitations under the License.
  ***************************************************************************** */var Nt;function Yr(){if(Nt)return Wt;Nt=1;var i;return function(t){(function(o){var s=typeof globalThis=="object"?globalThis:typeof Kt=="object"?Kt:typeof self=="object"?self:typeof this=="object"?this:j(),w=g(t);typeof s.Reflect<"u"&&(w=g(s.Reflect,w)),o(w,s),typeof s.Reflect>"u"&&(s.Reflect=t);function g($,I){return function(E,A){Object.defineProperty($,E,{configurable:!0,writable:!0,value:A}),I&&I(E,A)}}function T(){try{return Function("return this;")()}catch{}}function S(){try{return(0,eval)("(function() { return this; })()")}catch{}}function j(){return T()||S()}})(function(o,s){var w=Object.prototype.hasOwnProperty,g=typeof Symbol=="function",T=g&&typeof Symbol.toPrimitive<"u"?Symbol.toPrimitive:"@@toPrimitive",S=g&&typeof Symbol.iterator<"u"?Symbol.iterator:"@@iterator",j=typeof Object.create=="function",$={__proto__:[]}instanceof Array,I=!j&&!$,E={create:j?function(){return q(Object.create(null))}:$?function(){return q({__proto__:null})}:function(){return q({})},has:I?function(e,r){return w.call(e,r)}:function(e,r){return r in e},get:I?function(e,r){return w.call(e,r)?e[r]:void 0}:function(e,r){return e[r]}},A=Object.getPrototypeOf(Function),x=typeof Map=="function"&&typeof Map.prototype.entries=="function"?Map:Ie(),W=typeof Set=="function"&&typeof Set.prototype.entries=="function"?Set:Pe(),K=typeof WeakMap=="function"?WeakMap:Re(),P=g?Symbol.for("@reflect-metadata:registry"):void 0,V=Ee(),J=je(V);function we(e,r,n,a){if(d(n)){if(!ae(e))throw new TypeError;if(!se(r))throw new TypeError;return ge(e,r)}else{if(!ae(e))throw new TypeError;if(!b(r))throw new TypeError;if(!b(a)&&!d(a)&&!R(a))throw new TypeError;return R(a)&&(a=void 0),n=M(n),ve(e,r,n,a)}}o("decorate",we);function F(e,r){function n(a,h){if(!b(a))throw new TypeError;if(!d(h)&&!Se(h))throw new TypeError;te(e,r,a,h)}return n}o("metadata",F);function C(e,r,n,a){if(!b(n))throw new TypeError;return d(a)||(a=M(a)),te(e,r,n,a)}o("defineMetadata",C);function L(e,r,n){if(!b(r))throw new TypeError;return d(n)||(n=M(n)),Q(e,r,n)}o("hasMetadata",L);function G(e,r,n){if(!b(r))throw new TypeError;return d(n)||(n=M(n)),N(e,r,n)}o("hasOwnMetadata",G);function ye(e,r,n){if(!b(r))throw new TypeError;return d(n)||(n=M(n)),X(e,r,n)}o("getMetadata",ye);function Z(e,r,n){if(!b(r))throw new TypeError;return d(n)||(n=M(n)),ee(e,r,n)}o("getOwnMetadata",Z);function Y(e,r){if(!b(e))throw new TypeError;return d(r)||(r=M(r)),re(e,r)}o("getMetadataKeys",Y);function pe(e,r){if(!b(e))throw new TypeError;return d(r)||(r=M(r)),ne(e,r)}o("getOwnMetadataKeys",pe);function _e(e,r,n){if(!b(r))throw new TypeError;if(d(n)||(n=M(n)),!b(r))throw new TypeError;d(n)||(n=M(n));var a=D(r,n,!1);return d(a)?!1:a.OrdinaryDeleteMetadata(e,r,n)}o("deleteMetadata",_e);function ge(e,r){for(var n=e.length-1;n>=0;--n){var a=e[n],h=a(r);if(!d(h)&&!R(h)){if(!se(h))throw new TypeError;r=h}}return r}function ve(e,r,n,a){for(var h=e.length-1;h>=0;--h){var k=e[h],m=k(r,n,a);if(!d(m)&&!R(m)){if(!b(m))throw new TypeError;a=m}}return a}function Q(e,r,n){var a=N(e,r,n);if(a)return!0;var h=U(r);return R(h)?!1:Q(e,h,n)}function N(e,r,n){var a=D(r,n,!1);return d(a)?!1:oe(a.OrdinaryHasOwnMetadata(e,r,n))}function X(e,r,n){var a=N(e,r,n);if(a)return ee(e,r,n);var h=U(r);if(!R(h))return X(e,h,n)}function ee(e,r,n){var a=D(r,n,!1);if(!d(a))return a.OrdinaryGetOwnMetadata(e,r,n)}function te(e,r,n,a){var h=D(n,a,!0);h.OrdinaryDefineOwnMetadata(e,r,n,a)}function re(e,r){var n=ne(e,r),a=U(e);if(a===null)return n;var h=re(a,r);if(h.length<=0)return n;if(n.length<=0)return h;for(var k=new W,m=[],p=0,u=n;p<u.length;p++){var c=u[p],f=k.has(c);f||(k.add(c),m.push(c))}for(var l=0,y=h;l<y.length;l++){var c=y[l],f=k.has(c);f||(k.add(c),m.push(c))}return m}function ne(e,r){var n=D(e,r,!1);return n?n.OrdinaryOwnMetadataKeys(e,r):[]}function ie(e){if(e===null)return 1;switch(typeof e){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return e===null?1:6;default:return 6}}function d(e){return e===void 0}function R(e){return e===null}function be(e){return typeof e=="symbol"}function b(e){return typeof e=="object"?e!==null:typeof e=="function"}function me(e,r){switch(ie(e)){case 0:return e;case 1:return e;case 2:return e;case 3:return e;case 4:return e;case 5:return e}var n="string",a=ue(e,T);if(a!==void 0){var h=a.call(e,n);if(b(h))throw new TypeError;return h}return ke(e)}function ke(e,r){var n,a;{var h=e.toString;if(z(h)){var a=h.call(e);if(!b(a))return a}var n=e.valueOf;if(z(n)){var a=n.call(e);if(!b(a))return a}}throw new TypeError}function oe(e){return!!e}function Oe(e){return""+e}function M(e){var r=me(e);return be(r)?r:Oe(r)}function ae(e){return Array.isArray?Array.isArray(e):e instanceof Object?e instanceof Array:Object.prototype.toString.call(e)==="[object Array]"}function z(e){return typeof e=="function"}function se(e){return typeof e=="function"}function Se(e){switch(ie(e)){case 3:return!0;case 4:return!0;default:return!1}}function H(e,r){return e===r||e!==e&&r!==r}function ue(e,r){var n=e[r];if(n!=null){if(!z(n))throw new TypeError;return n}}function ce(e){var r=ue(e,S);if(!z(r))throw new TypeError;var n=r.call(e);if(!b(n))throw new TypeError;return n}function fe(e){return e.value}function le(e){var r=e.next();return r.done?!1:r}function he(e){var r=e.return;r&&r.call(e)}function U(e){var r=Object.getPrototypeOf(e);if(typeof e!="function"||e===A||r!==A)return r;var n=e.prototype,a=n&&Object.getPrototypeOf(n);if(a==null||a===Object.prototype)return r;var h=a.constructor;return typeof h!="function"||h===e?r:h}function Me(){var e;!d(P)&&typeof s.Reflect<"u"&&!(P in s.Reflect)&&typeof s.Reflect.defineMetadata=="function"&&(e=Te(s.Reflect));var r,n,a,h=new K,k={registerProvider:m,getProvider:u,setProvider:f};return k;function m(l){if(!Object.isExtensible(k))throw new Error("Cannot add provider to a frozen registry.");switch(!0){case e===l:break;case d(r):r=l;break;case r===l:break;case d(n):n=l;break;case n===l:break;default:a===void 0&&(a=new W),a.add(l);break}}function p(l,y){if(!d(r)){if(r.isProviderFor(l,y))return r;if(!d(n)){if(n.isProviderFor(l,y))return r;if(!d(a))for(var _=ce(a);;){var v=le(_);if(!v)return;var O=fe(v);if(O.isProviderFor(l,y))return he(_),O}}}if(!d(e)&&e.isProviderFor(l,y))return e}function u(l,y){var _=h.get(l),v;return d(_)||(v=_.get(y)),d(v)&&(v=p(l,y),d(v)||(d(_)&&(_=new x,h.set(l,_)),_.set(y,v))),v}function c(l){if(d(l))throw new TypeError;return r===l||n===l||!d(a)&&a.has(l)}function f(l,y,_){if(!c(_))throw new Error("Metadata provider not registered.");var v=u(l,y);if(v!==_){if(!d(v))return!1;var O=h.get(l);d(O)&&(O=new x,h.set(l,O)),O.set(y,_)}return!0}}function Ee(){var e;return!d(P)&&b(s.Reflect)&&Object.isExtensible(s.Reflect)&&(e=s.Reflect[P]),d(e)&&(e=Me()),!d(P)&&b(s.Reflect)&&Object.isExtensible(s.Reflect)&&Object.defineProperty(s.Reflect,P,{enumerable:!1,configurable:!1,writable:!1,value:e}),e}function je(e){var r=new K,n={isProviderFor:function(c,f){var l=r.get(c);return d(l)?!1:l.has(f)},OrdinaryDefineOwnMetadata:m,OrdinaryHasOwnMetadata:h,OrdinaryGetOwnMetadata:k,OrdinaryOwnMetadataKeys:p,OrdinaryDeleteMetadata:u};return V.registerProvider(n),n;function a(c,f,l){var y=r.get(c),_=!1;if(d(y)){if(!l)return;y=new x,r.set(c,y),_=!0}var v=y.get(f);if(d(v)){if(!l)return;if(v=new x,y.set(f,v),!e.setProvider(c,f,n))throw y.delete(f),_&&r.delete(c),new Error("Wrong provider for target.")}return v}function h(c,f,l){var y=a(f,l,!1);return d(y)?!1:oe(y.has(c))}function k(c,f,l){var y=a(f,l,!1);if(!d(y))return y.get(c)}function m(c,f,l,y){var _=a(l,y,!0);_.set(c,f)}function p(c,f){var l=[],y=a(c,f,!1);if(d(y))return l;for(var _=y.keys(),v=ce(_),O=0;;){var de=le(v);if(!de)return l.length=O,l;var Ae=fe(de);try{l[O]=Ae}catch(xe){try{he(v)}finally{throw xe}}O++}}function u(c,f,l){var y=a(f,l,!1);if(d(y)||!y.delete(c))return!1;if(y.size===0){var _=r.get(f);d(_)||(_.delete(l),_.size===0&&r.delete(_))}return!0}}function Te(e){var r=e.defineMetadata,n=e.hasOwnMetadata,a=e.getOwnMetadata,h=e.getOwnMetadataKeys,k=e.deleteMetadata,m=new K,p={isProviderFor:function(u,c){var f=m.get(u);return!d(f)&&f.has(c)?!0:h(u,c).length?(d(f)&&(f=new W,m.set(u,f)),f.add(c),!0):!1},OrdinaryDefineOwnMetadata:r,OrdinaryHasOwnMetadata:n,OrdinaryGetOwnMetadata:a,OrdinaryOwnMetadataKeys:h,OrdinaryDeleteMetadata:k};return p}function D(e,r,n){var a=V.getProvider(e,r);if(!d(a))return a;if(n){if(V.setProvider(e,r,J))return J;throw new Error("Illegal state.")}}function Ie(){var e={},r=[],n=function(){function p(u,c,f){this._index=0,this._keys=u,this._values=c,this._selector=f}return p.prototype["@@iterator"]=function(){return this},p.prototype[S]=function(){return this},p.prototype.next=function(){var u=this._index;if(u>=0&&u<this._keys.length){var c=this._selector(this._keys[u],this._values[u]);return u+1>=this._keys.length?(this._index=-1,this._keys=r,this._values=r):this._index++,{value:c,done:!1}}return{value:void 0,done:!0}},p.prototype.throw=function(u){throw this._index>=0&&(this._index=-1,this._keys=r,this._values=r),u},p.prototype.return=function(u){return this._index>=0&&(this._index=-1,this._keys=r,this._values=r),{value:u,done:!0}},p}(),a=function(){function p(){this._keys=[],this._values=[],this._cacheKey=e,this._cacheIndex=-2}return Object.defineProperty(p.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),p.prototype.has=function(u){return this._find(u,!1)>=0},p.prototype.get=function(u){var c=this._find(u,!1);return c>=0?this._values[c]:void 0},p.prototype.set=function(u,c){var f=this._find(u,!0);return this._values[f]=c,this},p.prototype.delete=function(u){var c=this._find(u,!1);if(c>=0){for(var f=this._keys.length,l=c+1;l<f;l++)this._keys[l-1]=this._keys[l],this._values[l-1]=this._values[l];return this._keys.length--,this._values.length--,H(u,this._cacheKey)&&(this._cacheKey=e,this._cacheIndex=-2),!0}return!1},p.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=e,this._cacheIndex=-2},p.prototype.keys=function(){return new n(this._keys,this._values,h)},p.prototype.values=function(){return new n(this._keys,this._values,k)},p.prototype.entries=function(){return new n(this._keys,this._values,m)},p.prototype["@@iterator"]=function(){return this.entries()},p.prototype[S]=function(){return this.entries()},p.prototype._find=function(u,c){if(!H(this._cacheKey,u)){this._cacheIndex=-1;for(var f=0;f<this._keys.length;f++)if(H(this._keys[f],u)){this._cacheIndex=f;break}}return this._cacheIndex<0&&c&&(this._cacheIndex=this._keys.length,this._keys.push(u),this._values.push(void 0)),this._cacheIndex},p}();return a;function h(p,u){return p}function k(p,u){return u}function m(p,u){return[p,u]}}function Pe(){var e=function(){function r(){this._map=new x}return Object.defineProperty(r.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),r.prototype.has=function(n){return this._map.has(n)},r.prototype.add=function(n){return this._map.set(n,n),this},r.prototype.delete=function(n){return this._map.delete(n)},r.prototype.clear=function(){this._map.clear()},r.prototype.keys=function(){return this._map.keys()},r.prototype.values=function(){return this._map.keys()},r.prototype.entries=function(){return this._map.entries()},r.prototype["@@iterator"]=function(){return this.keys()},r.prototype[S]=function(){return this.keys()},r}();return e}function Re(){var e=16,r=E.create(),n=a();return function(){function u(){this._key=a()}return u.prototype.has=function(c){var f=h(c,!1);return f!==void 0?E.has(f,this._key):!1},u.prototype.get=function(c){var f=h(c,!1);return f!==void 0?E.get(f,this._key):void 0},u.prototype.set=function(c,f){var l=h(c,!0);return l[this._key]=f,this},u.prototype.delete=function(c){var f=h(c,!1);return f!==void 0?delete f[this._key]:!1},u.prototype.clear=function(){this._key=a()},u}();function a(){var u;do u="@@WeakMap@@"+p();while(E.has(r,u));return r[u]=!0,u}function h(u,c){if(!w.call(u,n)){if(!c)return;Object.defineProperty(u,n,{value:E.create()})}return u[n]}function k(u,c){for(var f=0;f<c;++f)u[f]=Math.random()*255|0;return u}function m(u){if(typeof Uint8Array=="function"){var c=new Uint8Array(u);return typeof crypto<"u"?crypto.getRandomValues(c):typeof msCrypto<"u"?msCrypto.getRandomValues(c):k(c,u),c}return k(new Array(u),u)}function p(){var u=m(e);u[6]=u[6]&79|64,u[8]=u[8]&191|128;for(var c="",f=0;f<e;++f){var l=u[f];(f===4||f===6||f===8)&&(c+="-"),l<16&&(c+="0"),c+=l.toString(16).toLowerCase()}return c}}function q(e){return e.__=void 0,delete e.__,e}})}(i||(i={})),Wt}Yr();var Qr=Object.defineProperty,Xr=(i,t,o)=>t in i?Qr(i,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):i[t]=o,Ne=(i,t,o)=>Xr(i,typeof t!="symbol"?t+"":t,o);let en=class{constructor(t,o){Ne(this,"_target"),Ne(this,"_key"),Ne(this,"_oldValue"),Ne(this,"_wasDefined",!1),Ne(this,"_isSwapped",!1),this._target=t,this._key=o,this._oldValue=this._target[this._key]}get isSwapped(){return this._isSwapped}get originalValue(){return this._oldValue}get value(){return this._target[this._key]}get target(){return this._target}restore(){this.isSwapped&&(this._wasDefined?this._target[this._key]=this._oldValue:delete this._target[this._key],this._isSwapped=!1)}swap(t){this.isSwapped||(this._wasDefined=Object.hasOwn(this._target,this._key),this._oldValue=this._target[this._key]),this._target[this._key]=t,this._isSwapped=!0}};const tn={onlyIfNotExists:!0,isFactory:!1};let Ht=class{constructor(t,o,s={}){if(it(this,"_installedInstances",new Map),it(this,"_path"),it(this,"_targetValue"),it(this,"_options"),this._path=t.split("."),this._path.length===0)throw new Error("Path must not be empty");this._targetValue=o,this._options={...tn,...s}}_getTargetObject(t){let o=t;for(const s of this._path.slice(0,this._path.length-1))o[s]||(o[s]={}),o=o[s];return o}_createSwapper(t){const o=this._getTargetObject(t);return new en(o,this._path.at(-1))}install({sdk:t,...o}){if(this._installedInstances.has(t))return;const s=this._createSwapper(t);if(!(s.value&&this._options.onlyIfNotExists)){if(this._options.isFactory&&typeof this._targetValue=="function"){const w=this._targetValue({sdk:t,...o});s.swap(w)}else s.swap(this._targetValue);this._installedInstances.set(t,s)}}uninstall({sdk:t}){const o=this._installedInstances.get(t);o&&(o.restore(),this._installedInstances.delete(t))}};var rn=Object.defineProperty,nn=(i,t,o)=>t in i?rn(i,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):i[t]=o,He=(i,t,o)=>nn(i,typeof t!="symbol"?t+"":t,o);let on=class{constructor(t,o){He(this,"_target"),He(this,"_key"),He(this,"_oldValue"),He(this,"_wasDefined",!1),He(this,"_isSwapped",!1),this._target=t,this._key=o,this._oldValue=this._target[this._key]}get isSwapped(){return this._isSwapped}get originalValue(){return this._oldValue}get value(){return this._target[this._key]}get target(){return this._target}restore(){this.isSwapped&&(this._wasDefined?this._target[this._key]=this._oldValue:delete this._target[this._key],this._isSwapped=!1)}swap(t){this.isSwapped||(this._wasDefined=Object.hasOwn(this._target,this._key),this._oldValue=this._target[this._key]),this._target[this._key]=t,this._isSwapped=!0}};function yt(){return"unsafeWindow"in window?window.unsafeWindow:window}var an=Object.defineProperty,sn=(i,t,o)=>t in i?an(i,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):i[t]=o,Ut=(i,t,o)=>sn(i,typeof t!="symbol"?t+"":t,o);function Ue(){return"unsafeWindow"in window?window.unsafeWindow:window}var un=Object.defineProperty,cn=(i,t,o)=>t in i?un(i,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):i[t]=o,De=(i,t,o)=>cn(i,typeof t!="symbol"?t+"":t,o);let fn=class{constructor(t,o){De(this,"_target"),De(this,"_key"),De(this,"_oldValue"),De(this,"_wasDefined",!1),De(this,"_isSwapped",!1),this._target=t,this._key=o,this._oldValue=this._target[this._key]}get isSwapped(){return this._isSwapped}get originalValue(){return this._oldValue}get value(){return this._target[this._key]}get target(){return this._target}restore(){this.isSwapped&&(this._wasDefined?this._target[this._key]=this._oldValue:delete this._target[this._key],this._isSwapped=!1)}swap(t){this.isSwapped||(this._wasDefined=Object.hasOwn(this._target,this._key),this._oldValue=this._target[this._key]),this._target[this._key]=t,this._isSwapped=!0}},ln=class{constructor(t,o,s){De(this,"_enabled",!1),De(this,"_fnSwapper"),De(this,"_interceptionFunction"),De(this,"_middlewares",[]),this._fnSwapper=new fn(t,o),this._interceptionFunction=s}get enabled(){return this._fnSwapper.isSwapped&&this._enabled}disable(){this._enabled=!1,this.enabled}restore(){this._fnSwapper.restore()}enable(){this._enabled=!0,this._fnSwapper.isSwapped||this.swapToInterceptor()}swapToInterceptor(){const t=this;this._fnSwapper.swap(function(...o){if(!t._enabled)return t.callOriginalInvocator(...o);const s=t.runMiddlewares(o);if(s){if("output"in s)return s.output;"input"in s&&(o=s.input)}return t._interceptionFunction.call(this,t.getOriginalInvocator(this),...o)})}getOriginalInvocator(t){return this._fnSwapper.originalValue.bind(t??this._fnSwapper.target)}callOriginalInvocator(...t){return this.getOriginalInvocator()(...t)}runMiddlewares(t){for(const o of this._middlewares){const s=o(...t);if(s){if("output"in s)return s;"input"in s&&(t=s.input)}}return{input:t}}registerMiddleware(t){this._middlewares.push(t)}},hn=class{constructor(t){Ut(this,"_fetchInterceptor"),Ut(this,"_interceptionFilters",new Set),this._fetchInterceptor=new ln(t,"fetch",(o,s,w)=>{for(const g of this._interceptionFilters)if(g.shouldIntercept(s,w))return this.shouldKeepFilter(g,s,w)||this.removeInterceptionFilter(g),g.intercept(s,w);return o(s,w)})}enable(){this._fetchInterceptor.enable()}disable(){this._fetchInterceptor.disable()}addInterceptionFilter(t){this.enable(),this._interceptionFilters.add(t)}removeInterceptionFilter(t){this._interceptionFilters.delete(t)}shouldKeepFilter(t,o,s){return typeof t.shouldKeep=="function"?t.shouldKeep(o,s):typeof t.shouldKeep=="boolean"?t.shouldKeep:!1}};function dn(i){return i=i instanceof URL?i:new URL(i,Ue().location.href),t=>typeof t=="string"?new URL(t,Ue().location.href).pathname===i.pathname:t instanceof URL?t.pathname===i.pathname:new URL(t.url,Ue().location.href).pathname===new URL(i,Ue().location.href).pathname}function pn(i,t,o){const s=new Response(t,o),w=new URL(i,location.toString());return Object.defineProperty(s,"url",{value:w}),s}function yn(i,t){const o=JSON.stringify(t),s=new Headers({"Content-Type":"application/json"});return pn(i,o,{headers:s})}const wn=new hn(Ue());function _n(){const i=yt(),t=new on(i.W.controller.descartesClient,"createAbortController");t.swap(()=>(t.restore(),new AbortController))}function gn(i){const t=yt();return _n(),t.W.controller.descartesClient.getFeatures([0,0,0,0],{[i]:!0},{})}async function vn(i,t){const o=yt().W.Config.paths.features;wn.addInterceptionFilter({shouldIntercept:dn(o),intercept(){return Promise.resolve(yn(o,{[i]:{objects:[t]}}))}});const{[i]:s}=await gn(i),[w]=s.objects;return w.constructor}function bn(i,t,o={}){const s={type:"Feature"};return(o.id===0||o.id)&&(s.id=o.id),o.bbox&&(s.bbox=o.bbox),s.properties={},s.geometry=i,s}function mn(i,t,o={}){if(!i)throw new Error("coordinates is required");if(!Array.isArray(i))throw new Error("coordinates must be an Array");if(i.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!qt(i[0])||!qt(i[1]))throw new Error("coordinates must contain numbers");return bn({type:"Point",coordinates:i},t,o)}function qt(i){return!isNaN(i)&&i!==null&&!Array.isArray(i)}function qe(){return"unsafeWindow"in window?window.unsafeWindow:window}function kn(i){const t=qe().require("Waze/Action/CreateObject");return new t(i)}function On(i){qe().W.model.actionManager.add(kn(i))}function Sn(i){return i.toISOString().slice(0,16).replace("T"," ")}function Mn(i){return qe().W.model.mapComments.getObjectById(i)}function En(i,t){const o=qe().require("Waze/Action/UpdateObject");return new o(i,t)}function jn(i,t){qe().W.model.actionManager.add(En(i,t))}let wt;function Tn(){if(!wt)throw new Error("MapComment not initialized. Make sure to await the enhancedSDK function before using it.")}const In=[{async install(){wt=await vn("mapComments",{geometry:mn([0,0]).geometry})}},new Ht("DataModel.MapComments.addMapComment",i=>{Tn();const t=new wt({geoJSONGeometry:i.geometry,subject:i.subject,body:i.body,lockRank:i.lockRank,endDate:i.endDate?Sn(i.endDate):null});return On(t),t.getID()}),new Ht("DataModel.MapComments.updateMapComment",({sdkInstance:i})=>t=>{const o=Mn(t.mapCommentId);if(!o)throw new i.Errors.DataModelNotFoundError("mapComment",t.mapCommentId);const s={};t.geometry&&(s.geoJSONGeometry=t.geometry),t.subject&&(s.subject=t.subject),t.body&&(s.body=t.body),t.lockRank&&(s.lockRank=t.lockRank),jn(o,s)},{isFactory:!0})];var Pn=Object.defineProperty,Rn=(i,t,o)=>t in i?Pn(i,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):i[t]=o,ot=(i,t,o)=>Rn(i,typeof t!="symbol"?t+"":t,o),Lt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Gt={};/*! *****************************************************************************
  Copyright (C) Microsoft. All rights reserved.
  Licensed under the Apache License, Version 2.0 (the "License"); you may not use
  this file except in compliance with the License. You may obtain a copy of the
  License at http://www.apache.org/licenses/LICENSE-2.0

  THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
  WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
  MERCHANTABLITY OR NON-INFRINGEMENT.

  See the Apache Version 2.0 License for specific language governing permissions
  and limitations under the License.
  ***************************************************************************** */var Bt;function An(){if(Bt)return Gt;Bt=1;var i;return function(t){(function(o){var s=typeof globalThis=="object"?globalThis:typeof Lt=="object"?Lt:typeof self=="object"?self:typeof this=="object"?this:j(),w=g(t);typeof s.Reflect<"u"&&(w=g(s.Reflect,w)),o(w,s),typeof s.Reflect>"u"&&(s.Reflect=t);function g($,I){return function(E,A){Object.defineProperty($,E,{configurable:!0,writable:!0,value:A}),I&&I(E,A)}}function T(){try{return Function("return this;")()}catch{}}function S(){try{return(0,eval)("(function() { return this; })()")}catch{}}function j(){return T()||S()}})(function(o,s){var w=Object.prototype.hasOwnProperty,g=typeof Symbol=="function",T=g&&typeof Symbol.toPrimitive<"u"?Symbol.toPrimitive:"@@toPrimitive",S=g&&typeof Symbol.iterator<"u"?Symbol.iterator:"@@iterator",j=typeof Object.create=="function",$={__proto__:[]}instanceof Array,I=!j&&!$,E={create:j?function(){return q(Object.create(null))}:$?function(){return q({__proto__:null})}:function(){return q({})},has:I?function(e,r){return w.call(e,r)}:function(e,r){return r in e},get:I?function(e,r){return w.call(e,r)?e[r]:void 0}:function(e,r){return e[r]}},A=Object.getPrototypeOf(Function),x=typeof Map=="function"&&typeof Map.prototype.entries=="function"?Map:Ie(),W=typeof Set=="function"&&typeof Set.prototype.entries=="function"?Set:Pe(),K=typeof WeakMap=="function"?WeakMap:Re(),P=g?Symbol.for("@reflect-metadata:registry"):void 0,V=Ee(),J=je(V);function we(e,r,n,a){if(d(n)){if(!ae(e))throw new TypeError;if(!se(r))throw new TypeError;return ge(e,r)}else{if(!ae(e))throw new TypeError;if(!b(r))throw new TypeError;if(!b(a)&&!d(a)&&!R(a))throw new TypeError;return R(a)&&(a=void 0),n=M(n),ve(e,r,n,a)}}o("decorate",we);function F(e,r){function n(a,h){if(!b(a))throw new TypeError;if(!d(h)&&!Se(h))throw new TypeError;te(e,r,a,h)}return n}o("metadata",F);function C(e,r,n,a){if(!b(n))throw new TypeError;return d(a)||(a=M(a)),te(e,r,n,a)}o("defineMetadata",C);function L(e,r,n){if(!b(r))throw new TypeError;return d(n)||(n=M(n)),Q(e,r,n)}o("hasMetadata",L);function G(e,r,n){if(!b(r))throw new TypeError;return d(n)||(n=M(n)),N(e,r,n)}o("hasOwnMetadata",G);function ye(e,r,n){if(!b(r))throw new TypeError;return d(n)||(n=M(n)),X(e,r,n)}o("getMetadata",ye);function Z(e,r,n){if(!b(r))throw new TypeError;return d(n)||(n=M(n)),ee(e,r,n)}o("getOwnMetadata",Z);function Y(e,r){if(!b(e))throw new TypeError;return d(r)||(r=M(r)),re(e,r)}o("getMetadataKeys",Y);function pe(e,r){if(!b(e))throw new TypeError;return d(r)||(r=M(r)),ne(e,r)}o("getOwnMetadataKeys",pe);function _e(e,r,n){if(!b(r))throw new TypeError;if(d(n)||(n=M(n)),!b(r))throw new TypeError;d(n)||(n=M(n));var a=D(r,n,!1);return d(a)?!1:a.OrdinaryDeleteMetadata(e,r,n)}o("deleteMetadata",_e);function ge(e,r){for(var n=e.length-1;n>=0;--n){var a=e[n],h=a(r);if(!d(h)&&!R(h)){if(!se(h))throw new TypeError;r=h}}return r}function ve(e,r,n,a){for(var h=e.length-1;h>=0;--h){var k=e[h],m=k(r,n,a);if(!d(m)&&!R(m)){if(!b(m))throw new TypeError;a=m}}return a}function Q(e,r,n){var a=N(e,r,n);if(a)return!0;var h=U(r);return R(h)?!1:Q(e,h,n)}function N(e,r,n){var a=D(r,n,!1);return d(a)?!1:oe(a.OrdinaryHasOwnMetadata(e,r,n))}function X(e,r,n){var a=N(e,r,n);if(a)return ee(e,r,n);var h=U(r);if(!R(h))return X(e,h,n)}function ee(e,r,n){var a=D(r,n,!1);if(!d(a))return a.OrdinaryGetOwnMetadata(e,r,n)}function te(e,r,n,a){var h=D(n,a,!0);h.OrdinaryDefineOwnMetadata(e,r,n,a)}function re(e,r){var n=ne(e,r),a=U(e);if(a===null)return n;var h=re(a,r);if(h.length<=0)return n;if(n.length<=0)return h;for(var k=new W,m=[],p=0,u=n;p<u.length;p++){var c=u[p],f=k.has(c);f||(k.add(c),m.push(c))}for(var l=0,y=h;l<y.length;l++){var c=y[l],f=k.has(c);f||(k.add(c),m.push(c))}return m}function ne(e,r){var n=D(e,r,!1);return n?n.OrdinaryOwnMetadataKeys(e,r):[]}function ie(e){if(e===null)return 1;switch(typeof e){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return e===null?1:6;default:return 6}}function d(e){return e===void 0}function R(e){return e===null}function be(e){return typeof e=="symbol"}function b(e){return typeof e=="object"?e!==null:typeof e=="function"}function me(e,r){switch(ie(e)){case 0:return e;case 1:return e;case 2:return e;case 3:return e;case 4:return e;case 5:return e}var n="string",a=ue(e,T);if(a!==void 0){var h=a.call(e,n);if(b(h))throw new TypeError;return h}return ke(e)}function ke(e,r){var n,a;{var h=e.toString;if(z(h)){var a=h.call(e);if(!b(a))return a}var n=e.valueOf;if(z(n)){var a=n.call(e);if(!b(a))return a}}throw new TypeError}function oe(e){return!!e}function Oe(e){return""+e}function M(e){var r=me(e);return be(r)?r:Oe(r)}function ae(e){return Array.isArray?Array.isArray(e):e instanceof Object?e instanceof Array:Object.prototype.toString.call(e)==="[object Array]"}function z(e){return typeof e=="function"}function se(e){return typeof e=="function"}function Se(e){switch(ie(e)){case 3:return!0;case 4:return!0;default:return!1}}function H(e,r){return e===r||e!==e&&r!==r}function ue(e,r){var n=e[r];if(n!=null){if(!z(n))throw new TypeError;return n}}function ce(e){var r=ue(e,S);if(!z(r))throw new TypeError;var n=r.call(e);if(!b(n))throw new TypeError;return n}function fe(e){return e.value}function le(e){var r=e.next();return r.done?!1:r}function he(e){var r=e.return;r&&r.call(e)}function U(e){var r=Object.getPrototypeOf(e);if(typeof e!="function"||e===A||r!==A)return r;var n=e.prototype,a=n&&Object.getPrototypeOf(n);if(a==null||a===Object.prototype)return r;var h=a.constructor;return typeof h!="function"||h===e?r:h}function Me(){var e;!d(P)&&typeof s.Reflect<"u"&&!(P in s.Reflect)&&typeof s.Reflect.defineMetadata=="function"&&(e=Te(s.Reflect));var r,n,a,h=new K,k={registerProvider:m,getProvider:u,setProvider:f};return k;function m(l){if(!Object.isExtensible(k))throw new Error("Cannot add provider to a frozen registry.");switch(!0){case e===l:break;case d(r):r=l;break;case r===l:break;case d(n):n=l;break;case n===l:break;default:a===void 0&&(a=new W),a.add(l);break}}function p(l,y){if(!d(r)){if(r.isProviderFor(l,y))return r;if(!d(n)){if(n.isProviderFor(l,y))return r;if(!d(a))for(var _=ce(a);;){var v=le(_);if(!v)return;var O=fe(v);if(O.isProviderFor(l,y))return he(_),O}}}if(!d(e)&&e.isProviderFor(l,y))return e}function u(l,y){var _=h.get(l),v;return d(_)||(v=_.get(y)),d(v)&&(v=p(l,y),d(v)||(d(_)&&(_=new x,h.set(l,_)),_.set(y,v))),v}function c(l){if(d(l))throw new TypeError;return r===l||n===l||!d(a)&&a.has(l)}function f(l,y,_){if(!c(_))throw new Error("Metadata provider not registered.");var v=u(l,y);if(v!==_){if(!d(v))return!1;var O=h.get(l);d(O)&&(O=new x,h.set(l,O)),O.set(y,_)}return!0}}function Ee(){var e;return!d(P)&&b(s.Reflect)&&Object.isExtensible(s.Reflect)&&(e=s.Reflect[P]),d(e)&&(e=Me()),!d(P)&&b(s.Reflect)&&Object.isExtensible(s.Reflect)&&Object.defineProperty(s.Reflect,P,{enumerable:!1,configurable:!1,writable:!1,value:e}),e}function je(e){var r=new K,n={isProviderFor:function(c,f){var l=r.get(c);return d(l)?!1:l.has(f)},OrdinaryDefineOwnMetadata:m,OrdinaryHasOwnMetadata:h,OrdinaryGetOwnMetadata:k,OrdinaryOwnMetadataKeys:p,OrdinaryDeleteMetadata:u};return V.registerProvider(n),n;function a(c,f,l){var y=r.get(c),_=!1;if(d(y)){if(!l)return;y=new x,r.set(c,y),_=!0}var v=y.get(f);if(d(v)){if(!l)return;if(v=new x,y.set(f,v),!e.setProvider(c,f,n))throw y.delete(f),_&&r.delete(c),new Error("Wrong provider for target.")}return v}function h(c,f,l){var y=a(f,l,!1);return d(y)?!1:oe(y.has(c))}function k(c,f,l){var y=a(f,l,!1);if(!d(y))return y.get(c)}function m(c,f,l,y){var _=a(l,y,!0);_.set(c,f)}function p(c,f){var l=[],y=a(c,f,!1);if(d(y))return l;for(var _=y.keys(),v=ce(_),O=0;;){var de=le(v);if(!de)return l.length=O,l;var Ae=fe(de);try{l[O]=Ae}catch(xe){try{he(v)}finally{throw xe}}O++}}function u(c,f,l){var y=a(f,l,!1);if(d(y)||!y.delete(c))return!1;if(y.size===0){var _=r.get(f);d(_)||(_.delete(l),_.size===0&&r.delete(_))}return!0}}function Te(e){var r=e.defineMetadata,n=e.hasOwnMetadata,a=e.getOwnMetadata,h=e.getOwnMetadataKeys,k=e.deleteMetadata,m=new K,p={isProviderFor:function(u,c){var f=m.get(u);return!d(f)&&f.has(c)?!0:h(u,c).length?(d(f)&&(f=new W,m.set(u,f)),f.add(c),!0):!1},OrdinaryDefineOwnMetadata:r,OrdinaryHasOwnMetadata:n,OrdinaryGetOwnMetadata:a,OrdinaryOwnMetadataKeys:h,OrdinaryDeleteMetadata:k};return p}function D(e,r,n){var a=V.getProvider(e,r);if(!d(a))return a;if(n){if(V.setProvider(e,r,J))return J;throw new Error("Illegal state.")}}function Ie(){var e={},r=[],n=function(){function p(u,c,f){this._index=0,this._keys=u,this._values=c,this._selector=f}return p.prototype["@@iterator"]=function(){return this},p.prototype[S]=function(){return this},p.prototype.next=function(){var u=this._index;if(u>=0&&u<this._keys.length){var c=this._selector(this._keys[u],this._values[u]);return u+1>=this._keys.length?(this._index=-1,this._keys=r,this._values=r):this._index++,{value:c,done:!1}}return{value:void 0,done:!0}},p.prototype.throw=function(u){throw this._index>=0&&(this._index=-1,this._keys=r,this._values=r),u},p.prototype.return=function(u){return this._index>=0&&(this._index=-1,this._keys=r,this._values=r),{value:u,done:!0}},p}(),a=function(){function p(){this._keys=[],this._values=[],this._cacheKey=e,this._cacheIndex=-2}return Object.defineProperty(p.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),p.prototype.has=function(u){return this._find(u,!1)>=0},p.prototype.get=function(u){var c=this._find(u,!1);return c>=0?this._values[c]:void 0},p.prototype.set=function(u,c){var f=this._find(u,!0);return this._values[f]=c,this},p.prototype.delete=function(u){var c=this._find(u,!1);if(c>=0){for(var f=this._keys.length,l=c+1;l<f;l++)this._keys[l-1]=this._keys[l],this._values[l-1]=this._values[l];return this._keys.length--,this._values.length--,H(u,this._cacheKey)&&(this._cacheKey=e,this._cacheIndex=-2),!0}return!1},p.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=e,this._cacheIndex=-2},p.prototype.keys=function(){return new n(this._keys,this._values,h)},p.prototype.values=function(){return new n(this._keys,this._values,k)},p.prototype.entries=function(){return new n(this._keys,this._values,m)},p.prototype["@@iterator"]=function(){return this.entries()},p.prototype[S]=function(){return this.entries()},p.prototype._find=function(u,c){if(!H(this._cacheKey,u)){this._cacheIndex=-1;for(var f=0;f<this._keys.length;f++)if(H(this._keys[f],u)){this._cacheIndex=f;break}}return this._cacheIndex<0&&c&&(this._cacheIndex=this._keys.length,this._keys.push(u),this._values.push(void 0)),this._cacheIndex},p}();return a;function h(p,u){return p}function k(p,u){return u}function m(p,u){return[p,u]}}function Pe(){var e=function(){function r(){this._map=new x}return Object.defineProperty(r.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),r.prototype.has=function(n){return this._map.has(n)},r.prototype.add=function(n){return this._map.set(n,n),this},r.prototype.delete=function(n){return this._map.delete(n)},r.prototype.clear=function(){this._map.clear()},r.prototype.keys=function(){return this._map.keys()},r.prototype.values=function(){return this._map.keys()},r.prototype.entries=function(){return this._map.entries()},r.prototype["@@iterator"]=function(){return this.keys()},r.prototype[S]=function(){return this.keys()},r}();return e}function Re(){var e=16,r=E.create(),n=a();return function(){function u(){this._key=a()}return u.prototype.has=function(c){var f=h(c,!1);return f!==void 0?E.has(f,this._key):!1},u.prototype.get=function(c){var f=h(c,!1);return f!==void 0?E.get(f,this._key):void 0},u.prototype.set=function(c,f){var l=h(c,!0);return l[this._key]=f,this},u.prototype.delete=function(c){var f=h(c,!1);return f!==void 0?delete f[this._key]:!1},u.prototype.clear=function(){this._key=a()},u}();function a(){var u;do u="@@WeakMap@@"+p();while(E.has(r,u));return r[u]=!0,u}function h(u,c){if(!w.call(u,n)){if(!c)return;Object.defineProperty(u,n,{value:E.create()})}return u[n]}function k(u,c){for(var f=0;f<c;++f)u[f]=Math.random()*255|0;return u}function m(u){if(typeof Uint8Array=="function"){var c=new Uint8Array(u);return typeof crypto<"u"?crypto.getRandomValues(c):typeof msCrypto<"u"?msCrypto.getRandomValues(c):k(c,u),c}return k(new Array(u),u)}function p(){var u=m(e);u[6]=u[6]&79|64,u[8]=u[8]&191|128;for(var c="",f=0;f<e;++f){var l=u[f];(f===4||f===6||f===8)&&(c+="-"),l<16&&(c+="0"),c+=l.toString(16).toLowerCase()}return c}}function q(e){return e.__=void 0,delete e.__,e}})}(i||(i={})),Gt}An();var xn=Object.defineProperty,$n=(i,t,o)=>t in i?xn(i,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):i[t]=o,Le=(i,t,o)=>$n(i,typeof t!="symbol"?t+"":t,o);let Dn=class{constructor(t,o){Le(this,"_target"),Le(this,"_key"),Le(this,"_oldValue"),Le(this,"_wasDefined",!1),Le(this,"_isSwapped",!1),this._target=t,this._key=o,this._oldValue=this._target[this._key]}get isSwapped(){return this._isSwapped}get originalValue(){return this._oldValue}get value(){return this._target[this._key]}get target(){return this._target}restore(){this.isSwapped&&(this._wasDefined?this._target[this._key]=this._oldValue:delete this._target[this._key],this._isSwapped=!1)}swap(t){this.isSwapped||(this._wasDefined=Object.hasOwn(this._target,this._key),this._oldValue=this._target[this._key]),this._target[this._key]=t,this._isSwapped=!0}};const Fn={onlyIfNotExists:!0,isFactory:!1};class _t{constructor(t,o,s={}){if(ot(this,"_installedInstances",new Map),ot(this,"_path"),ot(this,"_targetValue"),ot(this,"_options"),this._path=t.split("."),this._path.length===0)throw new Error("Path must not be empty");this._targetValue=o,this._options={...Fn,...s}}_getTargetObject(t){let o=t;for(const s of this._path.slice(0,this._path.length-1))o[s]||(o[s]={}),o=o[s];return o}_createSwapper(t){const o=this._getTargetObject(t);return new Dn(o,this._path.at(-1))}install({sdk:t,...o}){if(this._installedInstances.has(t))return;const s=this._createSwapper(t);if(!(s.value&&this._options.onlyIfNotExists)){if(this._options.isFactory&&typeof this._targetValue=="function"){const w=this._targetValue({sdk:t,...o});s.swap(w)}else s.swap(this._targetValue);this._installedInstances.set(t,s)}}uninstall({sdk:t}){const o=this._installedInstances.get(t);o&&(o.restore(),this._installedInstances.delete(t))}}var Vn=Object.defineProperty,Cn=(i,t,o)=>t in i?Vn(i,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):i[t]=o,Ge=(i,t,o)=>Cn(i,typeof t!="symbol"?t+"":t,o);let Jt=class{constructor(i,t){Ge(this,"_target"),Ge(this,"_key"),Ge(this,"_oldValue"),Ge(this,"_wasDefined",!1),Ge(this,"_isSwapped",!1),this._target=i,this._key=t,this._oldValue=this._target[this._key]}get isSwapped(){return this._isSwapped}get originalValue(){return this._oldValue}get value(){return this._target[this._key]}get target(){return this._target}restore(){this.isSwapped&&(this._wasDefined?this._target[this._key]=this._oldValue:delete this._target[this._key],this._isSwapped=!1)}swap(i){this.isSwapped||(this._wasDefined=Object.hasOwn(this._target,this._key),this._oldValue=this._target[this._key]),this._target[this._key]=i,this._isSwapped=!0}};function gt(){return"unsafeWindow"in window?window.unsafeWindow:window}async function zn(i){const t=[],o=new Jt(gt().W.model.actionManager,"add");o.swap(s=>{t.push(s)});try{await i()}finally{o.restore()}return t}function Kn(i){return i.memoizedProps||{}}function Wn(i){return typeof i=="object"&&i!==null&&"memoizedState"in i&&Array.isArray(i.memoizedState)&&i.memoizedState.length===2&&"queue"in i&&i.queue===null&&Array.isArray(i.memoizedState[1])}function Nn(i){return typeof i=="object"&&i!==null&&"memoizedState"in i&&typeof i.memoizedState=="object"&&i.memoizedState!==null&&"current"in i.memoizedState&&"queue"in i&&i.queue===null}function Hn(i){return typeof i=="object"&&i!==null&&"memoizedState"in i&&"queue"in i&&typeof i.queue=="object"&&i.queue!==null&&"dispatch"in i.queue&&typeof i.queue.dispatch=="function"}function Un(i){return Hn(i)?{type:"useState",value:i.memoizedState,dispatch:i.queue.dispatch}:Wn(i)?{type:"useMemo",value:i.memoizedState[0],dependencies:i.memoizedState[1]}:Nn(i)?{type:"useRef",current:i.memoizedState}:null}function qn(i,t){const o=[];let s=i.memoizedState;for(;s;){const w=Un(s);w&&o.push(w),s=s.next}return o}function Ln(i,t,o=1/0){let s=i,w=0;for(;s&&w<o;){const g=s.memoizedState?qn(s):[],T=Kn(s),S={fiber:s,hooks:{all:g,useState:g.filter(j=>j.type==="useState"),useMemo:g.filter(j=>j.type==="useMemo"),useRef:g.filter(j=>j.type==="useRef")},props:T};if(t(S))return S;s=s.return,w++}return null}const Gn="__reactFiber$";function Bn(i){const t=Object.keys(i).find(s=>s.startsWith(Gn));if(!t)throw new Error(`No fiber key found for element: ${i}`);const o=i[t];if(!o)throw new Error(`No fiber found for element: ${i}`);return o}const Jn=i=>new Promise(t=>{const o=gt(),s=new Jt(o.W.map.olMap,"addControl");s.swap(w=>{i==null||i(w),t(w),s.restore()})});function Zn(i){const t=gt(),o=t.W.userscripts.toOLGeometry(i);return new t.OpenLayers.Feature.Vector(o)}async function Yn(i,t){const o=Ln(Bn(i),g=>"onClick"in g.props&&typeof g.props.onClick=="function");if(!o)throw new Error("No fiber found with draw initiator");const{onClick:s}=o.props;//! OpenLayers dependent code below - implementation might change over time
const w=Jn(g=>{g.activate=()=>{}});s(new Event("click")),(await w).events.triggerEvent("featureadded",{feature:Zn(t)})}var Qn=Object.defineProperty,Xn=(i,t,o)=>t in i?Qn(i,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):i[t]=o,Zt=(i,t,o)=>Xn(i,typeof t!="symbol"?t+"":t,o);function ei(){return"unsafeWindow"in window?window.unsafeWindow:window}var ti=Object.defineProperty,ri=(i,t,o)=>t in i?ti(i,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):i[t]=o,Fe=(i,t,o)=>ri(i,typeof t!="symbol"?t+"":t,o);let ni=class{constructor(t,o){Fe(this,"_target"),Fe(this,"_key"),Fe(this,"_oldValue"),Fe(this,"_wasDefined",!1),Fe(this,"_isSwapped",!1),this._target=t,this._key=o,this._oldValue=this._target[this._key]}get isSwapped(){return this._isSwapped}get originalValue(){return this._oldValue}get value(){return this._target[this._key]}get target(){return this._target}restore(){this.isSwapped&&(this._wasDefined?this._target[this._key]=this._oldValue:delete this._target[this._key],this._isSwapped=!1)}swap(t){this.isSwapped||(this._wasDefined=Object.hasOwn(this._target,this._key),this._oldValue=this._target[this._key]),this._target[this._key]=t,this._isSwapped=!0}},ii=class{constructor(t,o,s){Fe(this,"_enabled",!1),Fe(this,"_fnSwapper"),Fe(this,"_interceptionFunction"),Fe(this,"_middlewares",[]),this._fnSwapper=new ni(t,o),this._interceptionFunction=s}get enabled(){return this._fnSwapper.isSwapped&&this._enabled}disable(){this._enabled=!1,this.enabled}restore(){this._fnSwapper.restore()}enable(){this._enabled=!0,this._fnSwapper.isSwapped||this.swapToInterceptor()}swapToInterceptor(){const t=this;this._fnSwapper.swap(function(...o){if(!t._enabled)return t.callOriginalInvocator(...o);const s=t.runMiddlewares(o);if(s){if("output"in s)return s.output;"input"in s&&(o=s.input)}return t._interceptionFunction.call(this,t.getOriginalInvocator(this),...o)})}getOriginalInvocator(t){return this._fnSwapper.originalValue.bind(t??this._fnSwapper.target)}callOriginalInvocator(...t){return this.getOriginalInvocator()(...t)}runMiddlewares(t){for(const o of this._middlewares){const s=o(...t);if(s){if("output"in s)return s;"input"in s&&(t=s.input)}}return{input:t}}registerMiddleware(t){this._middlewares.push(t)}},oi=class{constructor(t){Zt(this,"_fetchInterceptor"),Zt(this,"_interceptionFilters",new Set),this._fetchInterceptor=new ii(t,"fetch",(o,s,w)=>{for(const g of this._interceptionFilters)if(g.shouldIntercept(s,w))return this.shouldKeepFilter(g,s,w)||this.removeInterceptionFilter(g),g.intercept(s,w);return o(s,w)})}enable(){this._fetchInterceptor.enable()}disable(){this._fetchInterceptor.disable()}addInterceptionFilter(t){this.enable(),this._interceptionFilters.add(t)}removeInterceptionFilter(t){this._interceptionFilters.delete(t)}shouldKeepFilter(t,o,s){return typeof t.shouldKeep=="function"?t.shouldKeep(o,s):typeof t.shouldKeep=="boolean"?t.shouldKeep:!1}};new oi(ei());function ai(i,t,o={}){const s={type:"Feature"};return(o.id===0||o.id)&&(s.id=o.id),o.bbox&&(s.bbox=o.bbox),s.properties={},s.geometry=i,s}function si(i,t,o={}){for(const s of i){if(s.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");if(s[s.length-1].length!==s[0].length)throw new Error("First and last Position are not equivalent.");for(let w=0;w<s[s.length-1].length;w++)if(s[s.length-1][w]!==s[0][w])throw new Error("First and last Position are not equivalent.")}return ai({type:"Polygon",coordinates:i},t,o)}function at(){return"unsafeWindow"in window?window.unsafeWindow:window}function ui(i,t,o){const s=new i(o),w=new t(s);return at().W.model.actionManager.add(w),s}function Yt(i){return at().W.model.permanentHazards.getObjectById(i)}function ci(i,t){const o=at().require("Waze/Action/UpdateObject");return new o(i,t)}function fi(i,t){at().W.model.actionManager.add(ci(i,t))}function li(i){return Object.fromEntries(Object.entries(i).filter(([,t])=>t!==void 0))}let vt,bt;const hi=[{async install(){const i=document.querySelector("#drawer wz-menu > wz-menu-sub-menu:nth-child(3) > wz-menu-item:nth-of-type(2)");if(!i||!(i instanceof HTMLElement))throw new Error("Unable to find school zone drawing menu item");const[t]=await zn(async()=>{await Yn(i,si([[[0,0],[0,1],[1,1],[0,0]]]).geometry)});if(t.actionName!=="ADD_PERMANENT_HAZARD")throw new Error("Unexpected action discovered when tried to resolve AddPermanentHazard action: "+t.actionName);const o=t.object;if(!o)throw new Error("Unexpected state: Added object does not exist");if(o.type!=="permanentHazard")throw new Error("Unexpected state: Expected the added object to be a PermanentHazard instead of "+t.type);vt=t.constructor,bt=o.constructor}},new _t("DataModel.PermanentHazards.addSchoolZone",i=>{if(!bt||!vt)throw new Error("PermanentHazard or AddPermanentHazard are not initialized. Make sure to await the enhancedSDK function before using it.");return ui(bt,vt,{type:9,geoJSONGeometry:i.geometry,name:i.name,speedLimit:i.speedLimit,excludedRoadTypes:i.excludedRoadTypes}).getID()}),new _t("DataModel.PermanentHazards.updateSchoolZone",({sdkInstance:i})=>t=>{const o=Yt(t.schoolZoneId);if(!o||o.getAttribute("type")!==9)throw new i.Errors.DataModelNotFoundError("permanentHazard.SchoolZone",t.schoolZoneId);fi(o,li({geoJSONGeometry:t.geometry,name:t.name,speedLimit:t.speedLimit,excludedRoadTypes:t.excludedRoadTypes}))},{isFactory:!0}),new _t("DataModel.PermanentHazards.getSchoolZoneById",()=>i=>{const t=Yt(i.schoolZoneId);return!t||t.getAttribute("type")!==9?null:t},{isFactory:!0})];var di=Object.defineProperty,pi=(i,t,o)=>t in i?di(i,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):i[t]=o,st=(i,t,o)=>pi(i,typeof t!="symbol"?t+"":t,o),Qt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Xt={};/*! *****************************************************************************
  Copyright (C) Microsoft. All rights reserved.
  Licensed under the Apache License, Version 2.0 (the "License"); you may not use
  this file except in compliance with the License. You may obtain a copy of the
  License at http://www.apache.org/licenses/LICENSE-2.0

  THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
  WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
  MERCHANTABLITY OR NON-INFRINGEMENT.

  See the Apache Version 2.0 License for specific language governing permissions
  and limitations under the License.
  ***************************************************************************** */var er;function yi(){if(er)return Xt;er=1;var i;return function(t){(function(o){var s=typeof globalThis=="object"?globalThis:typeof Qt=="object"?Qt:typeof self=="object"?self:typeof this=="object"?this:j(),w=g(t);typeof s.Reflect<"u"&&(w=g(s.Reflect,w)),o(w,s),typeof s.Reflect>"u"&&(s.Reflect=t);function g($,I){return function(E,A){Object.defineProperty($,E,{configurable:!0,writable:!0,value:A}),I&&I(E,A)}}function T(){try{return Function("return this;")()}catch{}}function S(){try{return(0,eval)("(function() { return this; })()")}catch{}}function j(){return T()||S()}})(function(o,s){var w=Object.prototype.hasOwnProperty,g=typeof Symbol=="function",T=g&&typeof Symbol.toPrimitive<"u"?Symbol.toPrimitive:"@@toPrimitive",S=g&&typeof Symbol.iterator<"u"?Symbol.iterator:"@@iterator",j=typeof Object.create=="function",$={__proto__:[]}instanceof Array,I=!j&&!$,E={create:j?function(){return q(Object.create(null))}:$?function(){return q({__proto__:null})}:function(){return q({})},has:I?function(e,r){return w.call(e,r)}:function(e,r){return r in e},get:I?function(e,r){return w.call(e,r)?e[r]:void 0}:function(e,r){return e[r]}},A=Object.getPrototypeOf(Function),x=typeof Map=="function"&&typeof Map.prototype.entries=="function"?Map:Ie(),W=typeof Set=="function"&&typeof Set.prototype.entries=="function"?Set:Pe(),K=typeof WeakMap=="function"?WeakMap:Re(),P=g?Symbol.for("@reflect-metadata:registry"):void 0,V=Ee(),J=je(V);function we(e,r,n,a){if(d(n)){if(!ae(e))throw new TypeError;if(!se(r))throw new TypeError;return ge(e,r)}else{if(!ae(e))throw new TypeError;if(!b(r))throw new TypeError;if(!b(a)&&!d(a)&&!R(a))throw new TypeError;return R(a)&&(a=void 0),n=M(n),ve(e,r,n,a)}}o("decorate",we);function F(e,r){function n(a,h){if(!b(a))throw new TypeError;if(!d(h)&&!Se(h))throw new TypeError;te(e,r,a,h)}return n}o("metadata",F);function C(e,r,n,a){if(!b(n))throw new TypeError;return d(a)||(a=M(a)),te(e,r,n,a)}o("defineMetadata",C);function L(e,r,n){if(!b(r))throw new TypeError;return d(n)||(n=M(n)),Q(e,r,n)}o("hasMetadata",L);function G(e,r,n){if(!b(r))throw new TypeError;return d(n)||(n=M(n)),N(e,r,n)}o("hasOwnMetadata",G);function ye(e,r,n){if(!b(r))throw new TypeError;return d(n)||(n=M(n)),X(e,r,n)}o("getMetadata",ye);function Z(e,r,n){if(!b(r))throw new TypeError;return d(n)||(n=M(n)),ee(e,r,n)}o("getOwnMetadata",Z);function Y(e,r){if(!b(e))throw new TypeError;return d(r)||(r=M(r)),re(e,r)}o("getMetadataKeys",Y);function pe(e,r){if(!b(e))throw new TypeError;return d(r)||(r=M(r)),ne(e,r)}o("getOwnMetadataKeys",pe);function _e(e,r,n){if(!b(r))throw new TypeError;if(d(n)||(n=M(n)),!b(r))throw new TypeError;d(n)||(n=M(n));var a=D(r,n,!1);return d(a)?!1:a.OrdinaryDeleteMetadata(e,r,n)}o("deleteMetadata",_e);function ge(e,r){for(var n=e.length-1;n>=0;--n){var a=e[n],h=a(r);if(!d(h)&&!R(h)){if(!se(h))throw new TypeError;r=h}}return r}function ve(e,r,n,a){for(var h=e.length-1;h>=0;--h){var k=e[h],m=k(r,n,a);if(!d(m)&&!R(m)){if(!b(m))throw new TypeError;a=m}}return a}function Q(e,r,n){var a=N(e,r,n);if(a)return!0;var h=U(r);return R(h)?!1:Q(e,h,n)}function N(e,r,n){var a=D(r,n,!1);return d(a)?!1:oe(a.OrdinaryHasOwnMetadata(e,r,n))}function X(e,r,n){var a=N(e,r,n);if(a)return ee(e,r,n);var h=U(r);if(!R(h))return X(e,h,n)}function ee(e,r,n){var a=D(r,n,!1);if(!d(a))return a.OrdinaryGetOwnMetadata(e,r,n)}function te(e,r,n,a){var h=D(n,a,!0);h.OrdinaryDefineOwnMetadata(e,r,n,a)}function re(e,r){var n=ne(e,r),a=U(e);if(a===null)return n;var h=re(a,r);if(h.length<=0)return n;if(n.length<=0)return h;for(var k=new W,m=[],p=0,u=n;p<u.length;p++){var c=u[p],f=k.has(c);f||(k.add(c),m.push(c))}for(var l=0,y=h;l<y.length;l++){var c=y[l],f=k.has(c);f||(k.add(c),m.push(c))}return m}function ne(e,r){var n=D(e,r,!1);return n?n.OrdinaryOwnMetadataKeys(e,r):[]}function ie(e){if(e===null)return 1;switch(typeof e){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return e===null?1:6;default:return 6}}function d(e){return e===void 0}function R(e){return e===null}function be(e){return typeof e=="symbol"}function b(e){return typeof e=="object"?e!==null:typeof e=="function"}function me(e,r){switch(ie(e)){case 0:return e;case 1:return e;case 2:return e;case 3:return e;case 4:return e;case 5:return e}var n="string",a=ue(e,T);if(a!==void 0){var h=a.call(e,n);if(b(h))throw new TypeError;return h}return ke(e)}function ke(e,r){var n,a;{var h=e.toString;if(z(h)){var a=h.call(e);if(!b(a))return a}var n=e.valueOf;if(z(n)){var a=n.call(e);if(!b(a))return a}}throw new TypeError}function oe(e){return!!e}function Oe(e){return""+e}function M(e){var r=me(e);return be(r)?r:Oe(r)}function ae(e){return Array.isArray?Array.isArray(e):e instanceof Object?e instanceof Array:Object.prototype.toString.call(e)==="[object Array]"}function z(e){return typeof e=="function"}function se(e){return typeof e=="function"}function Se(e){switch(ie(e)){case 3:return!0;case 4:return!0;default:return!1}}function H(e,r){return e===r||e!==e&&r!==r}function ue(e,r){var n=e[r];if(n!=null){if(!z(n))throw new TypeError;return n}}function ce(e){var r=ue(e,S);if(!z(r))throw new TypeError;var n=r.call(e);if(!b(n))throw new TypeError;return n}function fe(e){return e.value}function le(e){var r=e.next();return r.done?!1:r}function he(e){var r=e.return;r&&r.call(e)}function U(e){var r=Object.getPrototypeOf(e);if(typeof e!="function"||e===A||r!==A)return r;var n=e.prototype,a=n&&Object.getPrototypeOf(n);if(a==null||a===Object.prototype)return r;var h=a.constructor;return typeof h!="function"||h===e?r:h}function Me(){var e;!d(P)&&typeof s.Reflect<"u"&&!(P in s.Reflect)&&typeof s.Reflect.defineMetadata=="function"&&(e=Te(s.Reflect));var r,n,a,h=new K,k={registerProvider:m,getProvider:u,setProvider:f};return k;function m(l){if(!Object.isExtensible(k))throw new Error("Cannot add provider to a frozen registry.");switch(!0){case e===l:break;case d(r):r=l;break;case r===l:break;case d(n):n=l;break;case n===l:break;default:a===void 0&&(a=new W),a.add(l);break}}function p(l,y){if(!d(r)){if(r.isProviderFor(l,y))return r;if(!d(n)){if(n.isProviderFor(l,y))return r;if(!d(a))for(var _=ce(a);;){var v=le(_);if(!v)return;var O=fe(v);if(O.isProviderFor(l,y))return he(_),O}}}if(!d(e)&&e.isProviderFor(l,y))return e}function u(l,y){var _=h.get(l),v;return d(_)||(v=_.get(y)),d(v)&&(v=p(l,y),d(v)||(d(_)&&(_=new x,h.set(l,_)),_.set(y,v))),v}function c(l){if(d(l))throw new TypeError;return r===l||n===l||!d(a)&&a.has(l)}function f(l,y,_){if(!c(_))throw new Error("Metadata provider not registered.");var v=u(l,y);if(v!==_){if(!d(v))return!1;var O=h.get(l);d(O)&&(O=new x,h.set(l,O)),O.set(y,_)}return!0}}function Ee(){var e;return!d(P)&&b(s.Reflect)&&Object.isExtensible(s.Reflect)&&(e=s.Reflect[P]),d(e)&&(e=Me()),!d(P)&&b(s.Reflect)&&Object.isExtensible(s.Reflect)&&Object.defineProperty(s.Reflect,P,{enumerable:!1,configurable:!1,writable:!1,value:e}),e}function je(e){var r=new K,n={isProviderFor:function(c,f){var l=r.get(c);return d(l)?!1:l.has(f)},OrdinaryDefineOwnMetadata:m,OrdinaryHasOwnMetadata:h,OrdinaryGetOwnMetadata:k,OrdinaryOwnMetadataKeys:p,OrdinaryDeleteMetadata:u};return V.registerProvider(n),n;function a(c,f,l){var y=r.get(c),_=!1;if(d(y)){if(!l)return;y=new x,r.set(c,y),_=!0}var v=y.get(f);if(d(v)){if(!l)return;if(v=new x,y.set(f,v),!e.setProvider(c,f,n))throw y.delete(f),_&&r.delete(c),new Error("Wrong provider for target.")}return v}function h(c,f,l){var y=a(f,l,!1);return d(y)?!1:oe(y.has(c))}function k(c,f,l){var y=a(f,l,!1);if(!d(y))return y.get(c)}function m(c,f,l,y){var _=a(l,y,!0);_.set(c,f)}function p(c,f){var l=[],y=a(c,f,!1);if(d(y))return l;for(var _=y.keys(),v=ce(_),O=0;;){var de=le(v);if(!de)return l.length=O,l;var Ae=fe(de);try{l[O]=Ae}catch(xe){try{he(v)}finally{throw xe}}O++}}function u(c,f,l){var y=a(f,l,!1);if(d(y)||!y.delete(c))return!1;if(y.size===0){var _=r.get(f);d(_)||(_.delete(l),_.size===0&&r.delete(_))}return!0}}function Te(e){var r=e.defineMetadata,n=e.hasOwnMetadata,a=e.getOwnMetadata,h=e.getOwnMetadataKeys,k=e.deleteMetadata,m=new K,p={isProviderFor:function(u,c){var f=m.get(u);return!d(f)&&f.has(c)?!0:h(u,c).length?(d(f)&&(f=new W,m.set(u,f)),f.add(c),!0):!1},OrdinaryDefineOwnMetadata:r,OrdinaryHasOwnMetadata:n,OrdinaryGetOwnMetadata:a,OrdinaryOwnMetadataKeys:h,OrdinaryDeleteMetadata:k};return p}function D(e,r,n){var a=V.getProvider(e,r);if(!d(a))return a;if(n){if(V.setProvider(e,r,J))return J;throw new Error("Illegal state.")}}function Ie(){var e={},r=[],n=function(){function p(u,c,f){this._index=0,this._keys=u,this._values=c,this._selector=f}return p.prototype["@@iterator"]=function(){return this},p.prototype[S]=function(){return this},p.prototype.next=function(){var u=this._index;if(u>=0&&u<this._keys.length){var c=this._selector(this._keys[u],this._values[u]);return u+1>=this._keys.length?(this._index=-1,this._keys=r,this._values=r):this._index++,{value:c,done:!1}}return{value:void 0,done:!0}},p.prototype.throw=function(u){throw this._index>=0&&(this._index=-1,this._keys=r,this._values=r),u},p.prototype.return=function(u){return this._index>=0&&(this._index=-1,this._keys=r,this._values=r),{value:u,done:!0}},p}(),a=function(){function p(){this._keys=[],this._values=[],this._cacheKey=e,this._cacheIndex=-2}return Object.defineProperty(p.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),p.prototype.has=function(u){return this._find(u,!1)>=0},p.prototype.get=function(u){var c=this._find(u,!1);return c>=0?this._values[c]:void 0},p.prototype.set=function(u,c){var f=this._find(u,!0);return this._values[f]=c,this},p.prototype.delete=function(u){var c=this._find(u,!1);if(c>=0){for(var f=this._keys.length,l=c+1;l<f;l++)this._keys[l-1]=this._keys[l],this._values[l-1]=this._values[l];return this._keys.length--,this._values.length--,H(u,this._cacheKey)&&(this._cacheKey=e,this._cacheIndex=-2),!0}return!1},p.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=e,this._cacheIndex=-2},p.prototype.keys=function(){return new n(this._keys,this._values,h)},p.prototype.values=function(){return new n(this._keys,this._values,k)},p.prototype.entries=function(){return new n(this._keys,this._values,m)},p.prototype["@@iterator"]=function(){return this.entries()},p.prototype[S]=function(){return this.entries()},p.prototype._find=function(u,c){if(!H(this._cacheKey,u)){this._cacheIndex=-1;for(var f=0;f<this._keys.length;f++)if(H(this._keys[f],u)){this._cacheIndex=f;break}}return this._cacheIndex<0&&c&&(this._cacheIndex=this._keys.length,this._keys.push(u),this._values.push(void 0)),this._cacheIndex},p}();return a;function h(p,u){return p}function k(p,u){return u}function m(p,u){return[p,u]}}function Pe(){var e=function(){function r(){this._map=new x}return Object.defineProperty(r.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),r.prototype.has=function(n){return this._map.has(n)},r.prototype.add=function(n){return this._map.set(n,n),this},r.prototype.delete=function(n){return this._map.delete(n)},r.prototype.clear=function(){this._map.clear()},r.prototype.keys=function(){return this._map.keys()},r.prototype.values=function(){return this._map.keys()},r.prototype.entries=function(){return this._map.entries()},r.prototype["@@iterator"]=function(){return this.keys()},r.prototype[S]=function(){return this.keys()},r}();return e}function Re(){var e=16,r=E.create(),n=a();return function(){function u(){this._key=a()}return u.prototype.has=function(c){var f=h(c,!1);return f!==void 0?E.has(f,this._key):!1},u.prototype.get=function(c){var f=h(c,!1);return f!==void 0?E.get(f,this._key):void 0},u.prototype.set=function(c,f){var l=h(c,!0);return l[this._key]=f,this},u.prototype.delete=function(c){var f=h(c,!1);return f!==void 0?delete f[this._key]:!1},u.prototype.clear=function(){this._key=a()},u}();function a(){var u;do u="@@WeakMap@@"+p();while(E.has(r,u));return r[u]=!0,u}function h(u,c){if(!w.call(u,n)){if(!c)return;Object.defineProperty(u,n,{value:E.create()})}return u[n]}function k(u,c){for(var f=0;f<c;++f)u[f]=Math.random()*255|0;return u}function m(u){if(typeof Uint8Array=="function"){var c=new Uint8Array(u);return typeof crypto<"u"?crypto.getRandomValues(c):typeof msCrypto<"u"?msCrypto.getRandomValues(c):k(c,u),c}return k(new Array(u),u)}function p(){var u=m(e);u[6]=u[6]&79|64,u[8]=u[8]&191|128;for(var c="",f=0;f<e;++f){var l=u[f];(f===4||f===6||f===8)&&(c+="-"),l<16&&(c+="0"),c+=l.toString(16).toLowerCase()}return c}}function q(e){return e.__=void 0,delete e.__,e}})}(i||(i={})),Xt}yi();var wi=Object.defineProperty,_i=(i,t,o)=>t in i?wi(i,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):i[t]=o,Be=(i,t,o)=>_i(i,typeof t!="symbol"?t+"":t,o);let gi=class{constructor(t,o){Be(this,"_target"),Be(this,"_key"),Be(this,"_oldValue"),Be(this,"_wasDefined",!1),Be(this,"_isSwapped",!1),this._target=t,this._key=o,this._oldValue=this._target[this._key]}get isSwapped(){return this._isSwapped}get originalValue(){return this._oldValue}get value(){return this._target[this._key]}get target(){return this._target}restore(){this.isSwapped&&(this._wasDefined?this._target[this._key]=this._oldValue:delete this._target[this._key],this._isSwapped=!1)}swap(t){this.isSwapped||(this._wasDefined=Object.hasOwn(this._target,this._key),this._oldValue=this._target[this._key]),this._target[this._key]=t,this._isSwapped=!0}};const vi={onlyIfNotExists:!0,isFactory:!1};let bi=class{constructor(t,o,s={}){if(st(this,"_installedInstances",new Map),st(this,"_path"),st(this,"_targetValue"),st(this,"_options"),this._path=t.split("."),this._path.length===0)throw new Error("Path must not be empty");this._targetValue=o,this._options={...vi,...s}}_getTargetObject(t){let o=t;for(const s of this._path.slice(0,this._path.length-1))o[s]||(o[s]={}),o=o[s];return o}_createSwapper(t){const o=this._getTargetObject(t);return new gi(o,this._path.at(-1))}install({sdk:t,...o}){if(this._installedInstances.has(t))return;const s=this._createSwapper(t);if(!(s.value&&this._options.onlyIfNotExists)){if(this._options.isFactory&&typeof this._targetValue=="function"){const w=this._targetValue({sdk:t,...o});s.swap(w)}else s.swap(this._targetValue);this._installedInstances.set(t,s)}}uninstall({sdk:t}){const o=this._installedInstances.get(t);o&&(o.restore(),this._installedInstances.delete(t))}};const tr=Symbol("BigJunction"),rr=Symbol("AddBigJunction");function mi(){return"unsafeWindow"in window?window.unsafeWindow:window}function ki(i,t,o){const s=new i(o),w=new t(s);return mi().W.model.actionManager.add(w),s}const Oi=[new bi("DataModel.BigJunctions.addBigJunction",({artifacts:i})=>t=>ki(i[tr],i[rr],{geoJSONGeometry:t.geometry}).getID(),{isFactory:!0})];function Si(i,t,o={}){const s={type:"Feature"};return(o.id===0||o.id)&&(s.id=o.id),o.bbox&&(s.bbox=o.bbox),s.properties={},s.geometry=i,s}function Mi(i,t,o={}){for(const s of i){if(s.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");if(s[s.length-1].length!==s[0].length)throw new Error("First and last Position are not equivalent.");for(let w=0;w<s[s.length-1].length;w++)if(s[s.length-1][w]!==s[0][w])throw new Error("First and last Position are not equivalent.")}return Si({type:"Polygon",coordinates:i},t,o)}var Ei=Object.defineProperty,ji=(i,t,o)=>t in i?Ei(i,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):i[t]=o,Je=(i,t,o)=>ji(i,typeof t!="symbol"?t+"":t,o);let nr=class{constructor(t,o){Je(this,"_target"),Je(this,"_key"),Je(this,"_oldValue"),Je(this,"_wasDefined",!1),Je(this,"_isSwapped",!1),this._target=t,this._key=o,this._oldValue=this._target[this._key]}get isSwapped(){return this._isSwapped}get originalValue(){return this._oldValue}get value(){return this._target[this._key]}get target(){return this._target}restore(){this.isSwapped&&(this._wasDefined?this._target[this._key]=this._oldValue:delete this._target[this._key],this._isSwapped=!1)}swap(t){this.isSwapped||(this._wasDefined=Object.hasOwn(this._target,this._key),this._oldValue=this._target[this._key]),this._target[this._key]=t,this._isSwapped=!0}};function mt(){return"unsafeWindow"in window?window.unsafeWindow:window}async function Ti(i){const t=[],o=new nr(mt().W.model.actionManager,"add");o.swap(s=>{t.push(s)});try{await i()}finally{o.restore()}return t}function Ii(i){return i.memoizedProps||{}}function Pi(i){return typeof i=="object"&&i!==null&&"memoizedState"in i&&Array.isArray(i.memoizedState)&&i.memoizedState.length===2&&"queue"in i&&i.queue===null&&Array.isArray(i.memoizedState[1])}function Ri(i){return typeof i=="object"&&i!==null&&"memoizedState"in i&&typeof i.memoizedState=="object"&&i.memoizedState!==null&&"current"in i.memoizedState&&"queue"in i&&i.queue===null}function Ai(i){return typeof i=="object"&&i!==null&&"memoizedState"in i&&"queue"in i&&typeof i.queue=="object"&&i.queue!==null&&"dispatch"in i.queue&&typeof i.queue.dispatch=="function"}function xi(i){return Ai(i)?{type:"useState",value:i.memoizedState,dispatch:i.queue.dispatch}:Pi(i)?{type:"useMemo",value:i.memoizedState[0],dependencies:i.memoizedState[1]}:Ri(i)?{type:"useRef",current:i.memoizedState}:null}function $i(i,t){const o=[];let s=i.memoizedState;for(;s;){const w=xi(s);w&&o.push(w),s=s.next}return o}function Di(i,t,o=1/0){let s=i,w=0;for(;s&&w<o;){const g=s.memoizedState?$i(s):[],T=Ii(s),S={fiber:s,hooks:{all:g,useState:g.filter(j=>j.type==="useState"),useMemo:g.filter(j=>j.type==="useMemo"),useRef:g.filter(j=>j.type==="useRef")},props:T};if(t(S))return S;s=s.return,w++}return null}const Fi="__reactFiber$";function Vi(i){const t=Object.keys(i).find(s=>s.startsWith(Fi));if(!t)throw new Error(`No fiber key found for element: ${i}`);const o=i[t];if(!o)throw new Error(`No fiber found for element: ${i}`);return o}const Ci=i=>new Promise(t=>{const o=mt(),s=new nr(o.W.map.olMap,"addControl");s.swap(w=>{i==null||i(w),t(w),s.restore()})});function zi(i){const t=mt(),o=t.W.userscripts.toOLGeometry(i);return new t.OpenLayers.Feature.Vector(o)}async function Ki(i,t){const o=Di(Vi(i),g=>"onClick"in g.props&&typeof g.props.onClick=="function");if(!o)throw new Error("No fiber found with draw initiator");const{onClick:s}=o.props;//! OpenLayers dependent code below - implementation might change over time
const w=Ci(g=>{g.activate=()=>{}});s(new Event("click")),(await w).events.triggerEvent("featureadded",{feature:zi(t)})}var Wi=Object.defineProperty,Ni=(i,t,o)=>t in i?Wi(i,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):i[t]=o,ir=(i,t,o)=>Ni(i,typeof t!="symbol"?t+"":t,o);function Hi(){return"unsafeWindow"in window?window.unsafeWindow:window}var Ui=Object.defineProperty,qi=(i,t,o)=>t in i?Ui(i,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):i[t]=o,Ve=(i,t,o)=>qi(i,typeof t!="symbol"?t+"":t,o);let Li=class{constructor(t,o){Ve(this,"_target"),Ve(this,"_key"),Ve(this,"_oldValue"),Ve(this,"_wasDefined",!1),Ve(this,"_isSwapped",!1),this._target=t,this._key=o,this._oldValue=this._target[this._key]}get isSwapped(){return this._isSwapped}get originalValue(){return this._oldValue}get value(){return this._target[this._key]}get target(){return this._target}restore(){this.isSwapped&&(this._wasDefined?this._target[this._key]=this._oldValue:delete this._target[this._key],this._isSwapped=!1)}swap(t){this.isSwapped||(this._wasDefined=Object.hasOwn(this._target,this._key),this._oldValue=this._target[this._key]),this._target[this._key]=t,this._isSwapped=!0}},Gi=class{constructor(t,o,s){Ve(this,"_enabled",!1),Ve(this,"_fnSwapper"),Ve(this,"_interceptionFunction"),Ve(this,"_middlewares",[]),this._fnSwapper=new Li(t,o),this._interceptionFunction=s}get enabled(){return this._fnSwapper.isSwapped&&this._enabled}disable(){this._enabled=!1,this.enabled}restore(){this._fnSwapper.restore()}enable(){this._enabled=!0,this._fnSwapper.isSwapped||this.swapToInterceptor()}swapToInterceptor(){const t=this;this._fnSwapper.swap(function(...o){if(!t._enabled)return t.callOriginalInvocator(...o);const s=t.runMiddlewares(o);if(s){if("output"in s)return s.output;"input"in s&&(o=s.input)}return t._interceptionFunction.call(this,t.getOriginalInvocator(this),...o)})}getOriginalInvocator(t){return this._fnSwapper.originalValue.bind(t??this._fnSwapper.target)}callOriginalInvocator(...t){return this.getOriginalInvocator()(...t)}runMiddlewares(t){for(const o of this._middlewares){const s=o(...t);if(s){if("output"in s)return s;"input"in s&&(t=s.input)}}return{input:t}}registerMiddleware(t){this._middlewares.push(t)}},Bi=class{constructor(t){ir(this,"_fetchInterceptor"),ir(this,"_interceptionFilters",new Set),this._fetchInterceptor=new Gi(t,"fetch",(o,s,w)=>{for(const g of this._interceptionFilters)if(g.shouldIntercept(s,w))return this.shouldKeepFilter(g,s,w)||this.removeInterceptionFilter(g),g.intercept(s,w);return o(s,w)})}enable(){this._fetchInterceptor.enable()}disable(){this._fetchInterceptor.disable()}addInterceptionFilter(t){this.enable(),this._interceptionFilters.add(t)}removeInterceptionFilter(t){this._interceptionFilters.delete(t)}shouldKeepFilter(t,o,s){return typeof t.shouldKeep=="function"?t.shouldKeep(o,s):typeof t.shouldKeep=="boolean"?t.shouldKeep:!1}};new Bi(Hi());const Ji=[{async install(){const i=document.querySelector("#drawer wz-menu > wz-menu-sub-menu:nth-child(1) > wz-menu-item:nth-of-type(4)");if(!i||!(i instanceof HTMLElement))throw new Error("Unable to find school zone drawing menu item");const[t]=await Ti(async()=>{await Ki(i,Mi([[[0,0],[0,1],[1,1],[0,0]]]).geometry)});if(t.actionName!=="ADD_BIG_JUNCTION")throw new Error("Unexpected action discovered when tried to resolve AddBigJunction action: "+t.actionName);const o=t.bigJunction;if(!o)throw new Error("Unexpected state: Added object does not exist");if(o.type!=="bigJunction")throw new Error("Unexpected state: Expected the added object to be a BigJunction instead of "+t.type);return{[tr]:o.constructor,[rr]:t.constructor}}}],Zi=[...Ji,...Oi];var Yi=Object.defineProperty,Qi=(i,t,o)=>t in i?Yi(i,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):i[t]=o,B=(i,t,o)=>Qi(i,typeof t!="symbol"?t+"":t,o),Xi=Object.defineProperty,eo=(i,t,o)=>t in i?Xi(i,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):i[t]=o,ut=(i,t,o)=>eo(i,typeof t!="symbol"?t+"":t,o),or=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},ar={};/*! *****************************************************************************
  Copyright (C) Microsoft. All rights reserved.
  Licensed under the Apache License, Version 2.0 (the "License"); you may not use
  this file except in compliance with the License. You may obtain a copy of the
  License at http://www.apache.org/licenses/LICENSE-2.0

  THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
  WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
  MERCHANTABLITY OR NON-INFRINGEMENT.

  See the Apache Version 2.0 License for specific language governing permissions
  and limitations under the License.
  ***************************************************************************** */var sr;function to(){if(sr)return ar;sr=1;var i;return function(t){(function(o){var s=typeof globalThis=="object"?globalThis:typeof or=="object"?or:typeof self=="object"?self:typeof this=="object"?this:j(),w=g(t);typeof s.Reflect<"u"&&(w=g(s.Reflect,w)),o(w,s),typeof s.Reflect>"u"&&(s.Reflect=t);function g($,I){return function(E,A){Object.defineProperty($,E,{configurable:!0,writable:!0,value:A}),I&&I(E,A)}}function T(){try{return Function("return this;")()}catch{}}function S(){try{return(0,eval)("(function() { return this; })()")}catch{}}function j(){return T()||S()}})(function(o,s){var w=Object.prototype.hasOwnProperty,g=typeof Symbol=="function",T=g&&typeof Symbol.toPrimitive<"u"?Symbol.toPrimitive:"@@toPrimitive",S=g&&typeof Symbol.iterator<"u"?Symbol.iterator:"@@iterator",j=typeof Object.create=="function",$={__proto__:[]}instanceof Array,I=!j&&!$,E={create:j?function(){return q(Object.create(null))}:$?function(){return q({__proto__:null})}:function(){return q({})},has:I?function(e,r){return w.call(e,r)}:function(e,r){return r in e},get:I?function(e,r){return w.call(e,r)?e[r]:void 0}:function(e,r){return e[r]}},A=Object.getPrototypeOf(Function),x=typeof Map=="function"&&typeof Map.prototype.entries=="function"?Map:Ie(),W=typeof Set=="function"&&typeof Set.prototype.entries=="function"?Set:Pe(),K=typeof WeakMap=="function"?WeakMap:Re(),P=g?Symbol.for("@reflect-metadata:registry"):void 0,V=Ee(),J=je(V);function we(e,r,n,a){if(d(n)){if(!ae(e))throw new TypeError;if(!se(r))throw new TypeError;return ge(e,r)}else{if(!ae(e))throw new TypeError;if(!b(r))throw new TypeError;if(!b(a)&&!d(a)&&!R(a))throw new TypeError;return R(a)&&(a=void 0),n=M(n),ve(e,r,n,a)}}o("decorate",we);function F(e,r){function n(a,h){if(!b(a))throw new TypeError;if(!d(h)&&!Se(h))throw new TypeError;te(e,r,a,h)}return n}o("metadata",F);function C(e,r,n,a){if(!b(n))throw new TypeError;return d(a)||(a=M(a)),te(e,r,n,a)}o("defineMetadata",C);function L(e,r,n){if(!b(r))throw new TypeError;return d(n)||(n=M(n)),Q(e,r,n)}o("hasMetadata",L);function G(e,r,n){if(!b(r))throw new TypeError;return d(n)||(n=M(n)),N(e,r,n)}o("hasOwnMetadata",G);function ye(e,r,n){if(!b(r))throw new TypeError;return d(n)||(n=M(n)),X(e,r,n)}o("getMetadata",ye);function Z(e,r,n){if(!b(r))throw new TypeError;return d(n)||(n=M(n)),ee(e,r,n)}o("getOwnMetadata",Z);function Y(e,r){if(!b(e))throw new TypeError;return d(r)||(r=M(r)),re(e,r)}o("getMetadataKeys",Y);function pe(e,r){if(!b(e))throw new TypeError;return d(r)||(r=M(r)),ne(e,r)}o("getOwnMetadataKeys",pe);function _e(e,r,n){if(!b(r))throw new TypeError;if(d(n)||(n=M(n)),!b(r))throw new TypeError;d(n)||(n=M(n));var a=D(r,n,!1);return d(a)?!1:a.OrdinaryDeleteMetadata(e,r,n)}o("deleteMetadata",_e);function ge(e,r){for(var n=e.length-1;n>=0;--n){var a=e[n],h=a(r);if(!d(h)&&!R(h)){if(!se(h))throw new TypeError;r=h}}return r}function ve(e,r,n,a){for(var h=e.length-1;h>=0;--h){var k=e[h],m=k(r,n,a);if(!d(m)&&!R(m)){if(!b(m))throw new TypeError;a=m}}return a}function Q(e,r,n){var a=N(e,r,n);if(a)return!0;var h=U(r);return R(h)?!1:Q(e,h,n)}function N(e,r,n){var a=D(r,n,!1);return d(a)?!1:oe(a.OrdinaryHasOwnMetadata(e,r,n))}function X(e,r,n){var a=N(e,r,n);if(a)return ee(e,r,n);var h=U(r);if(!R(h))return X(e,h,n)}function ee(e,r,n){var a=D(r,n,!1);if(!d(a))return a.OrdinaryGetOwnMetadata(e,r,n)}function te(e,r,n,a){var h=D(n,a,!0);h.OrdinaryDefineOwnMetadata(e,r,n,a)}function re(e,r){var n=ne(e,r),a=U(e);if(a===null)return n;var h=re(a,r);if(h.length<=0)return n;if(n.length<=0)return h;for(var k=new W,m=[],p=0,u=n;p<u.length;p++){var c=u[p],f=k.has(c);f||(k.add(c),m.push(c))}for(var l=0,y=h;l<y.length;l++){var c=y[l],f=k.has(c);f||(k.add(c),m.push(c))}return m}function ne(e,r){var n=D(e,r,!1);return n?n.OrdinaryOwnMetadataKeys(e,r):[]}function ie(e){if(e===null)return 1;switch(typeof e){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return e===null?1:6;default:return 6}}function d(e){return e===void 0}function R(e){return e===null}function be(e){return typeof e=="symbol"}function b(e){return typeof e=="object"?e!==null:typeof e=="function"}function me(e,r){switch(ie(e)){case 0:return e;case 1:return e;case 2:return e;case 3:return e;case 4:return e;case 5:return e}var n="string",a=ue(e,T);if(a!==void 0){var h=a.call(e,n);if(b(h))throw new TypeError;return h}return ke(e)}function ke(e,r){var n,a;{var h=e.toString;if(z(h)){var a=h.call(e);if(!b(a))return a}var n=e.valueOf;if(z(n)){var a=n.call(e);if(!b(a))return a}}throw new TypeError}function oe(e){return!!e}function Oe(e){return""+e}function M(e){var r=me(e);return be(r)?r:Oe(r)}function ae(e){return Array.isArray?Array.isArray(e):e instanceof Object?e instanceof Array:Object.prototype.toString.call(e)==="[object Array]"}function z(e){return typeof e=="function"}function se(e){return typeof e=="function"}function Se(e){switch(ie(e)){case 3:return!0;case 4:return!0;default:return!1}}function H(e,r){return e===r||e!==e&&r!==r}function ue(e,r){var n=e[r];if(n!=null){if(!z(n))throw new TypeError;return n}}function ce(e){var r=ue(e,S);if(!z(r))throw new TypeError;var n=r.call(e);if(!b(n))throw new TypeError;return n}function fe(e){return e.value}function le(e){var r=e.next();return r.done?!1:r}function he(e){var r=e.return;r&&r.call(e)}function U(e){var r=Object.getPrototypeOf(e);if(typeof e!="function"||e===A||r!==A)return r;var n=e.prototype,a=n&&Object.getPrototypeOf(n);if(a==null||a===Object.prototype)return r;var h=a.constructor;return typeof h!="function"||h===e?r:h}function Me(){var e;!d(P)&&typeof s.Reflect<"u"&&!(P in s.Reflect)&&typeof s.Reflect.defineMetadata=="function"&&(e=Te(s.Reflect));var r,n,a,h=new K,k={registerProvider:m,getProvider:u,setProvider:f};return k;function m(l){if(!Object.isExtensible(k))throw new Error("Cannot add provider to a frozen registry.");switch(!0){case e===l:break;case d(r):r=l;break;case r===l:break;case d(n):n=l;break;case n===l:break;default:a===void 0&&(a=new W),a.add(l);break}}function p(l,y){if(!d(r)){if(r.isProviderFor(l,y))return r;if(!d(n)){if(n.isProviderFor(l,y))return r;if(!d(a))for(var _=ce(a);;){var v=le(_);if(!v)return;var O=fe(v);if(O.isProviderFor(l,y))return he(_),O}}}if(!d(e)&&e.isProviderFor(l,y))return e}function u(l,y){var _=h.get(l),v;return d(_)||(v=_.get(y)),d(v)&&(v=p(l,y),d(v)||(d(_)&&(_=new x,h.set(l,_)),_.set(y,v))),v}function c(l){if(d(l))throw new TypeError;return r===l||n===l||!d(a)&&a.has(l)}function f(l,y,_){if(!c(_))throw new Error("Metadata provider not registered.");var v=u(l,y);if(v!==_){if(!d(v))return!1;var O=h.get(l);d(O)&&(O=new x,h.set(l,O)),O.set(y,_)}return!0}}function Ee(){var e;return!d(P)&&b(s.Reflect)&&Object.isExtensible(s.Reflect)&&(e=s.Reflect[P]),d(e)&&(e=Me()),!d(P)&&b(s.Reflect)&&Object.isExtensible(s.Reflect)&&Object.defineProperty(s.Reflect,P,{enumerable:!1,configurable:!1,writable:!1,value:e}),e}function je(e){var r=new K,n={isProviderFor:function(c,f){var l=r.get(c);return d(l)?!1:l.has(f)},OrdinaryDefineOwnMetadata:m,OrdinaryHasOwnMetadata:h,OrdinaryGetOwnMetadata:k,OrdinaryOwnMetadataKeys:p,OrdinaryDeleteMetadata:u};return V.registerProvider(n),n;function a(c,f,l){var y=r.get(c),_=!1;if(d(y)){if(!l)return;y=new x,r.set(c,y),_=!0}var v=y.get(f);if(d(v)){if(!l)return;if(v=new x,y.set(f,v),!e.setProvider(c,f,n))throw y.delete(f),_&&r.delete(c),new Error("Wrong provider for target.")}return v}function h(c,f,l){var y=a(f,l,!1);return d(y)?!1:oe(y.has(c))}function k(c,f,l){var y=a(f,l,!1);if(!d(y))return y.get(c)}function m(c,f,l,y){var _=a(l,y,!0);_.set(c,f)}function p(c,f){var l=[],y=a(c,f,!1);if(d(y))return l;for(var _=y.keys(),v=ce(_),O=0;;){var de=le(v);if(!de)return l.length=O,l;var Ae=fe(de);try{l[O]=Ae}catch(xe){try{he(v)}finally{throw xe}}O++}}function u(c,f,l){var y=a(f,l,!1);if(d(y)||!y.delete(c))return!1;if(y.size===0){var _=r.get(f);d(_)||(_.delete(l),_.size===0&&r.delete(_))}return!0}}function Te(e){var r=e.defineMetadata,n=e.hasOwnMetadata,a=e.getOwnMetadata,h=e.getOwnMetadataKeys,k=e.deleteMetadata,m=new K,p={isProviderFor:function(u,c){var f=m.get(u);return!d(f)&&f.has(c)?!0:h(u,c).length?(d(f)&&(f=new W,m.set(u,f)),f.add(c),!0):!1},OrdinaryDefineOwnMetadata:r,OrdinaryHasOwnMetadata:n,OrdinaryGetOwnMetadata:a,OrdinaryOwnMetadataKeys:h,OrdinaryDeleteMetadata:k};return p}function D(e,r,n){var a=V.getProvider(e,r);if(!d(a))return a;if(n){if(V.setProvider(e,r,J))return J;throw new Error("Illegal state.")}}function Ie(){var e={},r=[],n=function(){function p(u,c,f){this._index=0,this._keys=u,this._values=c,this._selector=f}return p.prototype["@@iterator"]=function(){return this},p.prototype[S]=function(){return this},p.prototype.next=function(){var u=this._index;if(u>=0&&u<this._keys.length){var c=this._selector(this._keys[u],this._values[u]);return u+1>=this._keys.length?(this._index=-1,this._keys=r,this._values=r):this._index++,{value:c,done:!1}}return{value:void 0,done:!0}},p.prototype.throw=function(u){throw this._index>=0&&(this._index=-1,this._keys=r,this._values=r),u},p.prototype.return=function(u){return this._index>=0&&(this._index=-1,this._keys=r,this._values=r),{value:u,done:!0}},p}(),a=function(){function p(){this._keys=[],this._values=[],this._cacheKey=e,this._cacheIndex=-2}return Object.defineProperty(p.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),p.prototype.has=function(u){return this._find(u,!1)>=0},p.prototype.get=function(u){var c=this._find(u,!1);return c>=0?this._values[c]:void 0},p.prototype.set=function(u,c){var f=this._find(u,!0);return this._values[f]=c,this},p.prototype.delete=function(u){var c=this._find(u,!1);if(c>=0){for(var f=this._keys.length,l=c+1;l<f;l++)this._keys[l-1]=this._keys[l],this._values[l-1]=this._values[l];return this._keys.length--,this._values.length--,H(u,this._cacheKey)&&(this._cacheKey=e,this._cacheIndex=-2),!0}return!1},p.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=e,this._cacheIndex=-2},p.prototype.keys=function(){return new n(this._keys,this._values,h)},p.prototype.values=function(){return new n(this._keys,this._values,k)},p.prototype.entries=function(){return new n(this._keys,this._values,m)},p.prototype["@@iterator"]=function(){return this.entries()},p.prototype[S]=function(){return this.entries()},p.prototype._find=function(u,c){if(!H(this._cacheKey,u)){this._cacheIndex=-1;for(var f=0;f<this._keys.length;f++)if(H(this._keys[f],u)){this._cacheIndex=f;break}}return this._cacheIndex<0&&c&&(this._cacheIndex=this._keys.length,this._keys.push(u),this._values.push(void 0)),this._cacheIndex},p}();return a;function h(p,u){return p}function k(p,u){return u}function m(p,u){return[p,u]}}function Pe(){var e=function(){function r(){this._map=new x}return Object.defineProperty(r.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),r.prototype.has=function(n){return this._map.has(n)},r.prototype.add=function(n){return this._map.set(n,n),this},r.prototype.delete=function(n){return this._map.delete(n)},r.prototype.clear=function(){this._map.clear()},r.prototype.keys=function(){return this._map.keys()},r.prototype.values=function(){return this._map.keys()},r.prototype.entries=function(){return this._map.entries()},r.prototype["@@iterator"]=function(){return this.keys()},r.prototype[S]=function(){return this.keys()},r}();return e}function Re(){var e=16,r=E.create(),n=a();return function(){function u(){this._key=a()}return u.prototype.has=function(c){var f=h(c,!1);return f!==void 0?E.has(f,this._key):!1},u.prototype.get=function(c){var f=h(c,!1);return f!==void 0?E.get(f,this._key):void 0},u.prototype.set=function(c,f){var l=h(c,!0);return l[this._key]=f,this},u.prototype.delete=function(c){var f=h(c,!1);return f!==void 0?delete f[this._key]:!1},u.prototype.clear=function(){this._key=a()},u}();function a(){var u;do u="@@WeakMap@@"+p();while(E.has(r,u));return r[u]=!0,u}function h(u,c){if(!w.call(u,n)){if(!c)return;Object.defineProperty(u,n,{value:E.create()})}return u[n]}function k(u,c){for(var f=0;f<c;++f)u[f]=Math.random()*255|0;return u}function m(u){if(typeof Uint8Array=="function"){var c=new Uint8Array(u);return typeof crypto<"u"?crypto.getRandomValues(c):typeof msCrypto<"u"?msCrypto.getRandomValues(c):k(c,u),c}return k(new Array(u),u)}function p(){var u=m(e);u[6]=u[6]&79|64,u[8]=u[8]&191|128;for(var c="",f=0;f<e;++f){var l=u[f];(f===4||f===6||f===8)&&(c+="-"),l<16&&(c+="0"),c+=l.toString(16).toLowerCase()}return c}}function q(e){return e.__=void 0,delete e.__,e}})}(i||(i={})),ar}to();var ro=Object.defineProperty,no=(i,t,o)=>t in i?ro(i,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):i[t]=o,Ze=(i,t,o)=>no(i,typeof t!="symbol"?t+"":t,o);class io{constructor(t,o){Ze(this,"_target"),Ze(this,"_key"),Ze(this,"_oldValue"),Ze(this,"_wasDefined",!1),Ze(this,"_isSwapped",!1),this._target=t,this._key=o,this._oldValue=this._target[this._key]}get isSwapped(){return this._isSwapped}get originalValue(){return this._oldValue}get value(){return this._target[this._key]}get target(){return this._target}restore(){this.isSwapped&&(this._wasDefined?this._target[this._key]=this._oldValue:delete this._target[this._key],this._isSwapped=!1)}swap(t){this.isSwapped||(this._wasDefined=Object.hasOwn(this._target,this._key),this._oldValue=this._target[this._key]),this._target[this._key]=t,this._isSwapped=!0}}const oo={onlyIfNotExists:!0,isFactory:!1};class ao{constructor(t,o,s={}){if(ut(this,"_installedInstances",new Map),ut(this,"_path"),ut(this,"_targetValue"),ut(this,"_options"),this._path=t.split("."),this._path.length===0)throw new Error("Path must not be empty");this._targetValue=o,this._options={...oo,...s}}_getTargetObject(t){let o=t;for(const s of this._path.slice(0,this._path.length-1))o[s]||(o[s]={}),o=o[s];return o}_createSwapper(t){const o=this._getTargetObject(t);return new io(o,this._path.at(-1))}install({sdk:t,...o}){if(this._installedInstances.has(t))return;const s=this._createSwapper(t);if(!(s.value&&this._options.onlyIfNotExists)){if(this._options.isFactory&&typeof this._targetValue=="function"){const w=this._targetValue({sdk:t,...o});s.swap(w)}else s.swap(this._targetValue);this._installedInstances.set(t,s)}}uninstall({sdk:t}){const o=this._installedInstances.get(t);o&&(o.restore(),this._installedInstances.delete(t))}}class kt extends Error{constructor(t){super(t),this.name="MiddlewareError"}}class so extends kt{constructor(t){super(t),this.name="MiddlewareFlowError"}}class uo extends kt{constructor(t="Action prevented by middleware."){super(t),this.name="MiddlewarePreventedError"}}function ct(i){if(i===null||typeof i!="object")return i;if(Array.isArray(i))return i.map(o=>ct(o));if(i instanceof Date)return new Date(i);const t={};for(const o in i)Object.prototype.hasOwnProperty.call(i,o)&&(t[o]=ct(i[o]));return t}function ur(i){Object.freeze(i);for(const t in i)if(Object.prototype.hasOwnProperty.call(i,t)){const o=i[t];o&&typeof o=="object"&&ur(o)}return i}function co(i){let t=!1,o=null;const s=()=>t,w=()=>t=!0;return[function(...g){return w(),o=i.apply(this,g)},s,()=>{if(!t)throw new Error("Function has not been called yet");return o}]}class fo{constructor(t,o,s,w){B(this,"actionPoint"),B(this,"data"),B(this,"originalData"),B(this,"wmeSdk"),this.data=o,Object.defineProperty(this,"actionPoint",{value:t,writable:!1,configurable:!1,enumerable:!0}),Object.defineProperty(this,"originalData",{value:s,writable:!1,configurable:!1,enumerable:!0}),Object.defineProperty(this,"wmeSdk",{value:w,writable:!1,configurable:!1,enumerable:!0})}}class lo{constructor(t,o,s,w){B(this,"actionPoint"),B(this,"data"),B(this,"mutatedData"),B(this,"wmeSdk"),B(this,"handlers"),this.actionPoint=t,this.data=this.mutatedData=o,this.wmeSdk=s,this.handlers=w}getSafeImmutableData(){return ur(ct(this.data))}getSafeMutableData(){return ct(this.mutatedData)}createContext(){return new fo(this.actionPoint,this.getSafeMutableData(),this.getSafeImmutableData(),this.wmeSdk)}async run(t){let o=-1;const s=async w=>{if(w<=o)throw await new Promise(I=>setTimeout(I,1e3)),new so("next() called multiple times within the same middleware or improperly nested.");if(o=w,w>=this.handlers.length)return t(this.mutatedData);const g=this.handlers[o],T=this.createContext(),[S,j,$]=co(()=>(this.mutatedData=T.data,s(w+1)));try{return await Promise.resolve(g(T,S)),j()?await $():(console.warn(`Middleware handler "${g.name||"anonymous"}" did not call next() and did not throw an error. This is not recommended and may cause unexpected behavior.
Ensure to always call next() or throw an error to stop the middleware chain.`),await S())}catch(I){if(I instanceof uo)return null;throw I}};return await s(0)}}class ho extends EventTarget{constructor(t){super(),B(this,"middleware",new Map),B(this,"wmeSdk"),this.wmeSdk=t}register(t,o){if(typeof o!="function")throw new kt("Middleware handler must be a function.");const s=this.middleware.get(t)||[],w={handler:o};s.push(w),this.middleware.set(t,s),this.dispatchEvent(new CustomEvent("middlewareRegistered",{detail:{actionPoint:t}}));let g=!1;return()=>{if(g)return;const T=this.middleware.get(t);if(!T)return;const S=T.indexOf(w);S!==-1&&(T.splice(S,1),T.length===0&&this.middleware.delete(t),g=!0,this.dispatchEvent(new CustomEvent("middlewareUnregistered",{detail:{actionPoint:t}})))}}async execute(t,o,s){const w=this.middleware.get(t)||[];await new lo(t,o,this.wmeSdk,w.map(g=>g.handler)).run(s)}hasListeners(t){return this.middleware.has(t)&&(this.middleware.get(t)||[]).length>0}}const Ot=Symbol("REGISTRY");var po=Object.defineProperty,yo=(i,t,o)=>t in i?po(i,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):i[t]=o,Ce=(i,t,o)=>yo(i,typeof t!="symbol"?t+"":t,o);class wo{constructor(t,o){Ce(this,"_target"),Ce(this,"_key"),Ce(this,"_oldValue"),Ce(this,"_wasDefined",!1),Ce(this,"_isSwapped",!1),this._target=t,this._key=o,this._oldValue=this._target[this._key]}get isSwapped(){return this._isSwapped}get originalValue(){return this._oldValue}get value(){return this._target[this._key]}get target(){return this._target}restore(){this.isSwapped&&(this._wasDefined?this._target[this._key]=this._oldValue:delete this._target[this._key],this._isSwapped=!1)}swap(t){this.isSwapped||(this._wasDefined=Object.hasOwn(this._target,this._key),this._oldValue=this._target[this._key]),this._target[this._key]=t,this._isSwapped=!0}}let cr=class{constructor(i,t,o){Ce(this,"_enabled",!1),Ce(this,"_fnSwapper"),Ce(this,"_interceptionFunction"),Ce(this,"_middlewares",[]),this._fnSwapper=new wo(i,t),this._interceptionFunction=o}get enabled(){return this._fnSwapper.isSwapped&&this._enabled}disable(){this._enabled=!1,this.enabled}restore(){this._fnSwapper.restore()}enable(){this._enabled=!0,this._fnSwapper.isSwapped||this.swapToInterceptor()}swapToInterceptor(){const i=this;this._fnSwapper.swap(function(...t){if(!i._enabled)return i.callOriginalInvocator(...t);const o=i.runMiddlewares(t);if(o){if("output"in o)return o.output;"input"in o&&(t=o.input)}return i._interceptionFunction.call(this,i.getOriginalInvocator(this),...t)})}getOriginalInvocator(i){return this._fnSwapper.originalValue.bind(i??this._fnSwapper.target)}callOriginalInvocator(...i){return this.getOriginalInvocator()(...i)}runMiddlewares(i){for(const t of this._middlewares){const o=t(...i);if(o){if("output"in o)return o;"input"in o&&(i=o.input)}}return{input:i}}registerMiddleware(i){this._middlewares.push(i)}};function Ye(){return"unsafeWindow"in window?window.unsafeWindow:window}class fr{constructor(t){B(this,"isMiddlewareDefined",!1),B(this,"uninstaller",null),B(this,"registry"),B(this,"artifacts"),B(this,"handleMiddlewareRegistered",o=>{o.detail.actionPoint===this.options.actionPoint&&this.defineMiddleware(this.artifacts)}),B(this,"handleMiddlewareUnregistered",o=>{var s;o.detail.actionPoint===this.options.actionPoint&&((s=this.registry)!=null&&s.hasListeners(this.options.actionPoint)||this.undefineMiddleware())}),this.options=t}addRegistryEvents(){var t,o;(t=this.registry)==null||t.addEventListener("middlewareRegistered",this.handleMiddlewareRegistered),(o=this.registry)==null||o.addEventListener("middlewareUnregistered",this.handleMiddlewareUnregistered)}removeRegistryEvents(){var t,o;(t=this.registry)==null||t.removeEventListener("middlewareRegistered",this.handleMiddlewareRegistered),(o=this.registry)==null||o.removeEventListener("middlewareUnregistered",this.handleMiddlewareUnregistered)}defineMiddleware(t){this.isMiddlewareDefined||(this.uninstaller=this.options.install(o=>new Promise(s=>{if(!this.registry)return s(o);this.registry.execute(this.options.actionPoint,o,s)}),t)||null,this.isMiddlewareDefined=!0)}undefineMiddleware(){var t;this.isMiddlewareDefined&&((t=this.uninstaller)==null||t.call(this),this.isMiddlewareDefined=!1)}install({artifacts:t}){var o;this.artifacts=t,this.registry=t[this.options.registryArtifactName??Ot],(o=this.registry)!=null&&o.hasListeners(this.options.actionPoint)&&this.defineMiddleware(t),this.addRegistryEvents()}uninstall(){this.removeRegistryEvents(),this.undefineMiddleware(),this.registry=void 0}}function _o(){return new Promise(i=>{const t="problems:shown",o=Ye(),s=async w=>{if(w.type!=="mapUpdateRequest")return;o.W.app.off(t,s);const g=await o.W.problemsController.editController.adapter.getCommentable();i(g.constructor)};o.W.app.on(t,s)})}const go=new fr({actionPoint:"updateRequests.addComment",install:i=>{let t=null;return _o().then(o=>{t=new cr(o.prototype,"addComment",async function(s,w,...g){const T=await i({updateRequestId:this.conversation.getID(),message:w});return s(T.message,...g)}),t.enable()}),()=>{t==null||t.disable()}}});function vo(i){return"subActions"in i&&Array.isArray(i.subActions)}const bo=["bigJunctions","cities","countries","editSuggestions","junctions","majorTrafficEvents","managedAreas","mapComments","mapProblems","mapUpdateRequests","nodes","onlineEditors","permanentHazards","problemDetails","restrictedDrivingAreas","restrictedEditingAreas","roadClosures","schedules","segments","segmentHouseNumbers","segmentSuggestions","signTypes","states","streets","turnClosures","updateRequestSessions","users","userAreas","venues"];function St(i,t){if(typeof i!="object"||i===null)return t;if(Array.isArray(i)&&Array.isArray(t))return[...i,...t];const o={...i};for(const s in t)t[s]!==void 0&&(s in o&&typeof o[s]=="object"?o[s]=St(o[s],t[s]):o[s]=t[s]);return o}function mo(i,t){const o=Mt(i),s=Mt(t);if(o&&s)return{pendingEdits:i.pendingEdits||t.pendingEdits,saveCount:{bigJunctions:i.saveCount.bigJunctions+t.saveCount.bigJunctions,nodes:i.saveCount.nodes+t.saveCount.nodes,segments:i.saveCount.segments+t.saveCount.segments,venues:i.saveCount.venues+t.saveCount.venues},unsavedFeatures:[...i.unsavedFeatures,...t.unsavedFeatures]};if(!o&&!s)return{...[...bo,"connections"].reduce((w,g)=>{const T=i[g],S=t[g];return T&&S?w[g]=St(T,S):T?w[g]=T:S&&(w[g]=S),w},{}),status:i.status,synced:i.synced,unsavedFeatures:St(i.unsavedFeatures,t.unsavedFeatures)};throw new ko(i,t)}function Mt(i){return"saveCount"in i}class ko extends Error{constructor(t,o){super("Responses have different versions"),this.a=t,this.b=o}get preferredResponse(){return Mt(this.a)?this.b:this.a}}function lr(i,t){const o=[];if(typeof t!="function"){const s=t;t=w=>s===w}for(const s in i){const w=i[s];if(t(w))return o.concat(parseInt(s));if(w.subActions){const g=lr(w.subActions,t);if(g)return o.concat(parseInt(s),...g)}}return null}class ft{constructor(t){B(this,"actions"),this.actions=t}getActionsFlat(){return this.actions.flatMap(t=>vo(t)?t.getSubActions():[t])}getActionPath(t){return lr(this.actions,t)}hasAction(t){return this.getActionPath(t)!==null}removeAction(t){var o;const s=t.pop();let w={subActions:this.actions};for(;t.length;)w=(o=w.subActions)==null?void 0:o[t.shift()];s!==void 0&&w.subActions.splice(s,1)}replaceAction(t,...o){var s;const w=t.pop();let g={subActions:this.actions};for(;t.length;)g=(s=g.subActions)==null?void 0:s[t.shift()];w!==void 0&&g.subActions.splice(w,1,...o)}addAction(t){this.actions.push(t)}}class Oo{constructor(t,o){B(this,"saveInterceptor"),this.saveInterceptor=new cr(t.controller,"save",async function(s,w,...g){const T=new ft((w==null?void 0:w.actions)||this.model.actionManager.getActions()),S=await Promise.resolve(o(T));if(S){let j=null;for(const $ of S){const I=await s({...w||{},actions:$.actions},...g);j?j=mo(j,I):j=I}return j}return s({...w||{},actions:T.actions},...g)})}enable(){return this.saveInterceptor.enable()}disable(){return this.saveInterceptor.disable()}}const So="ADD_ROAD_CLOSURE";function Et(i){return i.actionName===So}const Mo="ADD_TURN_CLOSURE";function jt(i){var t;return i.actionName===Mo&&((t=i.getObject())==null?void 0:t.type)==="turnClosure"}function hr(i){return i.actionName==="UPDATE_OBJECT"}function dr(i){return hr(i)&&i.object.type==="roadClosure"}function pr(i){return hr(i)&&i.object.type==="turnClosure"}const Eo="DELETE_ROAD_CLOSURE";function Tt(i){return i.actionName===Eo}function jo(i){return i.actionName==="DELETE_OBJECT"}function It(i){return jo(i)&&i.object.type==="turnClosure"}function To(i){return i.filter(t=>Et(t)||jt(t)||dr(t)||pr(t)||Tt(t)||It(t))}const Io={roadClosure:"SEGMENT",turnClosure:"TURN"};function Qe(i){const t={id:i.state==="INSERT"?null:i.attributes.id,closureType:Io[i.type],startDate:new Date(i.attributes.startDate),endDate:new Date(i.attributes.endDate),description:i.attributes.reason,eventId:i.attributes.eventId};switch(i.type){case"roadClosure":return{...t,closureType:"SEGMENT",permanent:i.getAttribute("permanent"),segmentId:i.getAttribute("segID"),forward:i.getAttribute("forward"),nodeClousre:i.getAttribute("fromNodeClosed"),provider:i.getAttribute("provider")};case"turnClosure":return{...t,closureType:"TURN",permanent:!0,fromSegmentId:i.getAttribute("fromSegID"),fromSegmentForward:i.getAttribute("fromSegForward"),toSegmentId:i.getAttribute("toSegID"),toSegmentForward:i.getAttribute("toSegForward"),nodeId:i.getAttribute("nodeConnID")}}}function yr(i,t){return typeof i!=typeof t||typeof i!="object"||!i||!t?!1:Object.keys(i).every(o=>{if(!Object.prototype.hasOwnProperty.call(t,o))return!1;const s=i[o],w=t[o];return yr(s,w)})}function Po(i,t){return t.some(o=>yr(o,i))}function wr(i,t){return i.length!==t.length?!1:i.every(o=>Po(o,t))}var Ro=Object.defineProperty,Ao=(i,t,o)=>t in i?Ro(i,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):i[t]=o,Xe=(i,t,o)=>Ao(i,typeof t!="symbol"?t+"":t,o);let xo=class{constructor(i,t){Xe(this,"_target"),Xe(this,"_key"),Xe(this,"_oldValue"),Xe(this,"_wasDefined",!1),Xe(this,"_isSwapped",!1),this._target=i,this._key=t,this._oldValue=this._target[this._key]}get isSwapped(){return this._isSwapped}get originalValue(){return this._oldValue}get value(){return this._target[this._key]}get target(){return this._target}restore(){this.isSwapped&&(this._wasDefined?this._target[this._key]=this._oldValue:delete this._target[this._key],this._isSwapped=!1)}swap(i){this.isSwapped||(this._wasDefined=Object.hasOwn(this._target,this._key),this._oldValue=this._target[this._key]),this._target[this._key]=i,this._isSwapped=!0}};function Pt(){return"unsafeWindow"in window?window.unsafeWindow:window}var $o=Object.defineProperty,Do=(i,t,o)=>t in i?$o(i,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):i[t]=o,_r=(i,t,o)=>Do(i,typeof t!="symbol"?t+"":t,o);function et(){return"unsafeWindow"in window?window.unsafeWindow:window}var Fo=Object.defineProperty,Vo=(i,t,o)=>t in i?Fo(i,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):i[t]=o,ze=(i,t,o)=>Vo(i,typeof t!="symbol"?t+"":t,o);class Co{constructor(t,o){ze(this,"_target"),ze(this,"_key"),ze(this,"_oldValue"),ze(this,"_wasDefined",!1),ze(this,"_isSwapped",!1),this._target=t,this._key=o,this._oldValue=this._target[this._key]}get isSwapped(){return this._isSwapped}get originalValue(){return this._oldValue}get value(){return this._target[this._key]}get target(){return this._target}restore(){this.isSwapped&&(this._wasDefined?this._target[this._key]=this._oldValue:delete this._target[this._key],this._isSwapped=!1)}swap(t){this.isSwapped||(this._wasDefined=Object.hasOwn(this._target,this._key),this._oldValue=this._target[this._key]),this._target[this._key]=t,this._isSwapped=!0}}class zo{constructor(t,o,s){ze(this,"_enabled",!1),ze(this,"_fnSwapper"),ze(this,"_interceptionFunction"),ze(this,"_middlewares",[]),this._fnSwapper=new Co(t,o),this._interceptionFunction=s}get enabled(){return this._fnSwapper.isSwapped&&this._enabled}disable(){this._enabled=!1,this.enabled}restore(){this._fnSwapper.restore()}enable(){this._enabled=!0,this._fnSwapper.isSwapped||this.swapToInterceptor()}swapToInterceptor(){const t=this;this._fnSwapper.swap(function(...o){if(!t._enabled)return t.callOriginalInvocator(...o);const s=t.runMiddlewares(o);if(s){if("output"in s)return s.output;"input"in s&&(o=s.input)}return t._interceptionFunction.call(this,t.getOriginalInvocator(this),...o)})}getOriginalInvocator(t){return this._fnSwapper.originalValue.bind(t??this._fnSwapper.target)}callOriginalInvocator(...t){return this.getOriginalInvocator()(...t)}runMiddlewares(t){for(const o of this._middlewares){const s=o(...t);if(s){if("output"in s)return s;"input"in s&&(t=s.input)}}return{input:t}}registerMiddleware(t){this._middlewares.push(t)}}class Ko{constructor(t){_r(this,"_fetchInterceptor"),_r(this,"_interceptionFilters",new Set),this._fetchInterceptor=new zo(t,"fetch",(o,s,w)=>{for(const g of this._interceptionFilters)if(g.shouldIntercept(s,w))return this.shouldKeepFilter(g,s,w)||this.removeInterceptionFilter(g),g.intercept(s,w);return o(s,w)})}enable(){this._fetchInterceptor.enable()}disable(){this._fetchInterceptor.disable()}addInterceptionFilter(t){this.enable(),this._interceptionFilters.add(t)}removeInterceptionFilter(t){this._interceptionFilters.delete(t)}shouldKeepFilter(t,o,s){return typeof t.shouldKeep=="function"?t.shouldKeep(o,s):typeof t.shouldKeep=="boolean"?t.shouldKeep:!1}}function Wo(i){return i=i instanceof URL?i:new URL(i,et().location.href),t=>typeof t=="string"?new URL(t,et().location.href).pathname===i.pathname:t instanceof URL?t.pathname===i.pathname:new URL(t.url,et().location.href).pathname===new URL(i,et().location.href).pathname}function No(i,t,o){const s=new Response(t,o),w=new URL(i,location.toString());return Object.defineProperty(s,"url",{value:w}),s}function Ho(i,t){const o=JSON.stringify(t),s=new Headers({"Content-Type":"application/json"});return No(i,o,{headers:s})}const Uo=new Ko(et());function qo(){const i=Pt(),t=new xo(i.W.controller.descartesClient,"createAbortController");t.swap(()=>(t.restore(),new AbortController))}function Lo(i){const t=Pt();return qo(),t.W.controller.descartesClient.getFeatures([0,0,0,0],{[i]:!0},{})}async function gr(i,t){const o=Pt().W.Config.paths.features;Uo.addInterceptionFilter({shouldIntercept:Wo(o),intercept(){return Promise.resolve(Ho(o,{[i]:{objects:[t]}}))}});const{[i]:s}=await Lo(i),[w]=s.objects;return w.constructor}const vr=Symbol("TurnClosure"),br=Symbol("RoadClosure");function mr(i){const t=i.getFullYear().toString().padStart(2,"4"),o=(i.getMonth()+1).toString().padStart(2,"0"),s=i.getDate().toString().padStart(2,"0"),w=i.getHours().toString().padStart(2,"0"),g=i.getMinutes().toString().padStart(2,"0");return`${t}-${o}-${s} ${w}:${g}`}function Go(i){const t=Ye(),o={SEGMENT:"roadClosure",TURN:"turnClosure"};return t.W.model.getRepository(o[i])}function Bo(i,t){const o={id:i.id||Go(i.closureType).idGenerator.next(),attributions:null,reason:i.description,startDate:mr(i.startDate),endDate:mr(i.endDate),eventId:i.eventId,externalProvider:null,externalProviderId:null,provider:null,createdBy:null,createdOn:null,updatedBy:null,updatedOn:null,permissions:-1,geometry:null};switch(i.closureType){case"SEGMENT":return new t[br]({...o,closureType:"SEGMENT",permanent:i.permanent,segID:i.segmentId,forward:i.forward,fromNodeClosed:i.nodeClousre});case"TURN":return new t[vr]({...o,closureType:"TURN",permanent:!0,fromSegID:i.fromSegmentId,fromSegForward:i.fromSegmentForward,toSegID:i.toSegmentId,toSegForward:i.toSegmentForward,nodeConnID:i.nodeId})}}function kr(i){return Et(i)?{...Qe(i.closure),id:null}:jt(i)?{...Qe(i.getObject()),id:null}:dr(i)?Qe(i.getObject()):Tt(i)?Qe(i.closure):pr(i)||It(i)?Qe(i.getObject()):null}const Jo=[{async install(){const i=await gr("roadClosures",{});return{[br]:i}}},{async install(){const i=await gr("turnClosures",{});return{[vr]:i}}},new fr({actionPoint:"closures.save",install:(i,t)=>{const o=Ye(),s=new Oo(o.W,async w=>{var g,T;const S=w.getActionsFlat(),j=To(S);if(!j.length)return;const{delete:$,set:I}=j.reduce((F,C)=>((Tt(C)||It(C)?F.delete:F.set).push(C),F),{delete:[],set:[]}),E={source:void 0,closures:I.map(kr).filter(Boolean),deleteClosures:$.map(kr).filter(Boolean)},A=await i(E),x=wr(E.closures,A.closures),W=wr(E.deleteClosures,A.deleteClosures);if(!x&&!W)return;const K=(g=j.find(F=>Et(F)))==null?void 0:g.constructor,P=(T=j.find(F=>jt(F)))==null?void 0:T.constructor;j.forEach(F=>{const C=w.getActionPath(F);C&&(w.removeAction(C),F.undoAction(o.W.model))});const{addClosureActions:V,updateClosureActions:J}=A.closures.reduce((F,C)=>{const L=Ye(),G=Bo(C,t);if(!G)return F;if(!C.id){const Z=(()=>{switch(C.closureType){case"SEGMENT":{if(!K){const pe=L.require("Waze/Action/CreateObject");return new pe(G)}const Y=L.W.model.segments.getObjectById(C.segmentId);return new K(G,Y)}case"TURN":{if(!P){const _e=L.require("Waze/Action/CreateObject");return new _e(G)}const Y=L.W.model.segments.getObjectById(C.fromSegmentId),pe=L.W.model.segments.getObjectById(C.toSegmentId);return new P(G,Y,pe)}default:throw new Error("Unregistered closure factory for closure type "+C.closureType)}})();Z&&F.addClosureActions.push(Z)}const ye=(()=>{const Z=L.W.model.getRepository(C.closureType==="SEGMENT"?"roadClosure":"turnClosure").getObjectById(C.id);if(!Z)return null;const Y=L.require("Waze/Action/UpdateObject");return new Y(Z,G.attributes)})();return ye&&F.updateClosureActions.push(ye),F},{addClosureActions:[],updateClosureActions:[]}),we=A.deleteClosures.map(F=>{const C=Ye(),L=C.W.model.getRepository(F.closureType==="SEGMENT"?"roadClosure":"turnClosure").getObjectById(F.id);if(!L)return null;const G=C.require("Waze/Action/DeleteObject");return new G(L)});return[new ft(J.filter(Boolean)),new ft(we.filter(Boolean)),new ft(V.filter(Boolean))].filter(F=>F.actions.length>0)});return s.enable(),()=>{s.disable()}}})],Zo=[{install:({sdk:i})=>({[Ot]:new ho(i)})},new ao("Events.registerMiddleware",({artifacts:i})=>(t,o)=>{const s=i[Ot];return s==null?void 0:s.register(t,o)},{isFactory:!0}),go,...Jo],Yo={"Editing.Transactions":{hook:Br},"DataModel.MapComments":{hook:In},"DataModel.PermanentHazards":{hook:hi},"DataModel.BigJunctions":{hook:Zi},Middlewares:{hook:Zo}};function Rt(i){const[t,o,s]=i.split(".").map(Number);return{major:t,minor:o,patch:s}}function At(i,t){return i?t?i.major&&t.major&&i.major!==t.major?i.major-t.major:i.minor&&t.minor&&i.minor!==t.minor?i.minor-t.minor:i.patch&&t.patch&&i.patch!==t.patch?i.patch-t.patch:0:1:-1}function Qo(i,t,o="highest"){let s=null;typeof i.highest=="string"&&(i.highest=Rt(i.highest)),typeof i.lowest=="string"&&(i.lowest=Rt(i.lowest));for(const w of t){if(!w.version)continue;if(!s){s=w;continue}if(i.highest&&At(w.version,i.highest)>0||i.lowest&&At(w.version,i.lowest)<0)continue;const g=w.version,T=s.version,S=At(g,T);(o==="highest"&&S>0||o==="lowest"&&S<0)&&(s=w)}if(!s)throw new Error("No matching version found");return s}const Xo={"0.1":i=>{const t=i.constructor;return new t(i.getScriptId(),i.getScriptName())}};function ea(i){const t=Object.entries(Xo).map(([s,w])=>({version:Rt(s),cloner:w})),{cloner:o}=Qo({highest:i.getSDKVersion()},t);return o(i)}const Or=new jr(Yo);async function ta(i,t={}){if(t.immutable&&(i=ea(i)),i.State.isInitialized()||await i.Events.once({eventName:"wme-initialized"}),t.hooks)for(const o of t.hooks)await Or.installHook(o,i);else await Or.installAllHooks(i);return i}return ta}();
